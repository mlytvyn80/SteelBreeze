<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SteelBreeze Reference Manual: SbGeoRefFrame.C Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">SteelBreeze Reference Manual
   &#160;<span id="projectnumber">2.0.2</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_070a9b14bd5bd1b0373ba78839806e3d.html">src</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">SbGeoRefFrame.C</div>  </div>
</div>
<div class="contents">
<a href="SbGeoRefFrame_8C.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> *</span>
<a name="l00003"></a>00003 <span class="comment"> * This file is part of SteelBreeze.</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * SteelBreeze, the geodetic VLBI data analysing software.</span>
<a name="l00006"></a>00006 <span class="comment"> * Copyright (C) 1998-2003 Sergei Bolotin, MAO NASU, Kiev, Ukraine.</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> * SteelBreeze is free software; you can redistribute it and/or modify</span>
<a name="l00009"></a>00009 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
<a name="l00010"></a>00010 <span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span>
<a name="l00011"></a>00011 <span class="comment"> * (at your option) any later version.</span>
<a name="l00012"></a>00012 <span class="comment"> *</span>
<a name="l00013"></a>00013 <span class="comment"> * SteelBreeze is distributed in the hope that it will be useful,</span>
<a name="l00014"></a>00014 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00015"></a>00015 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00016"></a>00016 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00019"></a>00019 <span class="comment"> * along with SteelBreeze; if not, write to the Free Software Foundation,</span>
<a name="l00020"></a>00020 <span class="comment"> * Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.</span>
<a name="l00021"></a>00021 <span class="comment"> *</span>
<a name="l00022"></a>00022 <span class="comment"> */</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="preprocessor">#include &quot;<a class="code" href="SbGeoRefFrame_8H.html">SbGeoRefFrame.H</a>&quot;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;<a class="code" href="SbSetup_8H.html">SbSetup.H</a>&quot;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;<a class="code" href="SbGeoEop_8H.html">SbGeoEop.H</a>&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="SbGeoProject_8H.html">SbGeoProject.H</a>&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classSBNutation.html#a4e17b4f7d3ca2ec03d6d29e081313c82" title="obliquity at J2000.0">SBNutation::EphemEps</a> = 84381.448*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="comment">/*==============================================================================================*/</span>
<a name="l00040"></a>00040 <span class="comment">/*                                                                                              */</span>
<a name="l00041"></a>00041 <span class="comment">/* class SBPrec_IAU1976 implementation                                                          */</span>
<a name="l00042"></a>00042 <span class="comment">/*                                                                                              */</span>
<a name="l00043"></a>00043 <span class="comment">/*==============================================================================================*/</span>
<a name="l00044"></a><a class="code" href="classSBPrec__IAU1976.html#aadab413bea4b033a0b6f937f893732e9">00044</a> <a class="code" href="classSBPrec__IAU1976.html#aadab413bea4b033a0b6f937f893732e9">SBPrec_IAU1976::SBPrec_IAU1976</a>() : <a class="code" href="classSBPrecession.html">SBPrecession</a>(), R1(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a4b8a53bafca6b43388660925049d734f">Z_AXIS</a>), R2(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0aa1ec9649c0a631b27ad7280af3522dd0">Y_AXIS</a>), R3(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a4b8a53bafca6b43388660925049d734f">Z_AXIS</a>)
<a name="l00045"></a>00045 {
<a name="l00046"></a>00046   <a class="code" href="classSBPrec__IAU1976.html#a8c50cd0302a5f555ed2aa81cecec7c7c">Zeta</a>  = 0.0;
<a name="l00047"></a>00047   <a class="code" href="classSBPrec__IAU1976.html#a24ae58cf68766a423ec62a6fca8ff3a5">Z</a>     = 0.0;
<a name="l00048"></a>00048   <a class="code" href="classSBPrec__IAU1976.html#a39dcfb705e43adc583a1c1ea98414270">Theta</a> = 0.0;
<a name="l00049"></a>00049 };
<a name="l00050"></a>00050 
<a name="l00051"></a><a class="code" href="classSBPrec__IAU1976.html#a0124fa9e394de212b5ae08c2f5bcd523">00051</a> <span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3</a>&amp; <a class="code" href="classSBPrec__IAU1976.html#a0124fa9e394de212b5ae08c2f5bcd523">SBPrec_IAU1976::operator()</a>(<a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l00052"></a>00052 {
<a name="l00053"></a>00053   <span class="keywordtype">double</span> t = (T.<a class="code" href="classSBTime.html#ad8753001fdea9be0f2bbcb1798251e16">TT</a>() - <a class="code" href="SbGeoTime_8C.html#af3440a08fa10f55224b98a7c82fecddc">TEphem</a>)/36525.0;
<a name="l00054"></a>00054   <span class="comment">//  double t = (T.TDB() - TEphem)/36525.0;</span>
<a name="l00055"></a>00055   <span class="keywordtype">double</span> t2 = t*t, t3=t*t2;
<a name="l00056"></a>00056   <span class="comment">/*</span>
<a name="l00057"></a>00057 <span class="comment">    IERS Technical Note 21,</span>
<a name="l00058"></a>00058 <span class="comment">    IERS Conventions (1996)</span>
<a name="l00059"></a>00059 <span class="comment">    page 22 says:</span>
<a name="l00060"></a>00060 <span class="comment">    &quot;  The numerical expression for the precession quantities Dzeta, Theta, Zet and Epsilon</span>
<a name="l00061"></a>00061 <span class="comment">    have been given by Lieske et al. (1977) as functions of two time parameters t and T (the </span>
<a name="l00062"></a>00062 <span class="comment">    last parameter representing Julian centuries from J2000.0 to an arbitrary epoch). The </span>
<a name="l00063"></a>00063 <span class="comment">    simplified expressions when the arbitrary epoch is chosen to be J2000.0 (i.e. T=0) are&quot;</span>
<a name="l00064"></a>00064 <span class="comment">  */</span>
<a name="l00065"></a>00065   <a class="code" href="classSBPrec__IAU1976.html#a8c50cd0302a5f555ed2aa81cecec7c7c">Zeta</a>  = <a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>*(2306.2181*t + 0.30188*t2 + 0.017998*t3);
<a name="l00066"></a>00066   <a class="code" href="classSBPrec__IAU1976.html#a39dcfb705e43adc583a1c1ea98414270">Theta</a> = <a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>*(2004.3109*t - 0.42665*t2 - 0.041833*t3);
<a name="l00067"></a>00067   <a class="code" href="classSBPrec__IAU1976.html#a24ae58cf68766a423ec62a6fca8ff3a5">Z</a>     = <a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>*(2306.2181*t + 1.09468*t2 + 0.018203*t3);
<a name="l00068"></a>00068 
<a name="l00069"></a>00069   (<a class="code" href="classMatrix3.html">Matrix3</a>&amp;)*<span class="keyword">this</span> = <a class="code" href="classSBPrec__IAU1976.html#afaed8dbdc1488946ad9c191ce954131f">R1</a>(<a class="code" href="classSBPrec__IAU1976.html#a8c50cd0302a5f555ed2aa81cecec7c7c">Zeta</a>)*<a class="code" href="classSBPrec__IAU1976.html#a594684c1bc1fed2f2892505cd0aadb8d">R2</a>(-Theta)*<a class="code" href="classSBPrec__IAU1976.html#a54588950ff23ce73b3ef6ea2a819b785">R3</a>(Z);
<a name="l00070"></a>00070 
<a name="l00071"></a>00071   <span class="comment">// make a report:</span>
<a name="l00072"></a>00072   <span class="keywordflow">if</span> (<a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#aff04f6b9f1def9cc474fb04fef43f9fc">isEligible</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4aba07ad3afd3b42f3073474b72ba41b42">SBLog::PRECESSION</a>))
<a name="l00073"></a>00073     {
<a name="l00074"></a>00074       <span class="comment">//      Log-&gt;write(SBLog::DBG, SBLog::PRECESSION, ClassName() + &quot;: Arg(TT): &quot; + T.TT().toString());</span>
<a name="l00075"></a>00075       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4aba07ad3afd3b42f3073474b72ba41b42">SBLog::PRECESSION</a>, <a class="code" href="classSBPrec__IAU1976.html#a57ac1ea2f1625385810ba43fe2634b6c">ClassName</a>() + <span class="stringliteral">&quot;: Arg(TDB): &quot;</span> + T.<a class="code" href="classSBTime.html#a1ef377755e01021ba591e442fe5185f3">TDB</a>().<a class="code" href="classSBMJD.html#a503ad8eab15136efa52e77311b93d61a">toString</a>());
<a name="l00076"></a>00076       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4aba07ad3afd3b42f3073474b72ba41b42">SBLog::PRECESSION</a>, <a class="code" href="classSBPrec__IAU1976.html#a57ac1ea2f1625385810ba43fe2634b6c">ClassName</a>() + <span class="stringliteral">&quot;: Zeta    : &quot;</span> + 
<a name="l00077"></a>00077                  QString().sprintf(<span class="stringliteral">&quot;%16.8f (arcsec)&quot;</span>, <a class="code" href="classSBPrec__IAU1976.html#a8c50cd0302a5f555ed2aa81cecec7c7c">Zeta</a>/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00078"></a>00078       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4aba07ad3afd3b42f3073474b72ba41b42">SBLog::PRECESSION</a>, <a class="code" href="classSBPrec__IAU1976.html#a57ac1ea2f1625385810ba43fe2634b6c">ClassName</a>() + <span class="stringliteral">&quot;: Theta   : &quot;</span> + 
<a name="l00079"></a>00079                  QString().sprintf(<span class="stringliteral">&quot;%16.8f (arcsec)&quot;</span>, Theta/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00080"></a>00080       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4aba07ad3afd3b42f3073474b72ba41b42">SBLog::PRECESSION</a>, <a class="code" href="classSBPrec__IAU1976.html#a57ac1ea2f1625385810ba43fe2634b6c">ClassName</a>() + <span class="stringliteral">&quot;: Z       : &quot;</span> + 
<a name="l00081"></a>00081                  QString().sprintf(<span class="stringliteral">&quot;%16.8f (arcsec)&quot;</span>, Z/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00082"></a>00082 
<a name="l00083"></a>00083 
<a name="l00084"></a>00084       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU1976.html#a57ac1ea2f1625385810ba43fe2634b6c">ClassName</a>() + <span class="stringliteral">&quot;: R1.angle: &quot;</span> + 
<a name="l00085"></a>00085                  QString().sprintf(<span class="stringliteral">&quot;%.16f (arcsec)&quot;</span>, <a class="code" href="classSBPrec__IAU1976.html#afaed8dbdc1488946ad9c191ce954131f">R1</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00086"></a>00086       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU1976.html#a57ac1ea2f1625385810ba43fe2634b6c">ClassName</a>() + <span class="stringliteral">&quot;: R1.angle: &quot;</span> + 
<a name="l00087"></a>00087                  QString().sprintf(<span class="stringliteral">&quot;%.20f (rad)&quot;</span>, <a class="code" href="classSBPrec__IAU1976.html#afaed8dbdc1488946ad9c191ce954131f">R1</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()));
<a name="l00088"></a>00088       <a class="code" href="classSBPrec__IAU1976.html#afaed8dbdc1488946ad9c191ce954131f">R1</a>.<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU1976.html#a57ac1ea2f1625385810ba43fe2634b6c">ClassName</a>() + <span class="stringliteral">&quot;: R1(Zeta): &quot;</span>);
<a name="l00089"></a>00089 
<a name="l00090"></a>00090       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU1976.html#a57ac1ea2f1625385810ba43fe2634b6c">ClassName</a>() + <span class="stringliteral">&quot;: R2.angle: &quot;</span> + 
<a name="l00091"></a>00091                  QString().sprintf(<span class="stringliteral">&quot;%.16f (arcsec)&quot;</span>, <a class="code" href="classSBPrec__IAU1976.html#a594684c1bc1fed2f2892505cd0aadb8d">R2</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00092"></a>00092       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU1976.html#a57ac1ea2f1625385810ba43fe2634b6c">ClassName</a>() + <span class="stringliteral">&quot;: R2.angle: &quot;</span> + 
<a name="l00093"></a>00093                  QString().sprintf(<span class="stringliteral">&quot;%.20f (rad)&quot;</span>, <a class="code" href="classSBPrec__IAU1976.html#a594684c1bc1fed2f2892505cd0aadb8d">R2</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()));
<a name="l00094"></a>00094       <a class="code" href="classSBPrec__IAU1976.html#a594684c1bc1fed2f2892505cd0aadb8d">R2</a>.<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU1976.html#a57ac1ea2f1625385810ba43fe2634b6c">ClassName</a>() + <span class="stringliteral">&quot;: R2(-Tht): &quot;</span>);
<a name="l00095"></a>00095 
<a name="l00096"></a>00096       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU1976.html#a57ac1ea2f1625385810ba43fe2634b6c">ClassName</a>() + <span class="stringliteral">&quot;: R3.angle: &quot;</span> + 
<a name="l00097"></a>00097                  QString().sprintf(<span class="stringliteral">&quot;%.16f (arcsec)&quot;</span>, <a class="code" href="classSBPrec__IAU1976.html#a54588950ff23ce73b3ef6ea2a819b785">R3</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00098"></a>00098       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU1976.html#a57ac1ea2f1625385810ba43fe2634b6c">ClassName</a>() + <span class="stringliteral">&quot;: R3.angle: &quot;</span> + 
<a name="l00099"></a>00099                  QString().sprintf(<span class="stringliteral">&quot;%.20f (rad)&quot;</span>, <a class="code" href="classSBPrec__IAU1976.html#a54588950ff23ce73b3ef6ea2a819b785">R3</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()));
<a name="l00100"></a>00100       <a class="code" href="classSBPrec__IAU1976.html#a54588950ff23ce73b3ef6ea2a819b785">R3</a>.<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU1976.html#a57ac1ea2f1625385810ba43fe2634b6c">ClassName</a>() + <span class="stringliteral">&quot;: R3(Z)   : &quot;</span>);
<a name="l00101"></a>00101 
<a name="l00102"></a>00102 
<a name="l00103"></a>00103       this-&gt;<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4aba07ad3afd3b42f3073474b72ba41b42">SBLog::PRECESSION</a>, <a class="code" href="classSBPrec__IAU1976.html#a57ac1ea2f1625385810ba43fe2634b6c">ClassName</a>() + <span class="stringliteral">&quot;: matrix  : &quot;</span>);
<a name="l00104"></a>00104     };
<a name="l00105"></a>00105   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00106"></a>00106 };
<a name="l00107"></a>00107 <span class="comment">/*==============================================================================================*/</span>
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 
<a name="l00111"></a>00111 <span class="comment">/*==============================================================================================*/</span>
<a name="l00112"></a>00112 <span class="comment">/*                                                                                              */</span>
<a name="l00113"></a>00113 <span class="comment">/* class SBPrec_IAU2000 implementation                                                          */</span>
<a name="l00114"></a>00114 <span class="comment">/*                                                                                              */</span>
<a name="l00115"></a>00115 <span class="comment">/*==============================================================================================*/</span>
<a name="l00116"></a><a class="code" href="classSBPrec__IAU2000.html#a6cd83e508d023cebcfab3c124e77c29a">00116</a> <a class="code" href="classSBPrec__IAU2000.html#a6cd83e508d023cebcfab3c124e77c29a">SBPrec_IAU2000::SBPrec_IAU2000</a>() : <a class="code" href="classSBPrecession.html">SBPrecession</a>(), R1(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a93ed1386222f87948b972889ad82cd33">X_AXIS</a>), R2(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a4b8a53bafca6b43388660925049d734f">Z_AXIS</a>), R3(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a93ed1386222f87948b972889ad82cd33">X_AXIS</a>), R4(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a4b8a53bafca6b43388660925049d734f">Z_AXIS</a>),
<a name="l00117"></a>00117   DP_dPsi(<a class="code" href="SbVector3_8C.html#abeceef3c00b48ae35fe246ef2922c7d3">m3E</a>)
<a name="l00118"></a>00118 {
<a name="l00119"></a>00119   <a class="code" href="classSBPrec__IAU2000.html#ad6f0bcd37487db648d3dea3841b6c1a6">t</a>     = 0.0;
<a name="l00120"></a>00120   <a class="code" href="classSBPrec__IAU2000.html#a1c8eda2b6b33263e2e72b7fd9ebc7059">Psi</a>   = 0.0;
<a name="l00121"></a>00121   <a class="code" href="classSBPrec__IAU2000.html#ae55853e5261705e3d501d3a4ab8ead09">Omega</a> = 0.0;
<a name="l00122"></a>00122   <a class="code" href="classSBPrec__IAU2000.html#a0ee9a9bab1e856ff4469ba9785cafe0d">Chi</a>   = 0.0;
<a name="l00123"></a>00123 };
<a name="l00124"></a>00124 
<a name="l00125"></a><a class="code" href="classSBPrec__IAU2000.html#af9d754154a93b6892965bcdc7fbc55a0">00125</a> <span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3</a>&amp; <a class="code" href="classSBPrec__IAU2000.html#af9d754154a93b6892965bcdc7fbc55a0">SBPrec_IAU2000::operator()</a>(<a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l00126"></a>00126 {
<a name="l00127"></a>00127   <span class="keywordtype">double</span> <a class="code" href="classSBPrec__IAU2000.html#ad6f0bcd37487db648d3dea3841b6c1a6">t</a> = (T.<a class="code" href="classSBTime.html#ad8753001fdea9be0f2bbcb1798251e16">TT</a>() - <a class="code" href="SbGeoTime_8C.html#af3440a08fa10f55224b98a7c82fecddc">TEphem</a>)/36525.0;
<a name="l00128"></a>00128   <span class="comment">//  t = (T.TDB() - TEphem)/36525.0;</span>
<a name="l00129"></a>00129   <span class="keywordtype">double</span> t2 = t*<a class="code" href="classSBPrec__IAU2000.html#ad6f0bcd37487db648d3dea3841b6c1a6">t</a>;
<a name="l00130"></a>00130   <span class="keywordtype">double</span> t3 = t2*<a class="code" href="classSBPrec__IAU2000.html#ad6f0bcd37487db648d3dea3841b6c1a6">t</a>;
<a name="l00131"></a>00131 
<a name="l00132"></a>00132   <a class="code" href="classSBPrec__IAU2000.html#a0ee9a9bab1e856ff4469ba9785cafe0d">Chi</a>   = (10.5526*t - 2.38064*t2 - 0.001125*t3)*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l00133"></a>00133   <a class="code" href="classSBPrec__IAU2000.html#ae55853e5261705e3d501d3a4ab8ead09">Omega</a> = <a class="code" href="classSBNutation.html#a764f7abde10c189385c93da2eaf6c3dd">SBNutation::ephemEps</a>() + (-0.02524*t + 0.05127*t2 - 0.007726*t3)*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l00134"></a>00134   <a class="code" href="classSBPrec__IAU2000.html#a1c8eda2b6b33263e2e72b7fd9ebc7059">Psi</a>   = (5038.47875*t - 1.07259*t2 - 0.001147*t3)*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l00135"></a>00135   <span class="comment">//  Psi   = ((5038.47875 + T.eop()-&gt;p_A1()-&gt;v())*t - 1.07259*t2 - 0.001147*t3)*SEC2RAD;</span>
<a name="l00136"></a>00136 
<a name="l00137"></a>00137   (<a class="code" href="classMatrix3.html">Matrix3</a>&amp;)*<span class="keyword">this</span> = <a class="code" href="classSBPrec__IAU2000.html#ad94d6a96b7753a8e5ea654e59c1af899">R1</a>(-<a class="code" href="classSBNutation.html#a764f7abde10c189385c93da2eaf6c3dd">SBNutation::ephemEps</a>())*<a class="code" href="classSBPrec__IAU2000.html#a80f1db2c2c9ce21875c0ff4093eda746">R2</a>(<a class="code" href="classSBPrec__IAU2000.html#a1c8eda2b6b33263e2e72b7fd9ebc7059">Psi</a>)*<a class="code" href="classSBPrec__IAU2000.html#a60012bf388c27c17f5faebfccc9c92fe">R3</a>(<a class="code" href="classSBPrec__IAU2000.html#ae55853e5261705e3d501d3a4ab8ead09">Omega</a>)*<a class="code" href="classSBPrec__IAU2000.html#a124e676b49171a8d1846877ecdc551ac">R4</a>(-<a class="code" href="classSBPrec__IAU2000.html#a0ee9a9bab1e856ff4469ba9785cafe0d">Chi</a>);
<a name="l00138"></a>00138 
<a name="l00139"></a>00139   <span class="comment">// make a report:</span>
<a name="l00140"></a>00140   <span class="keywordflow">if</span> (<a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#aff04f6b9f1def9cc474fb04fef43f9fc">isEligible</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4aba07ad3afd3b42f3073474b72ba41b42">SBLog::PRECESSION</a>))
<a name="l00141"></a>00141     {
<a name="l00142"></a>00142       <span class="comment">//      Log-&gt;write(SBLog::DBG, SBLog::PRECESSION, ClassName() + &quot;: Arg(TT): &quot; + T.TT().toString());</span>
<a name="l00143"></a>00143       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4aba07ad3afd3b42f3073474b72ba41b42">SBLog::PRECESSION</a>, <a class="code" href="classSBPrec__IAU2000.html#ad2f80dc2edc4df79579c6e656fee3c8a">ClassName</a>() + <span class="stringliteral">&quot;: Arg(TDB) : &quot;</span> + T.<a class="code" href="classSBTime.html#a1ef377755e01021ba591e442fe5185f3">TDB</a>().<a class="code" href="classSBMJD.html#a503ad8eab15136efa52e77311b93d61a">toString</a>());
<a name="l00144"></a>00144 
<a name="l00145"></a>00145       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4aba07ad3afd3b42f3073474b72ba41b42">SBLog::PRECESSION</a>, <a class="code" href="classSBPrec__IAU2000.html#ad2f80dc2edc4df79579c6e656fee3c8a">ClassName</a>() + <span class="stringliteral">&quot;: Chi      : &quot;</span> + 
<a name="l00146"></a>00146                  QString().sprintf(<span class="stringliteral">&quot;%16.8f (arcsec)&quot;</span>, <a class="code" href="classSBPrec__IAU2000.html#a0ee9a9bab1e856ff4469ba9785cafe0d">Chi</a>/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00147"></a>00147       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4aba07ad3afd3b42f3073474b72ba41b42">SBLog::PRECESSION</a>, <a class="code" href="classSBPrec__IAU2000.html#ad2f80dc2edc4df79579c6e656fee3c8a">ClassName</a>() + <span class="stringliteral">&quot;: Omega    : &quot;</span> + 
<a name="l00148"></a>00148                  QString().sprintf(<span class="stringliteral">&quot;%16.8f (arcsec)&quot;</span>, <a class="code" href="classSBPrec__IAU2000.html#ae55853e5261705e3d501d3a4ab8ead09">Omega</a>/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00149"></a>00149       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4aba07ad3afd3b42f3073474b72ba41b42">SBLog::PRECESSION</a>, <a class="code" href="classSBPrec__IAU2000.html#ad2f80dc2edc4df79579c6e656fee3c8a">ClassName</a>() + <span class="stringliteral">&quot;: Psi      : &quot;</span> + 
<a name="l00150"></a>00150                  QString().sprintf(<span class="stringliteral">&quot;%16.8f (arcsec)&quot;</span>, <a class="code" href="classSBPrec__IAU2000.html#a1c8eda2b6b33263e2e72b7fd9ebc7059">Psi</a>/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 
<a name="l00153"></a>00153       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU2000.html#ad2f80dc2edc4df79579c6e656fee3c8a">ClassName</a>() + <span class="stringliteral">&quot;: R1.angle : &quot;</span> + 
<a name="l00154"></a>00154                  QString().sprintf(<span class="stringliteral">&quot;%.16f (arcsec)&quot;</span>, <a class="code" href="classSBPrec__IAU2000.html#ad94d6a96b7753a8e5ea654e59c1af899">R1</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00155"></a>00155       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU2000.html#ad2f80dc2edc4df79579c6e656fee3c8a">ClassName</a>() + <span class="stringliteral">&quot;: R1.angle : &quot;</span> + 
<a name="l00156"></a>00156                  QString().sprintf(<span class="stringliteral">&quot;%.20f (rad)&quot;</span>, <a class="code" href="classSBPrec__IAU2000.html#ad94d6a96b7753a8e5ea654e59c1af899">R1</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()));
<a name="l00157"></a>00157       <a class="code" href="classSBPrec__IAU2000.html#ad94d6a96b7753a8e5ea654e59c1af899">R1</a>.<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU2000.html#ad2f80dc2edc4df79579c6e656fee3c8a">ClassName</a>() + <span class="stringliteral">&quot;: R1(EpsE) : &quot;</span>);
<a name="l00158"></a>00158 
<a name="l00159"></a>00159       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU2000.html#ad2f80dc2edc4df79579c6e656fee3c8a">ClassName</a>() + <span class="stringliteral">&quot;: R2.angle : &quot;</span> + 
<a name="l00160"></a>00160                  QString().sprintf(<span class="stringliteral">&quot;%.16f (arcsec)&quot;</span>, <a class="code" href="classSBPrec__IAU2000.html#a80f1db2c2c9ce21875c0ff4093eda746">R2</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00161"></a>00161       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU2000.html#ad2f80dc2edc4df79579c6e656fee3c8a">ClassName</a>() + <span class="stringliteral">&quot;: R2.angle : &quot;</span> + 
<a name="l00162"></a>00162                  QString().sprintf(<span class="stringliteral">&quot;%.20f (rad)&quot;</span>, <a class="code" href="classSBPrec__IAU2000.html#a80f1db2c2c9ce21875c0ff4093eda746">R2</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()));
<a name="l00163"></a>00163       <a class="code" href="classSBPrec__IAU2000.html#a80f1db2c2c9ce21875c0ff4093eda746">R2</a>.<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU2000.html#ad2f80dc2edc4df79579c6e656fee3c8a">ClassName</a>() + <span class="stringliteral">&quot;: R2(Psi)  : &quot;</span>);
<a name="l00164"></a>00164 
<a name="l00165"></a>00165       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU2000.html#ad2f80dc2edc4df79579c6e656fee3c8a">ClassName</a>() + <span class="stringliteral">&quot;: R3.angle : &quot;</span> + 
<a name="l00166"></a>00166                  QString().sprintf(<span class="stringliteral">&quot;%.16f (arcsec)&quot;</span>, <a class="code" href="classSBPrec__IAU2000.html#a60012bf388c27c17f5faebfccc9c92fe">R3</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00167"></a>00167       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU2000.html#ad2f80dc2edc4df79579c6e656fee3c8a">ClassName</a>() + <span class="stringliteral">&quot;: R3.angle : &quot;</span> + 
<a name="l00168"></a>00168                  QString().sprintf(<span class="stringliteral">&quot;%.20f (rad)&quot;</span>, <a class="code" href="classSBPrec__IAU2000.html#a60012bf388c27c17f5faebfccc9c92fe">R3</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()));
<a name="l00169"></a>00169       <a class="code" href="classSBPrec__IAU2000.html#a60012bf388c27c17f5faebfccc9c92fe">R3</a>.<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU2000.html#ad2f80dc2edc4df79579c6e656fee3c8a">ClassName</a>() + <span class="stringliteral">&quot;: R3(Omega): &quot;</span>);
<a name="l00170"></a>00170 
<a name="l00171"></a>00171       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU2000.html#ad2f80dc2edc4df79579c6e656fee3c8a">ClassName</a>() + <span class="stringliteral">&quot;: R4.angle : &quot;</span> + 
<a name="l00172"></a>00172                  QString().sprintf(<span class="stringliteral">&quot;%.16f (arcsec)&quot;</span>, <a class="code" href="classSBPrec__IAU2000.html#a124e676b49171a8d1846877ecdc551ac">R4</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00173"></a>00173       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU2000.html#ad2f80dc2edc4df79579c6e656fee3c8a">ClassName</a>() + <span class="stringliteral">&quot;: R4.angle : &quot;</span> + 
<a name="l00174"></a>00174                  QString().sprintf(<span class="stringliteral">&quot;%.20f (rad)&quot;</span>, <a class="code" href="classSBPrec__IAU2000.html#a124e676b49171a8d1846877ecdc551ac">R4</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()));
<a name="l00175"></a>00175       <a class="code" href="classSBPrec__IAU2000.html#a124e676b49171a8d1846877ecdc551ac">R4</a>.<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrec__IAU2000.html#ad2f80dc2edc4df79579c6e656fee3c8a">ClassName</a>() + <span class="stringliteral">&quot;: R4(-Chi) : &quot;</span>);
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 
<a name="l00178"></a>00178       this-&gt;<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4aba07ad3afd3b42f3073474b72ba41b42">SBLog::PRECESSION</a>, <a class="code" href="classSBPrec__IAU2000.html#ad2f80dc2edc4df79579c6e656fee3c8a">ClassName</a>() + <span class="stringliteral">&quot;: matrix   : &quot;</span>);
<a name="l00179"></a>00179     };
<a name="l00180"></a>00180   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00181"></a>00181 };
<a name="l00182"></a>00182 
<a name="l00183"></a><a class="code" href="classSBPrec__IAU2000.html#ac329e6c365d4e7a9a38597740ed572fd">00183</a> <span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3</a>&amp; <a class="code" href="classSBPrec__IAU2000.html#ac329e6c365d4e7a9a38597740ed572fd">SBPrec_IAU2000::dP_dpsi</a>()
<a name="l00184"></a>00184 {
<a name="l00185"></a>00185   <a class="code" href="classRotDerMatrix.html">RotDerMatrix</a>  R_(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a4b8a53bafca6b43388660925049d734f">Z_AXIS</a>);
<a name="l00186"></a>00186   <a class="code" href="classSBPrec__IAU2000.html#a5b39cc3db2f32b056c4c2efc35cbc563">DP_dPsi</a> = <a class="code" href="classSBPrec__IAU2000.html#ad6f0bcd37487db648d3dea3841b6c1a6">t</a>*<a class="code" href="classSBPrec__IAU2000.html#ad94d6a96b7753a8e5ea654e59c1af899">R1</a>*R_(<a class="code" href="classSBPrec__IAU2000.html#a1c8eda2b6b33263e2e72b7fd9ebc7059">Psi</a>)*<a class="code" href="classSBPrec__IAU2000.html#a60012bf388c27c17f5faebfccc9c92fe">R3</a>*<a class="code" href="classSBPrec__IAU2000.html#a124e676b49171a8d1846877ecdc551ac">R4</a>;
<a name="l00187"></a>00187   <span class="keywordflow">return</span> <a class="code" href="classSBPrec__IAU2000.html#a5b39cc3db2f32b056c4c2efc35cbc563">DP_dPsi</a>;
<a name="l00188"></a>00188 };
<a name="l00189"></a>00189 <span class="comment">/*==============================================================================================*/</span>
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 <span class="comment">/*==============================================================================================*/</span>
<a name="l00194"></a>00194 <span class="comment">/*                                                                                              */</span>
<a name="l00195"></a>00195 <span class="comment">/* class SBNutation implementation                                                              */</span>
<a name="l00196"></a>00196 <span class="comment">/*                                                                                              */</span>
<a name="l00197"></a>00197 <span class="comment">/*==============================================================================================*/</span>
<a name="l00201"></a><a class="code" href="classSBNutation.html#ac9676714ccfae677244368881325a818">00201</a> <a class="code" href="classSBNutation.html#ac9676714ccfae677244368881325a818">SBNutation::SBNutation</a>(<span class="keyword">const</span> <a class="code" href="classSBConfig.html">SBConfig</a> *Cfg_, <a class="code" href="classSBEOP.html">SBEOP</a>* EOP_) 
<a name="l00202"></a>00202   : <a class="code" href="classMatrix3.html">Matrix3</a>(), R1(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a93ed1386222f87948b972889ad82cd33">X_AXIS</a>), R2(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a4b8a53bafca6b43388660925049d734f">Z_AXIS</a>), R3(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a93ed1386222f87948b972889ad82cd33">X_AXIS</a>),
<a name="l00203"></a>00203     DR2dpsi(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a4b8a53bafca6b43388660925049d734f">Z_AXIS</a>),
<a name="l00204"></a>00204     DR3deps(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a93ed1386222f87948b972889ad82cd33">X_AXIS</a>)
<a name="l00205"></a>00205 {
<a name="l00206"></a>00206   <a class="code" href="classSBNutation.html#ab876d42be08837986ca7d7956c7f10e9">Cfg</a>      = Cfg_;
<a name="l00207"></a>00207   <a class="code" href="classSBNutation.html#a70fbb5f53bdcdfb943d6b44e453e547a" title="EOP database.">EOP</a>      = EOP_;
<a name="l00208"></a>00208   <a class="code" href="classSBNutation.html#a8c17ac56fa7253a77add52f21868b178" title="mean obliquity">Eps</a>      = 0.0;
<a name="l00209"></a>00209   <a class="code" href="classSBNutation.html#afeefa62ba07917649b53998aafaeb0ee" title="nutation in obliquity">DeltaEps</a> = 0.0;
<a name="l00210"></a>00210   <a class="code" href="classSBNutation.html#a7fb200b0fb83c995b424e1ee34b5f02f" title="nutation in longitude">DeltaPsi</a> = 0.0;
<a name="l00211"></a>00211   <a class="code" href="classSBNutation.html#a9c3a5f626ce0e11f8cddaa37e210350f" title="equation of equinox">AlphaE</a>   = 0.0;
<a name="l00212"></a>00212   <a class="code" href="classSBNutation.html#aacbc48b0d3da1560e9d4acc4b8cc9e72">DPsi</a> = <a class="code" href="classSBNutation.html#a7dcbfc8b1d80724c81f387a9f309e5e0">DEps</a> = 0.0;
<a name="l00213"></a>00213   <a class="code" href="classSBNutation.html#a71058c37e069f68877125739fdb9cecd" title="Greenwich Mean Sidereal Time.">GMST</a> = <a class="code" href="classSBNutation.html#aaff13dc3dd84b9dd9fd627cd48373c2a" title="Greenwich Sidereal Time.">GST</a> = <a class="code" href="classSBNutation.html#a8728be17404baf85a1674e664cc37470">R</a> = 0.0;
<a name="l00214"></a>00214   <a class="code" href="classSBNutation.html#a4c5f4734ba3f907d334141282c126079" title="nutation theory">Theory</a> = NULL;
<a name="l00215"></a>00215 };
<a name="l00216"></a>00216 
<a name="l00217"></a><a class="code" href="classSBNutation.html#a5d7fce34aa3d09fefaa40a90b51074ea">00217</a> <span class="keywordtype">void</span> <a class="code" href="classSBNutation.html#a5d7fce34aa3d09fefaa40a90b51074ea">SBNutation::calcGST</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l00218"></a>00218 {
<a name="l00219"></a>00219   <span class="comment">//--</span>
<a name="l00220"></a>00220   <span class="keywordtype">double</span>        GMST0h=0.0, T_u=0.0, T_u2=0.0;
<a name="l00221"></a>00221 
<a name="l00222"></a>00222   <span class="comment">/*</span>
<a name="l00223"></a>00223 <span class="comment">    IERS Technical Note 21,</span>
<a name="l00224"></a>00224 <span class="comment">    IERS Conventions (1996)</span>
<a name="l00225"></a>00225 <span class="comment">    page 21 says:</span>
<a name="l00226"></a>00226 <span class="comment"></span>
<a name="l00227"></a>00227 <span class="comment">    &quot;Apparent Geenwich Sidereal Time GST at the date t of observations, must be derived</span>
<a name="l00228"></a>00228 <span class="comment">    from the following expressions:</span>
<a name="l00229"></a>00229 <span class="comment"></span>
<a name="l00230"></a>00230 <span class="comment">    (i) the relationship between Greenwich Mean Sidereal Time (GMST) and Universal </span>
<a name="l00231"></a>00231 <span class="comment">    Time as given by Aoki et al. (1982):</span>
<a name="l00232"></a>00232 <span class="comment">    </span>
<a name="l00233"></a>00233 <span class="comment">    with T&#39;_u = d&#39;_u/36525, d&#39;_u being the number of days elapsed since </span>
<a name="l00234"></a>00234 <span class="comment">    2000 January 1, 12h UT1, takin on values +/- 0.5, +/- 1.5, ...,&quot;</span>
<a name="l00235"></a>00235 <span class="comment">  */</span>
<a name="l00236"></a>00236   T_u = (T.<a class="code" href="classSBTime.html#a85fa42d1dc9fe0c7604c377de22c9c9f">UT1</a>().<a class="code" href="classSBMJD.html#a99107bb59fc2a3c67ef7a0784417c9f9">date</a>() - <a class="code" href="SbGeoTime_8C.html#af3440a08fa10f55224b98a7c82fecddc">TEphem</a>)/36525.0;
<a name="l00237"></a>00237   T_u2 = T_u*T_u;
<a name="l00238"></a>00238   GMST0h = (24110.54841 + 8640184.812866*T_u + 0.093104*T_u2 - 6.2e-6*T_u*T_u2)/<a class="code" href="SbGeo_8H.html#a4e1704eb3db922624519ac502604d916">DAY2SEC</a>; <span class="comment">//days</span>
<a name="l00239"></a>00239   
<a name="l00240"></a>00240   <span class="comment">/* </span>
<a name="l00241"></a>00241 <span class="comment">     &quot;where r is the ratio of universal to sidereal time as given by Aoki et al. (1992),&quot;</span>
<a name="l00242"></a>00242 <span class="comment">  */</span>
<a name="l00243"></a>00243   <a class="code" href="classSBNutation.html#a8728be17404baf85a1674e664cc37470">R</a> = 1.002737909350795 + 5.9006e-11*T_u - 5.9e-15*T_u2;
<a name="l00244"></a>00244   
<a name="l00245"></a>00245   <span class="comment">/*</span>
<a name="l00246"></a>00246 <span class="comment">    &quot;(ii) the interval of GMST from 0h UT1 to the hour of the observation in UT1,&quot;</span>
<a name="l00247"></a>00247 <span class="comment">  */</span>
<a name="l00248"></a>00248   <a class="code" href="classSBNutation.html#a71058c37e069f68877125739fdb9cecd" title="Greenwich Mean Sidereal Time.">GMST</a> = GMST0h + <a class="code" href="classSBNutation.html#a8728be17404baf85a1674e664cc37470">R</a>*(T.<a class="code" href="classSBTime.html#a85fa42d1dc9fe0c7604c377de22c9c9f">UT1</a>().<a class="code" href="classSBMJD.html#a1de516f6d3d75ea6e940d6ffba77dd4a">time</a>());   <span class="comment">// days</span>
<a name="l00249"></a>00249   <a class="code" href="classSBNutation.html#a71058c37e069f68877125739fdb9cecd" title="Greenwich Mean Sidereal Time.">GMST</a> = fmod(GMST, 1.0);               <span class="comment">// days</span>
<a name="l00250"></a>00250   <span class="keywordflow">if</span> (GMST&lt;0.0)
<a name="l00251"></a>00251     GMST+= 1.0;
<a name="l00252"></a>00252 
<a name="l00253"></a>00253   GMST*=2.0*M_PI;                       <span class="comment">// rad</span>
<a name="l00254"></a>00254 
<a name="l00255"></a>00255   <span class="comment">/*</span>
<a name="l00256"></a>00256 <span class="comment">    &quot;(iii) accumulated precession and nutation in right ascension (Aoki and Kinoshita, 1983),&quot;</span>
<a name="l00257"></a>00257 <span class="comment">  */</span>
<a name="l00258"></a>00258   <a class="code" href="classSBNutation.html#aaff13dc3dd84b9dd9fd627cd48373c2a" title="Greenwich Sidereal Time.">GST</a> = GMST + <a class="code" href="classSBNutation.html#a18736088b1857a9d5a19a28f1c02095b">eqEquinox</a>();             <span class="comment">// rad</span>
<a name="l00259"></a>00259 };
<a name="l00260"></a>00260 <span class="comment">/*==============================================================================================*/</span>
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 
<a name="l00263"></a>00263 
<a name="l00264"></a>00264 <span class="comment">/*==============================================================================================*/</span>
<a name="l00265"></a>00265 <span class="comment">/*                                                                                              */</span>
<a name="l00266"></a>00266 <span class="comment">/* class SBNut_IAU1980 implementation                                                           */</span>
<a name="l00267"></a>00267 <span class="comment">/*                                                                                              */</span>
<a name="l00268"></a>00268 <span class="comment">/*==============================================================================================*/</span>
<a name="l00272"></a><a class="code" href="classSBNut__IAU1980.html#acdc3e78edf36a7f8a6117bff2e29496c">00272</a> <a class="code" href="classSBNut__IAU1980.html#acdc3e78edf36a7f8a6117bff2e29496c">SBNut_IAU1980::SBNut_IAU1980</a>(<span class="keyword">const</span> <a class="code" href="classSBConfig.html">SBConfig</a> *Cfg_, <a class="code" href="classSBEOP.html">SBEOP</a>* EOP_) 
<a name="l00273"></a>00273   : <a class="code" href="classSBNutation.html">SBNutation</a>(Cfg_, EOP_)
<a name="l00274"></a>00274 {
<a name="l00275"></a>00275   <span class="keywordflow">switch</span> (<a class="code" href="classSBNutation.html#ab876d42be08837986ca7d7956c7f10e9">Cfg</a>-&gt;<a class="code" href="classSBConfig.html#a7ae5d8f5f16bdbcbb699a1a976e07c91">nutModel</a>())
<a name="l00276"></a>00276     {
<a name="l00277"></a>00277     <span class="keywordflow">default</span>:
<a name="l00278"></a>00278     <span class="keywordflow">case</span> <a class="code" href="classSBConfig.html#a19389bcee1ee23aa4add3b134aecec75aacd458bf4803138de02acfaefdf6db77">SBConfig::NM_IAU1980</a>: <a class="code" href="classSBNutation.html#a4c5f4734ba3f907d334141282c126079" title="nutation theory">Theory</a> = <span class="keyword">new</span> <a class="code" href="classSBNutThIAU1980.html">SBNutThIAU1980</a>; <span class="keywordflow">break</span>;
<a name="l00279"></a>00279     <span class="keywordflow">case</span> <a class="code" href="classSBConfig.html#a19389bcee1ee23aa4add3b134aecec75a7d1bb6014c91d7ecb7f4b34d3a321a78">SBConfig::NM_IAU1996</a>: <a class="code" href="classSBNutation.html#a4c5f4734ba3f907d334141282c126079" title="nutation theory">Theory</a> = <span class="keyword">new</span> <a class="code" href="classSBNutThIAU1996.html">SBNutThIAU1996</a>; <span class="keywordflow">break</span>;
<a name="l00280"></a>00280     };
<a name="l00281"></a>00281 };
<a name="l00282"></a>00282 
<a name="l00283"></a><a class="code" href="classSBNut__IAU1980.html#a0aa9e7aae0deeebc6784be39fc42d43c">00283</a> <span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3</a>&amp; <a class="code" href="classSBNut__IAU1980.html#a0aa9e7aae0deeebc6784be39fc42d43c">SBNut_IAU1980::operator()</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l00284"></a>00284 {
<a name="l00285"></a>00285   <span class="keywordtype">double</span> t = (T.<a class="code" href="classSBTime.html#ad8753001fdea9be0f2bbcb1798251e16">TT</a>() - <a class="code" href="SbGeoTime_8C.html#af3440a08fa10f55224b98a7c82fecddc">TEphem</a>)/36525.0;
<a name="l00286"></a>00286   <span class="comment">//  double t = (T.TDB() - TEphem)/36525.0;</span>
<a name="l00287"></a>00287   <span class="keywordtype">double</span> t2 = t*t, t3 = t2*t;
<a name="l00288"></a>00288 
<a name="l00289"></a>00289   <a class="code" href="classSBNutation.html#aacbc48b0d3da1560e9d4acc4b8cc9e72">DPsi</a> = <a class="code" href="classSBNutation.html#a7dcbfc8b1d80724c81f387a9f309e5e0">DEps</a> = 0.0;
<a name="l00290"></a>00290   <a class="code" href="classSBNutation.html#a8c17ac56fa7253a77add52f21868b178" title="mean obliquity">Eps</a> = <a class="code" href="classSBNutation.html#a4e17b4f7d3ca2ec03d6d29e081313c82" title="obliquity at J2000.0">EphemEps</a> + <a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>*(-46.8150*t - 0.00059*t2 + 0.001813*t3);
<a name="l00291"></a>00291 
<a name="l00292"></a>00292   <a class="code" href="classSBNutation.html#a4c5f4734ba3f907d334141282c126079" title="nutation theory">Theory</a>-&gt;<a class="code" href="classSBNutThGeneral.html#a13794298ab111954815d3ec24093107e">calc</a>(T);
<a name="l00293"></a>00293 
<a name="l00294"></a>00294   <a class="code" href="classSBNutation.html#afeefa62ba07917649b53998aafaeb0ee" title="nutation in obliquity">DeltaEps</a> = <a class="code" href="classSBNutation.html#a4c5f4734ba3f907d334141282c126079" title="nutation theory">Theory</a>-&gt;<a class="code" href="classSBNutThGeneral.html#a065e51e453e83ff5f74fea0566c5bc23">deltaEps</a>();
<a name="l00295"></a>00295   <a class="code" href="classSBNutation.html#a7fb200b0fb83c995b424e1ee34b5f02f" title="nutation in longitude">DeltaPsi</a> = <a class="code" href="classSBNutation.html#a4c5f4734ba3f907d334141282c126079" title="nutation theory">Theory</a>-&gt;<a class="code" href="classSBNutThGeneral.html#af2f3fe0211c4930152d13b77046323f4">deltaPsi</a>();
<a name="l00296"></a>00296   <span class="keywordflow">if</span> (<a class="code" href="classSBNutation.html#ab876d42be08837986ca7d7956c7f10e9">Cfg</a>-&gt;<a class="code" href="classSBConfig.html#abfb24b8626cc3bd7c2880449e420aa20">isNeedGeodNut</a>())
<a name="l00297"></a>00297     <a class="code" href="classSBNutation.html#a7fb200b0fb83c995b424e1ee34b5f02f" title="nutation in longitude">DeltaPsi</a> += <a class="code" href="classSBNut__IAU1980.html#a1bd338ddd5d367c8497b141eaa55d440">geodesicNutation</a>(T);
<a name="l00298"></a>00298   
<a name="l00299"></a>00299   <span class="keywordflow">if</span> (<a class="code" href="classSBNutation.html#a70fbb5f53bdcdfb943d6b44e453e547a" title="EOP database.">EOP</a>) 
<a name="l00300"></a>00300     {
<a name="l00301"></a>00301       <a class="code" href="classSBNutation.html#a7fb200b0fb83c995b424e1ee34b5f02f" title="nutation in longitude">DeltaPsi</a> += (<a class="code" href="classSBNutation.html#aacbc48b0d3da1560e9d4acc4b8cc9e72">DPsi</a> = <a class="code" href="classSBNutation.html#a70fbb5f53bdcdfb943d6b44e453e547a" title="EOP database.">EOP</a>-&gt;<a class="code" href="classSBEOP.html#a26abb1c9949d9486e927b90faab31ad6">dPsi</a>(T));
<a name="l00302"></a>00302       <a class="code" href="classSBNutation.html#afeefa62ba07917649b53998aafaeb0ee" title="nutation in obliquity">DeltaEps</a> += (<a class="code" href="classSBNutation.html#a7dcbfc8b1d80724c81f387a9f309e5e0">DEps</a> = <a class="code" href="classSBNutation.html#a70fbb5f53bdcdfb943d6b44e453e547a" title="EOP database.">EOP</a>-&gt;<a class="code" href="classSBEOP.html#a229dcb1758316ab4a8f2b8191be98646">dEps</a>(T));
<a name="l00303"></a>00303     };
<a name="l00304"></a>00304   
<a name="l00305"></a>00305   (<a class="code" href="classMatrix3.html">Matrix3</a>&amp;)*<span class="keyword">this</span> = <a class="code" href="classSBNutation.html#ad7b19c4f5a2ad2504a44877f5aeb197d">R1</a>(-<a class="code" href="classSBNutation.html#a8c17ac56fa7253a77add52f21868b178" title="mean obliquity">Eps</a>)*<a class="code" href="classSBNutation.html#ad69b2e9252202745f0917c366c05a32a">R2</a>(<a class="code" href="classSBNutation.html#a7fb200b0fb83c995b424e1ee34b5f02f" title="nutation in longitude">DeltaPsi</a>)*<a class="code" href="classSBNutation.html#a166bfbc81b583758de8925ec55ec8b50">R3</a>(<a class="code" href="classSBNutation.html#a8c17ac56fa7253a77add52f21868b178" title="mean obliquity">Eps</a> + <a class="code" href="classSBNutation.html#afeefa62ba07917649b53998aafaeb0ee" title="nutation in obliquity">DeltaEps</a>);
<a name="l00306"></a>00306 
<a name="l00307"></a>00307   <a class="code" href="classSBNutation.html#a6a79270d2da9fb57eb7c2a702bc8df47">DR2dpsi</a>(<a class="code" href="classSBNutation.html#a7fb200b0fb83c995b424e1ee34b5f02f" title="nutation in longitude">DeltaPsi</a>);
<a name="l00308"></a>00308   <a class="code" href="classSBNutation.html#a05a2c00400d40d637f17a1699c2a069e">DR3deps</a>(<a class="code" href="classSBNutation.html#a8c17ac56fa7253a77add52f21868b178" title="mean obliquity">Eps</a> + <a class="code" href="classSBNutation.html#afeefa62ba07917649b53998aafaeb0ee" title="nutation in obliquity">DeltaEps</a>);
<a name="l00309"></a>00309   
<a name="l00310"></a>00310 
<a name="l00311"></a>00311   <span class="keywordflow">if</span> (<a class="code" href="classSBNutation.html#ab876d42be08837986ca7d7956c7f10e9">Cfg</a>-&gt;<a class="code" href="classSBConfig.html#a9e5ef7ef70e3a059747c519d6fdad2ff">nutEquinox</a>()==<a class="code" href="classSBConfig.html#aa6d5fad9ac8f9bbaea0d8ff9b8830c46a445a6ad3569891f924bced0c22b46ba5">SBConfig::NEE_SOVERS</a>)
<a name="l00312"></a>00312     <span class="comment">/*</span>
<a name="l00313"></a>00313 <span class="comment">      O.J.Sovers, C.S.Jacobs</span>
<a name="l00314"></a>00314 <span class="comment">      &quot;Observation Model and Parameter Partials for the JPL VLBI </span>
<a name="l00315"></a>00315 <span class="comment">      Parameter Estimation Software &quot;MODEST&quot;-1996&quot;</span>
<a name="l00316"></a>00316 <span class="comment">      page 32 says:</span>
<a name="l00317"></a>00317 <span class="comment">      &quot;   By the very definition of &quot;mean of date&quot; and &quot;true of date&quot;, nutation causes a difference</span>
<a name="l00318"></a>00318 <span class="comment">      in the hour angles of the mean equinox of date and the true equinox of date. This difference,</span>
<a name="l00319"></a>00319 <span class="comment">      called the &quot;equation of equinoxes&quot;, is denoted by {\alpha_E} and is obtained as follows:&quot;</span>
<a name="l00320"></a>00320 <span class="comment">    */</span>
<a name="l00321"></a>00321     <a class="code" href="classSBNutation.html#a9c3a5f626ce0e11f8cddaa37e210350f" title="equation of equinox">AlphaE</a> = atan2(<a class="code" href="classMatrix3.html#a15cd5ab258a110ee30a73bc6d231a68c">mat</a>[0][1], <a class="code" href="classMatrix3.html#a15cd5ab258a110ee30a73bc6d231a68c">mat</a>[0][0]);
<a name="l00322"></a>00322   <span class="keywordflow">else</span>
<a name="l00323"></a>00323     <span class="keywordflow">if</span> (<a class="code" href="classSBNutation.html#ab876d42be08837986ca7d7956c7f10e9">Cfg</a>-&gt;<a class="code" href="classSBConfig.html#a9e5ef7ef70e3a059747c519d6fdad2ff">nutEquinox</a>()==<a class="code" href="classSBConfig.html#aa6d5fad9ac8f9bbaea0d8ff9b8830c46a9af5da0e591b5b4a19371e3857eeca69">SBConfig::NEE_IERS92</a>)
<a name="l00324"></a>00324       <span class="comment">/*</span>
<a name="l00325"></a>00325 <span class="comment">      */</span>
<a name="l00326"></a>00326       <a class="code" href="classSBNutation.html#a9c3a5f626ce0e11f8cddaa37e210350f" title="equation of equinox">AlphaE</a> = <a class="code" href="classSBNutation.html#a7fb200b0fb83c995b424e1ee34b5f02f" title="nutation in longitude">DeltaPsi</a>*cos(<a class="code" href="classSBNutation.html#a8c17ac56fa7253a77add52f21868b178" title="mean obliquity">Eps</a>);
<a name="l00327"></a>00327     <span class="keywordflow">else</span>
<a name="l00328"></a>00328       <span class="comment">/*</span>
<a name="l00329"></a>00329 <span class="comment">        IERS Technical Note 21,</span>
<a name="l00330"></a>00330 <span class="comment">        IERS Conventions (1996)</span>
<a name="l00331"></a>00331 <span class="comment">        page 21 says:</span>
<a name="l00332"></a>00332 <span class="comment">        &quot; (iii) accumulated precession and nutation in right ascension (Aoki and Kinoshita, 1983),</span>
<a name="l00333"></a>00333 <span class="comment">        GST = GMST + \Delta\psi*cos(\epsilon_E) + 0&quot;.0026*sin(\Omega) + 0&quot;.000063*sin(2*\Omega),</span>
<a name="l00334"></a>00334 <span class="comment">        where \Omega is the mean longitude of the ascending node of the lunar orbit. The last two</span>
<a name="l00335"></a>00335 <span class="comment">        terms have not been included in the IERS Standards previosly. They should not be included</span>
<a name="l00336"></a>00336 <span class="comment">        in (iii) until 1 January 1997 when their use will begin.&quot;</span>
<a name="l00337"></a>00337 <span class="comment">      */</span>
<a name="l00338"></a>00338       <a class="code" href="classSBNutation.html#a9c3a5f626ce0e11f8cddaa37e210350f" title="equation of equinox">AlphaE</a> = <a class="code" href="classSBNutation.html#a7fb200b0fb83c995b424e1ee34b5f02f" title="nutation in longitude">DeltaPsi</a>*cos(<a class="code" href="classSBNutation.html#a8c17ac56fa7253a77add52f21868b178" title="mean obliquity">Eps</a>) + <a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>*(0.00264*sin(T.<a class="code" href="classSBTime.html#a09dfa5604304cb84bad328402bd75ff4">fArg_Omega</a>()) + 0.000063*sin(2.0*T.<a class="code" href="classSBTime.html#a09dfa5604304cb84bad328402bd75ff4">fArg_Omega</a>()));
<a name="l00339"></a>00339 
<a name="l00340"></a>00340   <span class="comment">// calc GMST and GST:</span>
<a name="l00341"></a>00341   <a class="code" href="classSBNutation.html#a5d7fce34aa3d09fefaa40a90b51074ea">calcGST</a>(T);
<a name="l00342"></a>00342 
<a name="l00343"></a>00343   <span class="comment">// make a report:</span>
<a name="l00344"></a>00344   <span class="keywordflow">if</span> (<a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#aff04f6b9f1def9cc474fb04fef43f9fc">isEligible</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>))
<a name="l00345"></a>00345     {
<a name="l00346"></a>00346       <span class="comment">//Log-&gt;write(SBLog::DBG, SBLog::NUTATION, ClassName() + &quot;: Arg(TT)       : &quot; + T.TT().toString());</span>
<a name="l00347"></a>00347       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU1980.html#a7d66a68c4f122405e3d75daebd707621">ClassName</a>() + <span class="stringliteral">&quot;: Arg(TDB)       : &quot;</span> + T.<a class="code" href="classSBTime.html#a1ef377755e01021ba591e442fe5185f3">TDB</a>().<a class="code" href="classSBMJD.html#a503ad8eab15136efa52e77311b93d61a">toString</a>());
<a name="l00348"></a>00348       
<a name="l00349"></a>00349       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU1980.html#a7d66a68c4f122405e3d75daebd707621">ClassName</a>() + <span class="stringliteral">&quot;: Geodetic Nut. : &quot;</span> + 
<a name="l00350"></a>00350                  QString().sprintf(<span class="stringliteral">&quot;%.16f (arcsec)&quot;</span>, <a class="code" href="classSBNut__IAU1980.html#a1bd338ddd5d367c8497b141eaa55d440">geodesicNutation</a>(T)/SEC2RAD));
<a name="l00351"></a>00351 
<a name="l00352"></a>00352       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU1980.html#a7d66a68c4f122405e3d75daebd707621">ClassName</a>() + <span class="stringliteral">&quot;: Delta Psi     : &quot;</span> + 
<a name="l00353"></a>00353                  QString().sprintf(<span class="stringliteral">&quot;%20.16f (arcsec)&quot;</span>, <a class="code" href="classSBNutation.html#a7fb200b0fb83c995b424e1ee34b5f02f" title="nutation in longitude">DeltaPsi</a>/SEC2RAD));
<a name="l00354"></a>00354       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU1980.html#a7d66a68c4f122405e3d75daebd707621">ClassName</a>() + <span class="stringliteral">&quot;: Delta Eps     : &quot;</span> + 
<a name="l00355"></a>00355                  QString().sprintf(<span class="stringliteral">&quot;%20.16f (arcsec)&quot;</span>, <a class="code" href="classSBNutation.html#afeefa62ba07917649b53998aafaeb0ee" title="nutation in obliquity">DeltaEps</a>/SEC2RAD));
<a name="l00356"></a>00356 
<a name="l00357"></a>00357       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU1980.html#a7d66a68c4f122405e3d75daebd707621">ClassName</a>() + <span class="stringliteral">&quot;: Mean obliquity: &quot;</span> + <a class="code" href="SbGeo_8C.html#a3f7eee940ad099d0c3f3459b4210cbf9">rad2dmslStr</a>(<a class="code" href="classSBNutation.html#a8c17ac56fa7253a77add52f21868b178" title="mean obliquity">Eps</a>));
<a name="l00358"></a>00358       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU1980.html#a7d66a68c4f122405e3d75daebd707621">ClassName</a>() + <span class="stringliteral">&quot;: True obliquity: &quot;</span> + 
<a name="l00359"></a>00359                  <a class="code" href="SbGeo_8C.html#a3f7eee940ad099d0c3f3459b4210cbf9">rad2dmslStr</a>(<a class="code" href="classSBNutation.html#a8c17ac56fa7253a77add52f21868b178" title="mean obliquity">Eps</a>+<a class="code" href="classSBNutation.html#afeefa62ba07917649b53998aafaeb0ee" title="nutation in obliquity">DeltaEps</a>));
<a name="l00360"></a>00360 
<a name="l00361"></a>00361       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU1980.html#a7d66a68c4f122405e3d75daebd707621">ClassName</a>() + <span class="stringliteral">&quot;: AlphaE        : &quot;</span> + 
<a name="l00362"></a>00362                  QString().sprintf(<span class="stringliteral">&quot;%20.16f (arcsec)&quot;</span>, <a class="code" href="classSBNutation.html#a9c3a5f626ce0e11f8cddaa37e210350f" title="equation of equinox">AlphaE</a>/SEC2RAD));
<a name="l00363"></a>00363       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU1980.html#a7d66a68c4f122405e3d75daebd707621">ClassName</a>() + <span class="stringliteral">&quot;: AlphaE        : &quot;</span> + 
<a name="l00364"></a>00364                  QString().sprintf(<span class="stringliteral">&quot;%24.20f (rad)&quot;</span>, <a class="code" href="classSBNutation.html#a9c3a5f626ce0e11f8cddaa37e210350f" title="equation of equinox">AlphaE</a>));
<a name="l00365"></a>00365 
<a name="l00366"></a>00366 
<a name="l00367"></a>00367       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU1980.html#a7d66a68c4f122405e3d75daebd707621">ClassName</a>() + <span class="stringliteral">&quot;: R1.angle      : &quot;</span> + 
<a name="l00368"></a>00368                  QString().sprintf(<span class="stringliteral">&quot;%.16f (arcsec)&quot;</span>, <a class="code" href="classSBNutation.html#ad7b19c4f5a2ad2504a44877f5aeb197d">R1</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00369"></a>00369       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU1980.html#a7d66a68c4f122405e3d75daebd707621">ClassName</a>() + <span class="stringliteral">&quot;: R1.angle      : &quot;</span> + 
<a name="l00370"></a>00370                  QString().sprintf(<span class="stringliteral">&quot;%.20f (rad)&quot;</span>, <a class="code" href="classSBNutation.html#ad7b19c4f5a2ad2504a44877f5aeb197d">R1</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()));
<a name="l00371"></a>00371       <a class="code" href="classSBNutation.html#ad7b19c4f5a2ad2504a44877f5aeb197d">R1</a>.<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU1980.html#a7d66a68c4f122405e3d75daebd707621">ClassName</a>() + <span class="stringliteral">&quot;: R1(-eps_)     : &quot;</span>);
<a name="l00372"></a>00372       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU1980.html#a7d66a68c4f122405e3d75daebd707621">ClassName</a>() + <span class="stringliteral">&quot;: R2.angle      : &quot;</span> + 
<a name="l00373"></a>00373                  QString().sprintf(<span class="stringliteral">&quot;%.16f (arcsec)&quot;</span>, <a class="code" href="classSBNutation.html#ad69b2e9252202745f0917c366c05a32a">R2</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00374"></a>00374       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU1980.html#a7d66a68c4f122405e3d75daebd707621">ClassName</a>() + <span class="stringliteral">&quot;: R2.angle      : &quot;</span> + 
<a name="l00375"></a>00375                  QString().sprintf(<span class="stringliteral">&quot;%.20f (rad)&quot;</span>, <a class="code" href="classSBNutation.html#ad69b2e9252202745f0917c366c05a32a">R2</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()));
<a name="l00376"></a>00376       <a class="code" href="classSBNutation.html#ad69b2e9252202745f0917c366c05a32a">R2</a>.<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU1980.html#a7d66a68c4f122405e3d75daebd707621">ClassName</a>() + <span class="stringliteral">&quot;: R2(delta psi) : &quot;</span>);
<a name="l00377"></a>00377       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU1980.html#a7d66a68c4f122405e3d75daebd707621">ClassName</a>() + <span class="stringliteral">&quot;: R3.angle      : &quot;</span> + 
<a name="l00378"></a>00378                  QString().sprintf(<span class="stringliteral">&quot;%.16f (arcsec)&quot;</span>, <a class="code" href="classSBNutation.html#a166bfbc81b583758de8925ec55ec8b50">R3</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00379"></a>00379       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU1980.html#a7d66a68c4f122405e3d75daebd707621">ClassName</a>() + <span class="stringliteral">&quot;: R3.angle      : &quot;</span> + 
<a name="l00380"></a>00380                  QString().sprintf(<span class="stringliteral">&quot;%.20f (rad)&quot;</span>, <a class="code" href="classSBNutation.html#a166bfbc81b583758de8925ec55ec8b50">R3</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()));
<a name="l00381"></a>00381       <a class="code" href="classSBNutation.html#a166bfbc81b583758de8925ec55ec8b50">R3</a>.<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU1980.html#a7d66a68c4f122405e3d75daebd707621">ClassName</a>() + <span class="stringliteral">&quot;: R3(eps+deps)  : &quot;</span>);
<a name="l00382"></a>00382 
<a name="l00383"></a>00383       this-&gt;<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU1980.html#a7d66a68c4f122405e3d75daebd707621">ClassName</a>() + <span class="stringliteral">&quot;: matrix        : &quot;</span>);
<a name="l00384"></a>00384     };
<a name="l00385"></a>00385 
<a name="l00386"></a>00386 
<a name="l00387"></a>00387   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00388"></a>00388 };
<a name="l00389"></a>00389 
<a name="l00390"></a><a class="code" href="classSBNut__IAU1980.html#a1bd338ddd5d367c8497b141eaa55d440">00390</a> <span class="keywordtype">double</span> <a class="code" href="classSBNut__IAU1980.html#a1bd338ddd5d367c8497b141eaa55d440">SBNut_IAU1980::geodesicNutation</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l00391"></a>00391 {
<a name="l00392"></a>00392   <span class="keywordflow">return</span> <a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>*(-0.000153*sin(T.<a class="code" href="classSBTime.html#a51abab9b1f86e70370819b54576f8769">fArg_lPrime</a>()) - 0.000002*sin(2.0*T.<a class="code" href="classSBTime.html#a51abab9b1f86e70370819b54576f8769">fArg_lPrime</a>()));
<a name="l00393"></a>00393 };
<a name="l00394"></a>00394 <span class="comment">/*==============================================================================================*/</span>
<a name="l00395"></a>00395 
<a name="l00396"></a>00396 
<a name="l00397"></a>00397 
<a name="l00398"></a>00398 <span class="comment">/*==============================================================================================*/</span>
<a name="l00399"></a>00399 <span class="comment">/*                                                                                              */</span>
<a name="l00400"></a>00400 <span class="comment">/* class SBNut_IAU2000 implementation                                                           */</span>
<a name="l00401"></a>00401 <span class="comment">/*                                                                                              */</span>
<a name="l00402"></a>00402 <span class="comment">/*==============================================================================================*/</span>
<a name="l00406"></a><a class="code" href="classSBNut__IAU2000.html#a74ff4719e1d2a205b5785cab7c764bfa">00406</a> <a class="code" href="classSBNut__IAU2000.html#a74ff4719e1d2a205b5785cab7c764bfa">SBNut_IAU2000::SBNut_IAU2000</a>(<span class="keyword">const</span> <a class="code" href="classSBConfig.html">SBConfig</a> *Cfg_, <a class="code" href="classSBEOP.html">SBEOP</a>* EOP_) 
<a name="l00407"></a>00407   : <a class="code" href="classSBNutation.html">SBNutation</a>(Cfg_, EOP_)
<a name="l00408"></a>00408 {
<a name="l00409"></a>00409   <a class="code" href="classSBNutation.html#a4c5f4734ba3f907d334141282c126079" title="nutation theory">Theory</a> = <span class="keyword">new</span> <a class="code" href="classSBNutThIAU2000A.html">SBNutThIAU2000A</a>;
<a name="l00410"></a>00410 };
<a name="l00411"></a>00411 
<a name="l00412"></a><a class="code" href="classSBNut__IAU2000.html#a9e2be45125cb99d7eb2e282d9e965e49">00412</a> <span class="keywordtype">void</span> <a class="code" href="classSBNut__IAU2000.html#a9e2be45125cb99d7eb2e282d9e965e49">SBNut_IAU2000::calcGST</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l00413"></a>00413 {
<a name="l00414"></a>00414   <span class="comment">//  if (Cfg-&gt;nutModel()==SBConfig::NM_IAU2000)</span>
<a name="l00415"></a>00415   <span class="comment">//    {</span>
<a name="l00416"></a>00416   <span class="comment">//      double t = (Time.TDB() - TEphem)/36525.0;</span>
<a name="l00417"></a>00417   <span class="comment">//      double t2=t*t;</span>
<a name="l00418"></a>00418   <span class="comment">//      GMST+= // microarcsec v</span>
<a name="l00419"></a>00419   <span class="comment">//    SEC2RAD*1.0e-6*(14506.0 - 274950.12*t + 117.21*t2 - 0.44*t*t2 + 18.82*t2*t2);</span>
<a name="l00420"></a>00420   <span class="comment">//    };</span>
<a name="l00421"></a>00421 
<a name="l00422"></a>00422   <span class="comment">//  double    t = (T.TDB() - TEphem)/36525.0;</span>
<a name="l00423"></a>00423   <span class="keywordtype">double</span>        t = (T.<a class="code" href="classSBTime.html#ad8753001fdea9be0f2bbcb1798251e16">TT</a>() - <a class="code" href="SbGeoTime_8C.html#af3440a08fa10f55224b98a7c82fecddc">TEphem</a>)/36525.0;
<a name="l00424"></a>00424   <span class="keywordtype">double</span>        t2 = t*t;
<a name="l00425"></a>00425   <span class="keywordtype">double</span>        ERA=0.0;
<a name="l00426"></a>00426   <span class="keywordtype">double</span>        PolinomialPart=0.0;
<a name="l00427"></a>00427   <span class="keywordtype">double</span>        NonPolinomialPart=0.0;
<a name="l00428"></a>00428 
<a name="l00429"></a>00429   <a class="code" href="classSBNutation.html#a8728be17404baf85a1674e664cc37470">R</a>     = 1.00273781191135448;
<a name="l00430"></a>00430   ERA   = 2.0*M_PI*(0.7790572732640 + fmod(<a class="code" href="classSBNutation.html#a8728be17404baf85a1674e664cc37470">R</a>*(T.<a class="code" href="classSBTime.html#a85fa42d1dc9fe0c7604c377de22c9c9f">UT1</a>() - <a class="code" href="SbGeoTime_8C.html#af3440a08fa10f55224b98a7c82fecddc">TEphem</a>), 1.0)); <span class="comment">//rad</span>
<a name="l00431"></a>00431   
<a name="l00432"></a>00432   PolinomialPart = 0.014506 + 4612.15739966*t + 1.39667721*t2 - 0.00009344*t*t2 + 0.00001882*t2*t2;
<a name="l00433"></a>00433   <a class="code" href="classSBNutation.html#a71058c37e069f68877125739fdb9cecd" title="Greenwich Mean Sidereal Time.">GMST</a> = ERA + PolinomialPart*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l00434"></a>00434   
<a name="l00435"></a>00435   <span class="keywordtype">double</span>        A_01 = T.<a class="code" href="classSBTime.html#a2332d64fb28c9310e859d2c9b6160ae1">fArg_l</a>();
<a name="l00436"></a>00436   <span class="keywordtype">double</span>        A_02 = T.<a class="code" href="classSBTime.html#a51abab9b1f86e70370819b54576f8769">fArg_lPrime</a>();
<a name="l00437"></a>00437   <span class="keywordtype">double</span>        A_03 = T.<a class="code" href="classSBTime.html#a054bbe5e1ea61692ba83b20ba476af03">fArg_F</a>();
<a name="l00438"></a>00438   <span class="keywordtype">double</span>        A_04 = T.<a class="code" href="classSBTime.html#a5d54ea8c67e5d556f626889d159661bf">fArg_D</a>();
<a name="l00439"></a>00439   <span class="keywordtype">double</span>        A_05 = T.<a class="code" href="classSBTime.html#a09dfa5604304cb84bad328402bd75ff4">fArg_Omega</a>();
<a name="l00440"></a>00440   <span class="keywordtype">double</span>        A_07 = fmod(3.176146697 + 1021.3285546211 *t,               2.0*M_PI);
<a name="l00441"></a>00441   <span class="keywordtype">double</span>        A_08 = fmod(1.753470314 +  628.3075849991 *t,               2.0*M_PI);
<a name="l00442"></a>00442   <span class="keywordtype">double</span>        A_14 = fmod(                 0.024381750  *t + 0.00000538691*t*t,2.0*M_PI);
<a name="l00443"></a>00443 
<a name="l00444"></a>00444 
<a name="l00445"></a>00445   NonPolinomialPart = 
<a name="l00446"></a>00446     2640.96*sin(                    A_05)       - 0.39*cos(                    A_05)
<a name="l00447"></a>00447     + 63.52*sin(                  2*A_05)       - 0.02*cos(                  2*A_05)
<a name="l00448"></a>00448     + 11.75*sin(2*A_03 - 2*A_04 + 3*A_05)       + 0.01*cos(2*A_03 - 2*A_04 + 3*A_05)
<a name="l00449"></a>00449     + 11.21*sin(2*A_03 - 2*A_04 +   A_05)       + 0.01*cos(2*A_03 - 2*A_04 +   A_05)
<a name="l00450"></a>00450     -  4.55*sin(2*A_03 - 2*A_04 + 2*A_05)
<a name="l00451"></a>00451     +  2.02*sin(2*A_03          + 3*A_05)
<a name="l00452"></a>00452     +  1.98*sin(2*A_03          +   A_05)
<a name="l00453"></a>00453     -  1.72*sin(                  3*A_05)
<a name="l00454"></a>00454     -  1.41*sin(  A_02          +   A_05)       - 0.01*cos(  A_02          +   A_05)
<a name="l00455"></a>00455     -  1.26*sin(  A_02          -   A_05)       - 0.01*cos(  A_02          -   A_05)
<a name="l00456"></a>00456     -  0.63*sin(  A_01          -   A_05)
<a name="l00457"></a>00457     -  0.63*sin(  A_01          +   A_05)
<a name="l00458"></a>00458     +  0.46*sin(  A_02 + 2*A_03 - 2*A_04 + 3*A_05)
<a name="l00459"></a>00459     +  0.45*sin(  A_02 + 2*A_03 - 2*A_04 +   A_05)
<a name="l00460"></a>00460     +  0.36*sin(4*A_03 - 4*A_04 + 4*A_05)
<a name="l00461"></a>00461     -  0.24*sin(  A_03 -   A_04 +   A_05 - 8*A_07 + 12*A_08) - 0.12*cos(A_03 - A_04 + A_05 - 8*A_07 + 12*A_08)
<a name="l00462"></a>00462     +  0.32*sin(2*A_03)
<a name="l00463"></a>00463     +  0.28*sin(2*A_03          + 2*A_05)
<a name="l00464"></a>00464     +  0.27*sin(  A_01 + 2*A_03 + 3*A_05)
<a name="l00465"></a>00465     +  0.26*sin(  A_01 + 2*A_03 +   A_05)
<a name="l00466"></a>00466     -  0.21*sin(2*A_03 - 2*A_04)
<a name="l00467"></a>00467     +  0.19*sin(  A_02 - 2*A_03 + 2*A_04 - 3*A_05)
<a name="l00468"></a>00468     +  0.18*sin(  A_02 - 2*A_03 + 2*A_04 -   A_05)
<a name="l00469"></a>00469     -  0.10*sin(8*A_07 - 13*A_08 -  A_14)       + 0.05*cos(8*A_07 - 13*A_08 - A_14)
<a name="l00470"></a>00470     +  0.15*sin(2*A_04)
<a name="l00471"></a>00471     -  0.14*sin(2*A_01 - 2*A_03 -   A_05)
<a name="l00472"></a>00472     +  0.14*sin(  A_01 - 2*A_04 +   A_05)
<a name="l00473"></a>00473     -  0.14*sin(  A_02 + 2*A_03 - 2*A_04 + 2*A_05)
<a name="l00474"></a>00474     +  0.14*sin(  A_01 - 2*A_04 -   A_05)
<a name="l00475"></a>00475     +  0.13*sin(4*A_03 - 2*A_04 + 4*A_05)
<a name="l00476"></a>00476     -  0.11*sin(2*A_03 - 2*A_04 + 4*A_05)
<a name="l00477"></a>00477     +  0.11*sin(  A_01 - 2*A_03 - 3*A_05)
<a name="l00478"></a>00478     +  0.11*sin(  A_01 - 2*A_03 -   A_05)
<a name="l00479"></a>00479     -  0.87*sin(  A_05)*t;
<a name="l00480"></a>00480   
<a name="l00481"></a>00481   <a class="code" href="classSBNutation.html#aaff13dc3dd84b9dd9fd627cd48373c2a" title="Greenwich Sidereal Time.">GST</a> = <a class="code" href="classSBNutation.html#a71058c37e069f68877125739fdb9cecd" title="Greenwich Mean Sidereal Time.">GMST</a> + <a class="code" href="classSBNutation.html#a18736088b1857a9d5a19a28f1c02095b">eqEquinox</a>() + NonPolinomialPart*SEC2RAD*1.0e-6;
<a name="l00482"></a>00482 };
<a name="l00483"></a>00483 
<a name="l00484"></a><a class="code" href="classSBNut__IAU2000.html#a7802f172632e3cd24517574f42d51a82">00484</a> <span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3</a>&amp; <a class="code" href="classSBNut__IAU2000.html#a7802f172632e3cd24517574f42d51a82">SBNut_IAU2000::operator()</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l00485"></a>00485 {
<a name="l00486"></a>00486   <span class="keywordtype">double</span> t = (T.<a class="code" href="classSBTime.html#ad8753001fdea9be0f2bbcb1798251e16">TT</a>() - <a class="code" href="SbGeoTime_8C.html#af3440a08fa10f55224b98a7c82fecddc">TEphem</a>)/36525.0;
<a name="l00487"></a>00487   <span class="comment">//  double t = (T.TDB() - TEphem)/36525.0;</span>
<a name="l00488"></a>00488   <a class="code" href="classSBNutation.html#aacbc48b0d3da1560e9d4acc4b8cc9e72">DPsi</a> = <a class="code" href="classSBNutation.html#a7dcbfc8b1d80724c81f387a9f309e5e0">DEps</a> = 0.0;
<a name="l00489"></a>00489 
<a name="l00490"></a>00490   <a class="code" href="classSBNutation.html#a8c17ac56fa7253a77add52f21868b178" title="mean obliquity">Eps</a> = <a class="code" href="classSBNutation.html#a4e17b4f7d3ca2ec03d6d29e081313c82" title="obliquity at J2000.0">EphemEps</a> + <a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>*(-46.84024*t - 0.00059*t*t + 0.001813*t*t*t);
<a name="l00491"></a>00491 
<a name="l00492"></a>00492   <a class="code" href="classSBNutation.html#a4c5f4734ba3f907d334141282c126079" title="nutation theory">Theory</a>-&gt;<a class="code" href="classSBNutThGeneral.html#a13794298ab111954815d3ec24093107e">calc</a>(T);
<a name="l00493"></a>00493 
<a name="l00494"></a>00494   <a class="code" href="classSBNutation.html#afeefa62ba07917649b53998aafaeb0ee" title="nutation in obliquity">DeltaEps</a> = <a class="code" href="classSBNutation.html#a4c5f4734ba3f907d334141282c126079" title="nutation theory">Theory</a>-&gt;<a class="code" href="classSBNutThGeneral.html#a065e51e453e83ff5f74fea0566c5bc23">deltaEps</a>();
<a name="l00495"></a>00495   <a class="code" href="classSBNutation.html#a7fb200b0fb83c995b424e1ee34b5f02f" title="nutation in longitude">DeltaPsi</a> = <a class="code" href="classSBNutation.html#a4c5f4734ba3f907d334141282c126079" title="nutation theory">Theory</a>-&gt;<a class="code" href="classSBNutThGeneral.html#af2f3fe0211c4930152d13b77046323f4">deltaPsi</a>();
<a name="l00496"></a>00496 
<a name="l00497"></a>00497   <span class="keywordflow">if</span> (<a class="code" href="classSBNutation.html#a70fbb5f53bdcdfb943d6b44e453e547a" title="EOP database.">EOP</a>) 
<a name="l00498"></a>00498     {
<a name="l00499"></a>00499       <a class="code" href="classSBNutation.html#a7fb200b0fb83c995b424e1ee34b5f02f" title="nutation in longitude">DeltaPsi</a> += (<a class="code" href="classSBNutation.html#aacbc48b0d3da1560e9d4acc4b8cc9e72">DPsi</a> = <a class="code" href="classSBNutation.html#a70fbb5f53bdcdfb943d6b44e453e547a" title="EOP database.">EOP</a>-&gt;<a class="code" href="classSBEOP.html#a26abb1c9949d9486e927b90faab31ad6">dPsi</a>(T));
<a name="l00500"></a>00500       <a class="code" href="classSBNutation.html#afeefa62ba07917649b53998aafaeb0ee" title="nutation in obliquity">DeltaEps</a> += (<a class="code" href="classSBNutation.html#a7dcbfc8b1d80724c81f387a9f309e5e0">DEps</a> = <a class="code" href="classSBNutation.html#a70fbb5f53bdcdfb943d6b44e453e547a" title="EOP database.">EOP</a>-&gt;<a class="code" href="classSBEOP.html#a229dcb1758316ab4a8f2b8191be98646">dEps</a>(T));
<a name="l00501"></a>00501     };
<a name="l00502"></a>00502   
<a name="l00503"></a>00503   (<a class="code" href="classMatrix3.html">Matrix3</a>&amp;)*<span class="keyword">this</span> = <a class="code" href="classSBNutation.html#ad7b19c4f5a2ad2504a44877f5aeb197d">R1</a>(-<a class="code" href="classSBNutation.html#a8c17ac56fa7253a77add52f21868b178" title="mean obliquity">Eps</a>)*<a class="code" href="classSBNutation.html#ad69b2e9252202745f0917c366c05a32a">R2</a>(<a class="code" href="classSBNutation.html#a7fb200b0fb83c995b424e1ee34b5f02f" title="nutation in longitude">DeltaPsi</a>)*<a class="code" href="classSBNutation.html#a166bfbc81b583758de8925ec55ec8b50">R3</a>(<a class="code" href="classSBNutation.html#a8c17ac56fa7253a77add52f21868b178" title="mean obliquity">Eps</a> + <a class="code" href="classSBNutation.html#afeefa62ba07917649b53998aafaeb0ee" title="nutation in obliquity">DeltaEps</a>);
<a name="l00504"></a>00504 
<a name="l00505"></a>00505   <a class="code" href="classSBNutation.html#a6a79270d2da9fb57eb7c2a702bc8df47">DR2dpsi</a>(<a class="code" href="classSBNutation.html#a7fb200b0fb83c995b424e1ee34b5f02f" title="nutation in longitude">DeltaPsi</a>);
<a name="l00506"></a>00506   <a class="code" href="classSBNutation.html#a05a2c00400d40d637f17a1699c2a069e">DR3deps</a>(<a class="code" href="classSBNutation.html#a8c17ac56fa7253a77add52f21868b178" title="mean obliquity">Eps</a> + <a class="code" href="classSBNutation.html#afeefa62ba07917649b53998aafaeb0ee" title="nutation in obliquity">DeltaEps</a>);
<a name="l00507"></a>00507   
<a name="l00508"></a>00508 
<a name="l00509"></a>00509   <span class="keywordflow">if</span> (<a class="code" href="classSBNutation.html#ab876d42be08837986ca7d7956c7f10e9">Cfg</a>-&gt;<a class="code" href="classSBConfig.html#a9e5ef7ef70e3a059747c519d6fdad2ff">nutEquinox</a>()==<a class="code" href="classSBConfig.html#aa6d5fad9ac8f9bbaea0d8ff9b8830c46a445a6ad3569891f924bced0c22b46ba5">SBConfig::NEE_SOVERS</a>)
<a name="l00510"></a>00510     <span class="comment">/*</span>
<a name="l00511"></a>00511 <span class="comment">      O.J.Sovers, C.S.Jacobs</span>
<a name="l00512"></a>00512 <span class="comment">      &quot;Observation Model and Parameter Partials for the JPL VLBI </span>
<a name="l00513"></a>00513 <span class="comment">      Parameter Estimation Software &quot;MODEST&quot;-1996&quot;</span>
<a name="l00514"></a>00514 <span class="comment">      page 32 says:</span>
<a name="l00515"></a>00515 <span class="comment">      &quot;   By the very definition of &quot;mean of date&quot; and &quot;true of date&quot;, nutation causes a difference</span>
<a name="l00516"></a>00516 <span class="comment">      in the hour angles of the mean equinox of date and the true equinox of date. This difference,</span>
<a name="l00517"></a>00517 <span class="comment">      called the &quot;equation of equinoxes&quot;, is denoted by {\alpha_E} and is obtained as follows:&quot;</span>
<a name="l00518"></a>00518 <span class="comment">    */</span>
<a name="l00519"></a>00519     <a class="code" href="classSBNutation.html#a9c3a5f626ce0e11f8cddaa37e210350f" title="equation of equinox">AlphaE</a> = atan2(<a class="code" href="classMatrix3.html#a15cd5ab258a110ee30a73bc6d231a68c">mat</a>[0][1], <a class="code" href="classMatrix3.html#a15cd5ab258a110ee30a73bc6d231a68c">mat</a>[0][0]);
<a name="l00520"></a>00520   <span class="keywordflow">else</span>
<a name="l00521"></a>00521     <span class="comment">/*</span>
<a name="l00522"></a>00522 <span class="comment">      IERS Technical Note 21,</span>
<a name="l00523"></a>00523 <span class="comment">      IERS Conventions (1996)</span>
<a name="l00524"></a>00524 <span class="comment">      page 21 says:</span>
<a name="l00525"></a>00525 <span class="comment">      &quot; (iii) accumulated precession and nutation in right ascension (Aoki and Kinoshita, 1983),</span>
<a name="l00526"></a>00526 <span class="comment">      GST = GMST + \Delta\psi*cos(\epsilon_E) + 0&quot;.0026*sin(\Omega) + 0&quot;.000063*sin(2*\Omega),</span>
<a name="l00527"></a>00527 <span class="comment">      where \Omega is the mean longitude of the ascending node of the lunar orbit. The last two</span>
<a name="l00528"></a>00528 <span class="comment">      terms have not been included in the IERS Standards previosly. They should not be included</span>
<a name="l00529"></a>00529 <span class="comment">      in (iii) until 1 January 1997 when their use will begin.&quot;</span>
<a name="l00530"></a>00530 <span class="comment">    */</span>
<a name="l00531"></a>00531     <a class="code" href="classSBNutation.html#a9c3a5f626ce0e11f8cddaa37e210350f" title="equation of equinox">AlphaE</a> = <a class="code" href="classSBNutation.html#a7fb200b0fb83c995b424e1ee34b5f02f" title="nutation in longitude">DeltaPsi</a>*cos(<a class="code" href="classSBNutation.html#a8c17ac56fa7253a77add52f21868b178" title="mean obliquity">Eps</a>)<span class="comment">/* + SEC2RAD*(0.00264*sin(T.fArg_Omega()) + 0.000063*sin(2.0*T.fArg_Omega()))*/</span>;
<a name="l00532"></a>00532 
<a name="l00533"></a>00533   <span class="comment">// calc GMST and GST:</span>
<a name="l00534"></a>00534   <a class="code" href="classSBNut__IAU2000.html#a9e2be45125cb99d7eb2e282d9e965e49">calcGST</a>(T);
<a name="l00535"></a>00535   
<a name="l00536"></a>00536   <span class="comment">// make a report:</span>
<a name="l00537"></a>00537   <span class="keywordflow">if</span> (<a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#aff04f6b9f1def9cc474fb04fef43f9fc">isEligible</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>))
<a name="l00538"></a>00538     {
<a name="l00539"></a>00539       <span class="comment">//Log-&gt;write(SBLog::DBG, SBLog::NUTATION, ClassName() + &quot;: Arg(TT)       : &quot; + T.TT().toString());</span>
<a name="l00540"></a>00540       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU2000.html#aa2204bb017aaa28cba88fc644a37ac51">ClassName</a>() + <span class="stringliteral">&quot;: Arg(TDB)       : &quot;</span> + T.<a class="code" href="classSBTime.html#a1ef377755e01021ba591e442fe5185f3">TDB</a>().<a class="code" href="classSBMJD.html#a503ad8eab15136efa52e77311b93d61a">toString</a>());
<a name="l00541"></a>00541 
<a name="l00542"></a>00542       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU2000.html#aa2204bb017aaa28cba88fc644a37ac51">ClassName</a>() + <span class="stringliteral">&quot;: Geodetic Nut. : &quot;</span> + 
<a name="l00543"></a>00543                  QString().sprintf(<span class="stringliteral">&quot;%.16f (arcsec)&quot;</span>, <a class="code" href="classSBNutation.html#a83a6653fe7a0ef76a38ce62a94d977ca">geodesicNutation</a>(T)/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00544"></a>00544 
<a name="l00545"></a>00545       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU2000.html#aa2204bb017aaa28cba88fc644a37ac51">ClassName</a>() + <span class="stringliteral">&quot;: Delta Psi     : &quot;</span> + 
<a name="l00546"></a>00546                  QString().sprintf(<span class="stringliteral">&quot;%20.16f (arcsec)&quot;</span>, <a class="code" href="classSBNutation.html#a7fb200b0fb83c995b424e1ee34b5f02f" title="nutation in longitude">DeltaPsi</a>/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00547"></a>00547       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU2000.html#aa2204bb017aaa28cba88fc644a37ac51">ClassName</a>() + <span class="stringliteral">&quot;: Delta Eps     : &quot;</span> + 
<a name="l00548"></a>00548                  QString().sprintf(<span class="stringliteral">&quot;%20.16f (arcsec)&quot;</span>, <a class="code" href="classSBNutation.html#afeefa62ba07917649b53998aafaeb0ee" title="nutation in obliquity">DeltaEps</a>/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00549"></a>00549 
<a name="l00550"></a>00550       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU2000.html#aa2204bb017aaa28cba88fc644a37ac51">ClassName</a>() + <span class="stringliteral">&quot;: Mean obliquity: &quot;</span> + <a class="code" href="SbGeo_8C.html#a3f7eee940ad099d0c3f3459b4210cbf9">rad2dmslStr</a>(<a class="code" href="classSBNutation.html#a8c17ac56fa7253a77add52f21868b178" title="mean obliquity">Eps</a>));
<a name="l00551"></a>00551       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU2000.html#aa2204bb017aaa28cba88fc644a37ac51">ClassName</a>() + <span class="stringliteral">&quot;: True obliquity: &quot;</span> + 
<a name="l00552"></a>00552                  <a class="code" href="SbGeo_8C.html#a3f7eee940ad099d0c3f3459b4210cbf9">rad2dmslStr</a>(<a class="code" href="classSBNutation.html#a8c17ac56fa7253a77add52f21868b178" title="mean obliquity">Eps</a>+<a class="code" href="classSBNutation.html#afeefa62ba07917649b53998aafaeb0ee" title="nutation in obliquity">DeltaEps</a>));
<a name="l00553"></a>00553 
<a name="l00554"></a>00554       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU2000.html#aa2204bb017aaa28cba88fc644a37ac51">ClassName</a>() + <span class="stringliteral">&quot;: AlphaE        : &quot;</span> + 
<a name="l00555"></a>00555                  QString().sprintf(<span class="stringliteral">&quot;%20.16f (arcsec)&quot;</span>, <a class="code" href="classSBNutation.html#a9c3a5f626ce0e11f8cddaa37e210350f" title="equation of equinox">AlphaE</a>/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00556"></a>00556       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU2000.html#aa2204bb017aaa28cba88fc644a37ac51">ClassName</a>() + <span class="stringliteral">&quot;: AlphaE        : &quot;</span> + 
<a name="l00557"></a>00557                  QString().sprintf(<span class="stringliteral">&quot;%24.20f (rad)&quot;</span>, <a class="code" href="classSBNutation.html#a9c3a5f626ce0e11f8cddaa37e210350f" title="equation of equinox">AlphaE</a>));
<a name="l00558"></a>00558 
<a name="l00559"></a>00559 
<a name="l00560"></a>00560       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU2000.html#aa2204bb017aaa28cba88fc644a37ac51">ClassName</a>() + <span class="stringliteral">&quot;: R1.angle      : &quot;</span> + 
<a name="l00561"></a>00561                  QString().sprintf(<span class="stringliteral">&quot;%.16f (arcsec)&quot;</span>, <a class="code" href="classSBNutation.html#ad7b19c4f5a2ad2504a44877f5aeb197d">R1</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00562"></a>00562       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU2000.html#aa2204bb017aaa28cba88fc644a37ac51">ClassName</a>() + <span class="stringliteral">&quot;: R1.angle      : &quot;</span> + 
<a name="l00563"></a>00563                  QString().sprintf(<span class="stringliteral">&quot;%.20f (rad)&quot;</span>, <a class="code" href="classSBNutation.html#ad7b19c4f5a2ad2504a44877f5aeb197d">R1</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()));
<a name="l00564"></a>00564       <a class="code" href="classSBNutation.html#ad7b19c4f5a2ad2504a44877f5aeb197d">R1</a>.<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU2000.html#aa2204bb017aaa28cba88fc644a37ac51">ClassName</a>() + <span class="stringliteral">&quot;: R1(-eps_)     : &quot;</span>);
<a name="l00565"></a>00565       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU2000.html#aa2204bb017aaa28cba88fc644a37ac51">ClassName</a>() + <span class="stringliteral">&quot;: R2.angle      : &quot;</span> + 
<a name="l00566"></a>00566                  QString().sprintf(<span class="stringliteral">&quot;%.16f (arcsec)&quot;</span>, <a class="code" href="classSBNutation.html#ad69b2e9252202745f0917c366c05a32a">R2</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00567"></a>00567       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU2000.html#aa2204bb017aaa28cba88fc644a37ac51">ClassName</a>() + <span class="stringliteral">&quot;: R2.angle      : &quot;</span> + 
<a name="l00568"></a>00568                  QString().sprintf(<span class="stringliteral">&quot;%.20f (rad)&quot;</span>, <a class="code" href="classSBNutation.html#ad69b2e9252202745f0917c366c05a32a">R2</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()));
<a name="l00569"></a>00569       <a class="code" href="classSBNutation.html#ad69b2e9252202745f0917c366c05a32a">R2</a>.<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU2000.html#aa2204bb017aaa28cba88fc644a37ac51">ClassName</a>() + <span class="stringliteral">&quot;: R2(delta psi) : &quot;</span>);
<a name="l00570"></a>00570       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU2000.html#aa2204bb017aaa28cba88fc644a37ac51">ClassName</a>() + <span class="stringliteral">&quot;: R3.angle      : &quot;</span> + 
<a name="l00571"></a>00571                  QString().sprintf(<span class="stringliteral">&quot;%.16f (arcsec)&quot;</span>, <a class="code" href="classSBNutation.html#a166bfbc81b583758de8925ec55ec8b50">R3</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00572"></a>00572       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU2000.html#aa2204bb017aaa28cba88fc644a37ac51">ClassName</a>() + <span class="stringliteral">&quot;: R3.angle      : &quot;</span> + 
<a name="l00573"></a>00573                  QString().sprintf(<span class="stringliteral">&quot;%.20f (rad)&quot;</span>, <a class="code" href="classSBNutation.html#a166bfbc81b583758de8925ec55ec8b50">R3</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()));
<a name="l00574"></a>00574       <a class="code" href="classSBNutation.html#a166bfbc81b583758de8925ec55ec8b50">R3</a>.<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU2000.html#aa2204bb017aaa28cba88fc644a37ac51">ClassName</a>() + <span class="stringliteral">&quot;: R3(eps+deps)  : &quot;</span>);
<a name="l00575"></a>00575 
<a name="l00576"></a>00576       this-&gt;<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNut__IAU2000.html#aa2204bb017aaa28cba88fc644a37ac51">ClassName</a>() + <span class="stringliteral">&quot;: matrix        : &quot;</span>);
<a name="l00577"></a>00577     };
<a name="l00578"></a>00578 
<a name="l00579"></a>00579 
<a name="l00580"></a>00580   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00581"></a>00581 };
<a name="l00582"></a>00582 <span class="comment">/*==============================================================================================*/</span>
<a name="l00583"></a>00583 
<a name="l00584"></a>00584 
<a name="l00585"></a>00585 
<a name="l00586"></a>00586 <span class="comment">/*==============================================================================================*/</span>
<a name="l00587"></a>00587 <span class="comment">/*                                                                                              */</span>
<a name="l00588"></a>00588 <span class="comment">/* class SBPrecNutNRO implementation                                                            */</span>
<a name="l00589"></a>00589 <span class="comment">/*                                                                                              */</span>
<a name="l00590"></a>00590 <span class="comment">/*==============================================================================================*/</span>
<a name="l00594"></a><a class="code" href="classSBPrecNutNRO.html#a4aa8f075cd49146e0f3e69fa0179a1b6">00594</a> <a class="code" href="classSBPrecNutNRO.html#a4aa8f075cd49146e0f3e69fa0179a1b6">SBPrecNutNRO::SBPrecNutNRO</a>(<span class="keyword">const</span> <a class="code" href="classSBConfig.html">SBConfig</a> *Cfg_, <a class="code" href="classSBEOP.html">SBEOP</a>* EOP_) 
<a name="l00595"></a>00595   : <a class="code" href="classMatrix3.html">Matrix3</a>(), R(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a4b8a53bafca6b43388660925049d734f">Z_AXIS</a>), Q()
<a name="l00596"></a>00596 {
<a name="l00597"></a>00597   <a class="code" href="classSBPrecNutNRO.html#a29659a8b8bd15b95eeda7acdb28e5ba2">Cfg</a>      = Cfg_;
<a name="l00598"></a>00598   <a class="code" href="classSBPrecNutNRO.html#ae52f381519a205d6051c96f8ec44b0db" title="EOP database.">EOP</a>      = EOP_;
<a name="l00599"></a>00599   <a class="code" href="classSBPrecNutNRO.html#a711623c721f1fb7f2f4e4f85800b9e72" title="X coordinate of the CEP in the CRS.">X</a>=<a class="code" href="classSBPrecNutNRO.html#a2a920283dc501c59766e12410a138e35" title="Y coordinate of the CEP in the CRS.">Y</a>=<a class="code" href="classSBPrecNutNRO.html#ae653a4673517d59d077a4ca916cd1b2b" title="s">S</a>=0.0;
<a name="l00600"></a>00600   <a class="code" href="classSBPrecNutNRO.html#a50ebaaeb2299dc1dd2c502083f5c45b0">DX</a> = <a class="code" href="classSBPrecNutNRO.html#ac3996fc34c9d48ea75a0d84246d6b2bb">DY</a> = 0.0;
<a name="l00601"></a>00601   <span class="keywordflow">if</span> (!<a class="code" href="classSBPrecNutNRO.html#ae52f381519a205d6051c96f8ec44b0db" title="EOP database.">EOP</a>)
<a name="l00602"></a>00602     <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a24bd42a9f4bccec3a28b80562a665db7">SBLog::WRN</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPrecNutNRO.html#aa68eded3c7c875117118444534e850c0">ClassName</a>() + <span class="stringliteral">&quot;: Warning, EOP database is NULL&quot;</span>);
<a name="l00603"></a>00603   <span class="comment">/*</span>
<a name="l00604"></a>00604 <span class="comment">  switch (Cfg-&gt;nutModel())</span>
<a name="l00605"></a>00605 <span class="comment">    {</span>
<a name="l00606"></a>00606 <span class="comment">    default:</span>
<a name="l00607"></a>00607 <span class="comment">    case SBConfig::NM_IAU1980: Theory = new SBNROThIAU1980; break;</span>
<a name="l00608"></a>00608 <span class="comment">    case SBConfig::NM_IAU1996: Theory = new SBNROThIAU1996; break;</span>
<a name="l00609"></a>00609 <span class="comment">    case SBConfig::NM_IAU2000: Theory = new SBNROThIAU2000A; break;</span>
<a name="l00610"></a>00610 <span class="comment">    };</span>
<a name="l00611"></a>00611 <span class="comment">  */</span>
<a name="l00612"></a>00612   <a class="code" href="classSBPrecNutNRO.html#aa3197c746d9d2ff6395752b49c3ae353" title="theoretical values of X, Y and s">Theory</a> = <span class="keyword">new</span> <a class="code" href="classSBNROThIAU2000A.html">SBNROThIAU2000A</a>;
<a name="l00613"></a>00613 };
<a name="l00614"></a>00614 
<a name="l00615"></a><a class="code" href="classSBPrecNutNRO.html#a0e8c2a289ac0f6776f8398690d47f5be">00615</a> <span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3</a>&amp; <a class="code" href="classSBPrecNutNRO.html#a0e8c2a289ac0f6776f8398690d47f5be">SBPrecNutNRO::operator()</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l00616"></a>00616 {
<a name="l00617"></a>00617   <a class="code" href="classSBPrecNutNRO.html#aa3197c746d9d2ff6395752b49c3ae353" title="theoretical values of X, Y and s">Theory</a>-&gt;<a class="code" href="classSBNROThGeneral.html#a44d8e7d5ded02fb73c1813cfd9cca71b">calc</a>(T);
<a name="l00618"></a>00618   <a class="code" href="classSBPrecNutNRO.html#a711623c721f1fb7f2f4e4f85800b9e72" title="X coordinate of the CEP in the CRS.">X</a>=<a class="code" href="classSBPrecNutNRO.html#aa3197c746d9d2ff6395752b49c3ae353" title="theoretical values of X, Y and s">Theory</a>-&gt;<a class="code" href="classSBNROThGeneral.html#a7e3312b2e0570b6530b503cffdf72b19">x</a>();
<a name="l00619"></a>00619   <a class="code" href="classSBPrecNutNRO.html#a2a920283dc501c59766e12410a138e35" title="Y coordinate of the CEP in the CRS.">Y</a>=<a class="code" href="classSBPrecNutNRO.html#aa3197c746d9d2ff6395752b49c3ae353" title="theoretical values of X, Y and s">Theory</a>-&gt;<a class="code" href="classSBNROThGeneral.html#ae79718f6a1eab2d07fa62aaae7bc4cd6">y</a>();
<a name="l00620"></a>00620   <a class="code" href="classSBPrecNutNRO.html#ae653a4673517d59d077a4ca916cd1b2b" title="s">S</a>=<a class="code" href="classSBPrecNutNRO.html#aa3197c746d9d2ff6395752b49c3ae353" title="theoretical values of X, Y and s">Theory</a>-&gt;<a class="code" href="classSBNROThGeneral.html#a88b20fe4bf52c6889eb194d72045d282">s</a>();
<a name="l00621"></a>00621   <a class="code" href="classSBPrecNutNRO.html#a50ebaaeb2299dc1dd2c502083f5c45b0">DX</a> = <a class="code" href="classSBPrecNutNRO.html#ac3996fc34c9d48ea75a0d84246d6b2bb">DY</a> = 0.0;
<a name="l00622"></a>00622 
<a name="l00623"></a>00623   <span class="keywordflow">if</span> (<a class="code" href="classSBPrecNutNRO.html#ae52f381519a205d6051c96f8ec44b0db" title="EOP database.">EOP</a>) 
<a name="l00624"></a>00624     {
<a name="l00625"></a>00625       <a class="code" href="classSBPrecNutNRO.html#a711623c721f1fb7f2f4e4f85800b9e72" title="X coordinate of the CEP in the CRS.">X</a> += (<a class="code" href="classSBPrecNutNRO.html#a50ebaaeb2299dc1dd2c502083f5c45b0">DX</a> = <a class="code" href="classSBPrecNutNRO.html#ae52f381519a205d6051c96f8ec44b0db" title="EOP database.">EOP</a>-&gt;<a class="code" href="classSBEOP.html#a26abb1c9949d9486e927b90faab31ad6">dPsi</a>(T));
<a name="l00626"></a>00626       <a class="code" href="classSBPrecNutNRO.html#a2a920283dc501c59766e12410a138e35" title="Y coordinate of the CEP in the CRS.">Y</a> += (<a class="code" href="classSBPrecNutNRO.html#ac3996fc34c9d48ea75a0d84246d6b2bb">DY</a> = <a class="code" href="classSBPrecNutNRO.html#ae52f381519a205d6051c96f8ec44b0db" title="EOP database.">EOP</a>-&gt;<a class="code" href="classSBEOP.html#a229dcb1758316ab4a8f2b8191be98646">dEps</a>(T));
<a name="l00627"></a>00627       <a class="code" href="classSBPrecNutNRO.html#ae653a4673517d59d077a4ca916cd1b2b" title="s">S</a> += -0.5*(<a class="code" href="classSBPrecNutNRO.html#a50ebaaeb2299dc1dd2c502083f5c45b0">DX</a> * <a class="code" href="classSBPrecNutNRO.html#ac3996fc34c9d48ea75a0d84246d6b2bb">DY</a>);
<a name="l00628"></a>00628     };
<a name="l00629"></a>00629 
<a name="l00630"></a>00630   <span class="keywordtype">double</span> a = 0.5 + 0.125*(<a class="code" href="classSBPrecNutNRO.html#a711623c721f1fb7f2f4e4f85800b9e72" title="X coordinate of the CEP in the CRS.">X</a>*<a class="code" href="classSBPrecNutNRO.html#a711623c721f1fb7f2f4e4f85800b9e72" title="X coordinate of the CEP in the CRS.">X</a> + <a class="code" href="classSBPrecNutNRO.html#a2a920283dc501c59766e12410a138e35" title="Y coordinate of the CEP in the CRS.">Y</a>*<a class="code" href="classSBPrecNutNRO.html#a2a920283dc501c59766e12410a138e35" title="Y coordinate of the CEP in the CRS.">Y</a>);
<a name="l00631"></a>00631   <a class="code" href="classSBPrecNutNRO.html#a38e4e8bfb45bbcb8e01879af3640f8c5">Q</a> = <a class="code" href="classMatrix3.html#a773fdcf139826ddb39c30e7d08bbdb90">Matrix3</a>(1.0 - a*<a class="code" href="classSBPrecNutNRO.html#a711623c721f1fb7f2f4e4f85800b9e72" title="X coordinate of the CEP in the CRS.">X</a>*<a class="code" href="classSBPrecNutNRO.html#a711623c721f1fb7f2f4e4f85800b9e72" title="X coordinate of the CEP in the CRS.">X</a>,      -a*X*<a class="code" href="classSBPrecNutNRO.html#a2a920283dc501c59766e12410a138e35" title="Y coordinate of the CEP in the CRS.">Y</a>,         X,
<a name="l00632"></a>00632               -a*X*Y,           1.0 - a*Y*Y,    Y,
<a name="l00633"></a>00633               -X,               -Y,             1.0 - a*(X*X + Y*Y));
<a name="l00634"></a>00634   <span class="keywordflow">return</span> ((<a class="code" href="classMatrix3.html">Matrix3</a>&amp;)*<span class="keyword">this</span> = <a class="code" href="classSBPrecNutNRO.html#a38e4e8bfb45bbcb8e01879af3640f8c5">Q</a>*<a class="code" href="classSBPrecNutNRO.html#a59cb54bb04f79b0a600b25e7fae8afc6">R</a>(<a class="code" href="classSBPrecNutNRO.html#ae653a4673517d59d077a4ca916cd1b2b" title="s">S</a>));
<a name="l00635"></a>00635 };
<a name="l00636"></a>00636 
<a name="l00637"></a><a class="code" href="classSBPrecNutNRO.html#ad05e9d5d3836ce8d21988d48fc675dfb">00637</a> <span class="keywordtype">double</span> <a class="code" href="classSBPrecNutNRO.html#ad05e9d5d3836ce8d21988d48fc675dfb">SBPrecNutNRO::geodesicNutation</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l00638"></a>00638 {
<a name="l00639"></a>00639   <span class="keywordflow">return</span> (-0.0000609*sin(T.<a class="code" href="classSBTime.html#a51abab9b1f86e70370819b54576f8769">fArg_lPrime</a>()) - 0.0000008*sin(2.0*T.<a class="code" href="classSBTime.html#a51abab9b1f86e70370819b54576f8769">fArg_lPrime</a>()))*
<a name="l00640"></a>00640     <a class="code" href="classSBNutation.html#a764f7abde10c189385c93da2eaf6c3dd">SBNutation::ephemEps</a>()*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l00641"></a>00641 };
<a name="l00642"></a>00642 <span class="comment">/*==============================================================================================*/</span>
<a name="l00643"></a>00643 
<a name="l00644"></a>00644 
<a name="l00645"></a>00645 
<a name="l00646"></a>00646 <span class="comment">/*==============================================================================================*/</span>
<a name="l00647"></a>00647 <span class="comment">/*                                                                                              */</span>
<a name="l00648"></a>00648 <span class="comment">/* class SBPolus implementation                                                                 */</span>
<a name="l00649"></a>00649 <span class="comment">/*                                                                                              */</span>
<a name="l00650"></a>00650 <span class="comment">/*==============================================================================================*/</span>
<a name="l00654"></a><a class="code" href="classSBPolus.html#a892436b8ba7bc903de1ec80bf390d105">00654</a> <a class="code" href="classSBPolus.html#a892436b8ba7bc903de1ec80bf390d105">SBPolus::SBPolus</a>(<a class="code" href="classSBEOP.html">SBEOP</a>* EOP_) 
<a name="l00655"></a>00655   : <a class="code" href="classMatrix3.html">Matrix3</a>(), R1(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a93ed1386222f87948b972889ad82cd33">X_AXIS</a>), R2(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0aa1ec9649c0a631b27ad7280af3522dd0">Y_AXIS</a>),
<a name="l00656"></a>00656     DR1dy(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a93ed1386222f87948b972889ad82cd33">X_AXIS</a>),
<a name="l00657"></a>00657     DR2dx(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0aa1ec9649c0a631b27ad7280af3522dd0">Y_AXIS</a>)
<a name="l00658"></a>00658 {
<a name="l00659"></a>00659   <a class="code" href="classSBPolus.html#a7239010a6456918b5f20b71fc73c6ce8">Xp</a>=<a class="code" href="classSBPolus.html#a4758edf91dbfa9d9adfb320dee157cff">Yp</a>=0.0; 
<a name="l00660"></a>00660   <span class="keywordflow">if</span> (!(<a class="code" href="classSBPolus.html#a6c9e8f1d440c9535300bd6c00a64288d" title="EOP database.">EOP</a>=EOP_))
<a name="l00661"></a>00661     <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a24bd42a9f4bccec3a28b80562a665db7">SBLog::WRN</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPolus.html#ad26e6382bdbb028dd5dd3ecd9740b416">ClassName</a>() + <span class="stringliteral">&quot;: Warning, EOP database is NULL&quot;</span>);
<a name="l00662"></a>00662 };
<a name="l00663"></a>00663 
<a name="l00664"></a><a class="code" href="classSBPolus.html#abac9406e9d02e30a0d0b849079ecedb9">00664</a> <span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3</a>&amp; <a class="code" href="classSBPolus.html#abac9406e9d02e30a0d0b849079ecedb9">SBPolus::operator()</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T, <a class="code" href="classSBFrame.html">SBFrame</a>* Frame)
<a name="l00665"></a>00665 {
<a name="l00666"></a>00666   <a class="code" href="classSBPolus.html#a7239010a6456918b5f20b71fc73c6ce8">Xp</a> = <a class="code" href="classSBPolus.html#a4758edf91dbfa9d9adfb320dee157cff">Yp</a> = 0.0;
<a name="l00667"></a>00667 
<a name="l00668"></a>00668   <span class="keywordflow">if</span> (<a class="code" href="classSBPolus.html#a6c9e8f1d440c9535300bd6c00a64288d" title="EOP database.">EOP</a>)
<a name="l00669"></a>00669     {
<a name="l00670"></a>00670       <a class="code" href="classSBPolus.html#a7239010a6456918b5f20b71fc73c6ce8">Xp</a> = <a class="code" href="classSBPolus.html#a6c9e8f1d440c9535300bd6c00a64288d" title="EOP database.">EOP</a>-&gt;<a class="code" href="classSBEOP.html#af07977f6ed092fc4e210c910e9306ae0">dX</a>(T);
<a name="l00671"></a>00671       <a class="code" href="classSBPolus.html#a4758edf91dbfa9d9adfb320dee157cff">Yp</a> = <a class="code" href="classSBPolus.html#a6c9e8f1d440c9535300bd6c00a64288d" title="EOP database.">EOP</a>-&gt;<a class="code" href="classSBEOP.html#a5bcda536600f3d782779b28f92c885b0">dY</a>(T);
<a name="l00672"></a>00672     };
<a name="l00673"></a>00673 
<a name="l00674"></a>00674   <span class="keywordtype">double</span>        Xp_total=<a class="code" href="classSBPolus.html#a7239010a6456918b5f20b71fc73c6ce8">Xp</a>, Yp_total=<a class="code" href="classSBPolus.html#a4758edf91dbfa9d9adfb320dee157cff">Yp</a>;
<a name="l00675"></a>00675 
<a name="l00676"></a>00676   <span class="keywordflow">if</span> (Frame)
<a name="l00677"></a>00677     {
<a name="l00678"></a>00678       Xp_total += Frame-&gt;<a class="code" href="classSBFrame.html#a92f8b5945ccfbcfa8b4db997cff1a455">diurnalDX</a>();
<a name="l00679"></a>00679       Yp_total += Frame-&gt;<a class="code" href="classSBFrame.html#ae491dc17212d2e29462dce4d5a1b7f3e">diurnalDY</a>();
<a name="l00680"></a>00680     };
<a name="l00681"></a>00681     
<a name="l00682"></a>00682 
<a name="l00683"></a>00683   (<a class="code" href="classMatrix3.html">Matrix3</a>&amp;)*<span class="keyword">this</span> = <a class="code" href="classSBPolus.html#a5e8a2e3ebd47066b005fe80092a2b937">R1</a>(Yp_total)*<a class="code" href="classSBPolus.html#aeeba0b18aba19582afcce3db6d4f8e2e">R2</a>(Xp_total);
<a name="l00684"></a>00684   <a class="code" href="classSBPolus.html#adfb58d723f8085940718bb3e95b1a02b">DR1dy</a>(Yp_total);
<a name="l00685"></a>00685   <a class="code" href="classSBPolus.html#afa9345a98d491b8ed12b4de1b35fa225">DR2dx</a>(Xp_total);
<a name="l00686"></a>00686   
<a name="l00687"></a>00687   <span class="comment">// make a report:</span>
<a name="l00688"></a>00688   <span class="keywordflow">if</span> (<a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#aff04f6b9f1def9cc474fb04fef43f9fc">isEligible</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a858e957d20f58a6daeae2def85828493">SBLog::PMOTION</a>))
<a name="l00689"></a>00689     {
<a name="l00690"></a>00690       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a858e957d20f58a6daeae2def85828493">SBLog::PMOTION</a>, <a class="code" href="classSBPolus.html#ad26e6382bdbb028dd5dd3ecd9740b416">ClassName</a>() + <span class="stringliteral">&quot;: Arg(UTC) : &quot;</span> + T.<a class="code" href="classSBTime.html#a0b90e4d0ba955ce1d260c1ab42f8e6d5">UTC</a>().<a class="code" href="classSBMJD.html#a503ad8eab15136efa52e77311b93d61a">toString</a>());
<a name="l00691"></a>00691 
<a name="l00692"></a>00692       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a858e957d20f58a6daeae2def85828493">SBLog::PMOTION</a>, <a class="code" href="classSBPolus.html#ad26e6382bdbb028dd5dd3ecd9740b416">ClassName</a>() + <span class="stringliteral">&quot;: Polus X  : &quot;</span> + 
<a name="l00693"></a>00693                  QString().sprintf(<span class="stringliteral">&quot;%16.6f (arcsec)&quot;</span>, Xp_total/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00694"></a>00694       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a858e957d20f58a6daeae2def85828493">SBLog::PMOTION</a>, <a class="code" href="classSBPolus.html#ad26e6382bdbb028dd5dd3ecd9740b416">ClassName</a>() + <span class="stringliteral">&quot;: Polus Y  : &quot;</span> + 
<a name="l00695"></a>00695                  QString().sprintf(<span class="stringliteral">&quot;%16.6f (arcsec)&quot;</span>, Yp_total/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00696"></a>00696       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a858e957d20f58a6daeae2def85828493">SBLog::PMOTION</a>, <a class="code" href="classSBPolus.html#ad26e6382bdbb028dd5dd3ecd9740b416">ClassName</a>() + <span class="stringliteral">&quot;: Diurnal X: &quot;</span> + 
<a name="l00697"></a>00697                  QString().sprintf(<span class="stringliteral">&quot;%16.6f (arcsec)&quot;</span>, Frame-&gt;<a class="code" href="classSBFrame.html#a92f8b5945ccfbcfa8b4db997cff1a455">diurnalDX</a>()/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00698"></a>00698       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a858e957d20f58a6daeae2def85828493">SBLog::PMOTION</a>, <a class="code" href="classSBPolus.html#ad26e6382bdbb028dd5dd3ecd9740b416">ClassName</a>() + <span class="stringliteral">&quot;: Diurnal Y: &quot;</span> + 
<a name="l00699"></a>00699                  QString().sprintf(<span class="stringliteral">&quot;%16.6f (arcsec)&quot;</span>, Frame-&gt;<a class="code" href="classSBFrame.html#a92f8b5945ccfbcfa8b4db997cff1a455">diurnalDX</a>()/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00700"></a>00700 
<a name="l00701"></a>00701       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPolus.html#ad26e6382bdbb028dd5dd3ecd9740b416">ClassName</a>() + <span class="stringliteral">&quot;: R1.angle : &quot;</span> + 
<a name="l00702"></a>00702                  QString().sprintf(<span class="stringliteral">&quot;%.16f (arcsec)&quot;</span>, <a class="code" href="classSBPolus.html#a5e8a2e3ebd47066b005fe80092a2b937">R1</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00703"></a>00703       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPolus.html#ad26e6382bdbb028dd5dd3ecd9740b416">ClassName</a>() + <span class="stringliteral">&quot;: R1.angle : &quot;</span> + 
<a name="l00704"></a>00704                  QString().sprintf(<span class="stringliteral">&quot;%.20f (rad)&quot;</span>, <a class="code" href="classSBPolus.html#a5e8a2e3ebd47066b005fe80092a2b937">R1</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()));
<a name="l00705"></a>00705       <a class="code" href="classSBPolus.html#a5e8a2e3ebd47066b005fe80092a2b937">R1</a>.<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPolus.html#ad26e6382bdbb028dd5dd3ecd9740b416">ClassName</a>() + <span class="stringliteral">&quot;: R1(y)    : &quot;</span>);
<a name="l00706"></a>00706       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPolus.html#ad26e6382bdbb028dd5dd3ecd9740b416">ClassName</a>() + <span class="stringliteral">&quot;: R2.angle : &quot;</span> + 
<a name="l00707"></a>00707                  QString().sprintf(<span class="stringliteral">&quot;%.16f (arcsec)&quot;</span>, <a class="code" href="classSBPolus.html#aeeba0b18aba19582afcce3db6d4f8e2e">R2</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00708"></a>00708       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPolus.html#ad26e6382bdbb028dd5dd3ecd9740b416">ClassName</a>() + <span class="stringliteral">&quot;: R2.angle : &quot;</span> + 
<a name="l00709"></a>00709                  QString().sprintf(<span class="stringliteral">&quot;%.20f (rad)&quot;</span>, <a class="code" href="classSBPolus.html#aeeba0b18aba19582afcce3db6d4f8e2e">R2</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()));
<a name="l00710"></a>00710       <a class="code" href="classSBPolus.html#aeeba0b18aba19582afcce3db6d4f8e2e">R2</a>.<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPolus.html#ad26e6382bdbb028dd5dd3ecd9740b416">ClassName</a>() + <span class="stringliteral">&quot;: R2(x)    : &quot;</span>);
<a name="l00711"></a>00711 
<a name="l00712"></a>00712       <a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a858e957d20f58a6daeae2def85828493">SBLog::PMOTION</a>, <a class="code" href="classSBPolus.html#ad26e6382bdbb028dd5dd3ecd9740b416">ClassName</a>() + <span class="stringliteral">&quot;: matrix   : &quot;</span>);
<a name="l00713"></a>00713     };
<a name="l00714"></a>00714 
<a name="l00715"></a>00715   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00716"></a>00716 };
<a name="l00717"></a>00717 <span class="comment">/*==============================================================================================*/</span>
<a name="l00718"></a>00718 
<a name="l00719"></a>00719 
<a name="l00720"></a>00720 
<a name="l00721"></a>00721 <span class="comment">/*==============================================================================================*/</span>
<a name="l00722"></a>00722 <span class="comment">/*                                                                                              */</span>
<a name="l00723"></a>00723 <span class="comment">/* class SBPolusNRO implementation                                                              */</span>
<a name="l00724"></a>00724 <span class="comment">/*                                                                                              */</span>
<a name="l00725"></a>00725 <span class="comment">/*==============================================================================================*/</span>
<a name="l00729"></a><a class="code" href="classSBPolusNRO.html#a479bae52929df75d4fb07db3e6e62f70">00729</a> <a class="code" href="classSBPolusNRO.html#a479bae52929df75d4fb07db3e6e62f70">SBPolusNRO::SBPolusNRO</a>(<a class="code" href="classSBEOP.html">SBEOP</a>* EOP_) 
<a name="l00730"></a>00730   : <a class="code" href="classMatrix3.html">Matrix3</a>(), R1(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a93ed1386222f87948b972889ad82cd33">X_AXIS</a>), R2(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0aa1ec9649c0a631b27ad7280af3522dd0">Y_AXIS</a>), R3(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a4b8a53bafca6b43388660925049d734f">Z_AXIS</a>),
<a name="l00731"></a>00731     DR1dy(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a93ed1386222f87948b972889ad82cd33">X_AXIS</a>),
<a name="l00732"></a>00732     DR2dx(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0aa1ec9649c0a631b27ad7280af3522dd0">Y_AXIS</a>)
<a name="l00733"></a>00733 {
<a name="l00734"></a>00734   <a class="code" href="classSBPolusNRO.html#ab2045ae575b054806e6464f1d40a95c3">Xp</a>=<a class="code" href="classSBPolusNRO.html#a8f355df537128bec42d5733cb0b18b1d">Yp</a>=<a class="code" href="classSBPolusNRO.html#ac7cc1015578441fdd6de5a503823003d">s_prime</a>=0.0;
<a name="l00735"></a>00735   <span class="keywordflow">if</span> (!(<a class="code" href="classSBPolusNRO.html#a4f1f444d452885548ab5bb216a91e3b7" title="EOP database.">EOP</a>=EOP_))
<a name="l00736"></a>00736     <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a24bd42a9f4bccec3a28b80562a665db7">SBLog::WRN</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBPolusNRO.html#aadb7c97238c534a4917b7c65d3eed63f">ClassName</a>() + <span class="stringliteral">&quot;: Warning, EOP database is NULL&quot;</span>);
<a name="l00737"></a>00737 };
<a name="l00738"></a>00738 
<a name="l00739"></a><a class="code" href="classSBPolusNRO.html#af1ca0561bd6e492d89e488495ce18cb5">00739</a> <span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3</a>&amp; <a class="code" href="classSBPolusNRO.html#af1ca0561bd6e492d89e488495ce18cb5">SBPolusNRO::operator()</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T, <a class="code" href="classSBFrame.html">SBFrame</a>* Frame)
<a name="l00740"></a>00740 {
<a name="l00741"></a>00741   <a class="code" href="classSBPolusNRO.html#ab2045ae575b054806e6464f1d40a95c3">Xp</a> = <a class="code" href="classSBPolusNRO.html#a8f355df537128bec42d5733cb0b18b1d">Yp</a> = <a class="code" href="classSBPolusNRO.html#ac7cc1015578441fdd6de5a503823003d">s_prime</a> = 0.0;
<a name="l00742"></a>00742 
<a name="l00743"></a>00743   <span class="keywordflow">if</span> (<a class="code" href="classSBPolusNRO.html#a4f1f444d452885548ab5bb216a91e3b7" title="EOP database.">EOP</a>)
<a name="l00744"></a>00744     {
<a name="l00745"></a>00745       <a class="code" href="classSBPolusNRO.html#ab2045ae575b054806e6464f1d40a95c3">Xp</a> = <a class="code" href="classSBPolusNRO.html#a4f1f444d452885548ab5bb216a91e3b7" title="EOP database.">EOP</a>-&gt;<a class="code" href="classSBEOP.html#af07977f6ed092fc4e210c910e9306ae0">dX</a>(T);
<a name="l00746"></a>00746       <a class="code" href="classSBPolusNRO.html#a8f355df537128bec42d5733cb0b18b1d">Yp</a> = <a class="code" href="classSBPolusNRO.html#a4f1f444d452885548ab5bb216a91e3b7" title="EOP database.">EOP</a>-&gt;<a class="code" href="classSBEOP.html#a5bcda536600f3d782779b28f92c885b0">dY</a>(T);
<a name="l00747"></a>00747     };
<a name="l00748"></a>00748 
<a name="l00749"></a>00749   <span class="keywordtype">double</span>        Xp_total=<a class="code" href="classSBPolusNRO.html#ab2045ae575b054806e6464f1d40a95c3">Xp</a>, Yp_total=<a class="code" href="classSBPolusNRO.html#a8f355df537128bec42d5733cb0b18b1d">Yp</a>;
<a name="l00750"></a>00750   
<a name="l00751"></a>00751   <span class="keywordflow">if</span> (Frame)
<a name="l00752"></a>00752     {
<a name="l00753"></a>00753       Xp_total += Frame-&gt;<a class="code" href="classSBFrame.html#a92f8b5945ccfbcfa8b4db997cff1a455">diurnalDX</a>();
<a name="l00754"></a>00754       Yp_total += Frame-&gt;<a class="code" href="classSBFrame.html#ae491dc17212d2e29462dce4d5a1b7f3e">diurnalDY</a>();
<a name="l00755"></a>00755     };
<a name="l00756"></a>00756   
<a name="l00757"></a>00757   <a class="code" href="classSBPolusNRO.html#ac7cc1015578441fdd6de5a503823003d">s_prime</a> = -47.0e-6*(T.<a class="code" href="classSBTime.html#ad8753001fdea9be0f2bbcb1798251e16">TT</a>() - <a class="code" href="SbGeoTime_8C.html#af3440a08fa10f55224b98a7c82fecddc">TEphem</a>)/36525.0*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l00758"></a>00758 
<a name="l00759"></a>00759   (<a class="code" href="classMatrix3.html">Matrix3</a>&amp;)*<span class="keyword">this</span> = <a class="code" href="classSBPolusNRO.html#a1127cfb35ac64332822bea52610e6fb0">R3</a>(-<a class="code" href="classSBPolusNRO.html#ac7cc1015578441fdd6de5a503823003d">s_prime</a>)*<a class="code" href="classSBPolusNRO.html#a7b5ddee43c09d05002a3eb7bfe8c66c8">R1</a>(Yp_total)*<a class="code" href="classSBPolusNRO.html#aceee0cc9f9903b9f59194d4476905de3">R2</a>(Xp_total);
<a name="l00760"></a>00760 
<a name="l00761"></a>00761   <a class="code" href="classSBPolusNRO.html#a463bf782aaddfece2c5388e745bcbb41">DR1dy</a>(Yp_total);
<a name="l00762"></a>00762   <a class="code" href="classSBPolusNRO.html#afdc8883493f7788084a2294cba88c1c8">DR2dx</a>(Xp_total);
<a name="l00763"></a>00763 
<a name="l00764"></a>00764   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00765"></a>00765 };
<a name="l00766"></a>00766 <span class="comment">/*==============================================================================================*/</span>
<a name="l00767"></a>00767 
<a name="l00768"></a>00768 
<a name="l00769"></a>00769 
<a name="l00770"></a>00770 <span class="comment">/*==============================================================================================*/</span>
<a name="l00771"></a>00771 <span class="comment">/*                                                                                              */</span>
<a name="l00772"></a>00772 <span class="comment">/* class SBFrame implementation                                                                 */</span>
<a name="l00773"></a>00773 <span class="comment">/*                                                                                              */</span>
<a name="l00774"></a>00774 <span class="comment">/*==============================================================================================*/</span>
<a name="l00775"></a><a class="code" href="classSBFrame.html#ae7ff49012435fa00924433bafe91f6aa">00775</a> <a class="code" href="classSBFrame.html#ae7ff49012435fa00924433bafe91f6aa">SBFrame::SBFrame</a>(<span class="keyword">const</span> <a class="code" href="classSBConfig.html">SBConfig</a> *Cfg_, <a class="code" href="classSBRunManager.html">SBRunManager</a> *Mgr_, <span class="keyword">const</span> QString&amp; Name_) 
<a name="l00776"></a>00776   : <a class="code" href="classMatrix3.html">Matrix3</a>(), <a class="code" href="classSBNamed.html">SBNamed</a>(Name_), Time(), CRS2TRS(<a class="code" href="SbVector3_8C.html#abeceef3c00b48ae35fe246ef2922c7d3">m3E</a>),
<a name="l00777"></a>00777     DQ_dt(<a class="code" href="SbVector3_8C.html#abeceef3c00b48ae35fe246ef2922c7d3">m3E</a>), 
<a name="l00778"></a>00778     DQ_dUT(<a class="code" href="SbVector3_8C.html#abeceef3c00b48ae35fe246ef2922c7d3">m3E</a>),
<a name="l00779"></a>00779     DQ_dxp(<a class="code" href="SbVector3_8C.html#abeceef3c00b48ae35fe246ef2922c7d3">m3E</a>),
<a name="l00780"></a>00780     DQ_dyp(<a class="code" href="SbVector3_8C.html#abeceef3c00b48ae35fe246ef2922c7d3">m3E</a>),
<a name="l00781"></a>00781     DQ_dpsi(<a class="code" href="SbVector3_8C.html#abeceef3c00b48ae35fe246ef2922c7d3">m3E</a>),
<a name="l00782"></a>00782     DQ_deps(<a class="code" href="SbVector3_8C.html#abeceef3c00b48ae35fe246ef2922c7d3">m3E</a>),
<a name="l00783"></a>00783 
<a name="l00784"></a>00784     DQ_dprec(<a class="code" href="SbVector3_8C.html#abeceef3c00b48ae35fe246ef2922c7d3">m3E</a>)
<a name="l00785"></a>00785 {
<a name="l00786"></a>00786   <a class="code" href="classSBFrame.html#a4740e11cb35ec8564e0f335d647a07ac">Cfg</a> = Cfg_;
<a name="l00787"></a>00787   <a class="code" href="classSBFrame.html#a9daf8b6e17e9f441c57d6a1d712675be">Mgr</a> = Mgr_;
<a name="l00788"></a>00788   <a class="code" href="classSBFrame.html#a3eeeb7bc6adc622e6beb5d671d75daa1">EOP</a> = <a class="code" href="SbSetup_8C.html#ab22099f310d06d492236a87cc020822b">SetUp</a>-&gt;<a class="code" href="classSBSetUp.html#a656a7eb69319962ca8ccf32f8593fd8d">loadEOP</a>();
<a name="l00789"></a>00789   <a class="code" href="classSBFrame.html#a3eeeb7bc6adc622e6beb5d671d75daa1">EOP</a> -&gt; setPtNum(<a class="code" href="classSBFrame.html#a4740e11cb35ec8564e0f335d647a07ac">Cfg</a>-&gt;<a class="code" href="classSBConfig.html#ac0da744ae19526af905fff3cc8a80bc2">eopNumIntrplPoints</a>());
<a name="l00790"></a>00790   <a class="code" href="classSBFrame.html#a3eeeb7bc6adc622e6beb5d671d75daa1">EOP</a> -&gt; setMgr(<a class="code" href="classSBFrame.html#a9daf8b6e17e9f441c57d6a1d712675be">Mgr</a>);
<a name="l00791"></a>00791   <a class="code" href="classSBFrame.html#ab3368355b5f4184cb2f849cfceb73d38">Time</a>.<a class="code" href="classSBTime.html#ae0c52e74f32a85e229255ad24e6e42e1">setEOP</a>(<a class="code" href="classSBFrame.html#a3eeeb7bc6adc622e6beb5d671d75daa1">EOP</a>);
<a name="l00792"></a>00792 
<a name="l00793"></a>00793   <span class="keywordflow">switch</span> (<a class="code" href="classSBFrame.html#a4740e11cb35ec8564e0f335d647a07ac">Cfg</a>-&gt;<a class="code" href="classSBConfig.html#a397a13d6c6d14d4c89a8928e2ed1958e">eopDiurnal</a>())
<a name="l00794"></a>00794     {
<a name="l00795"></a>00795     <span class="keywordflow">default</span>:
<a name="l00796"></a>00796     <span class="keywordflow">case</span> <a class="code" href="classSBConfig.html#a594942b4913b82ef1a21439090086043acad2578e77f58fce976fd30ead6cfcc4">SBConfig::EDM_NONE</a>:            <a class="code" href="classSBFrame.html#acf362a6317e4416c4fd9294870337599">EOPdiurnal</a> = <span class="keyword">new</span> <a class="code" href="classSBOTideEOPGeneral.html">SBOTideEOPGeneral</a>; <span class="keywordflow">break</span>; <span class="comment">// shunt</span>
<a name="l00797"></a>00797       <span class="comment">//    case SBConfig::EDM_Ray1995:         EOPdiurnal = new SBOTideEOPRay1994_1996; break; // recommended</span>
<a name="l00798"></a>00798     <span class="keywordflow">case</span> <a class="code" href="classSBConfig.html#a594942b4913b82ef1a21439090086043a7f1054dc0459eb119dcbe5997555b9f5">SBConfig::EDM_Ray1995</a>:         <a class="code" href="classSBFrame.html#acf362a6317e4416c4fd9294870337599">EOPdiurnal</a> = <span class="keyword">new</span> <a class="code" href="classSBOTideEOPRay1994__2003.html">SBOTideEOPRay1994_2003</a>; <span class="keywordflow">break</span>; <span class="comment">// recommended</span>
<a name="l00799"></a>00799     <span class="keywordflow">case</span> <a class="code" href="classSBConfig.html#a594942b4913b82ef1a21439090086043a7cf0145a5fa87c5b535dfa1cb87aa487">SBConfig::EDM_JPL92</a>:           <a class="code" href="classSBFrame.html#acf362a6317e4416c4fd9294870337599">EOPdiurnal</a> = <span class="keyword">new</span> <a class="code" href="classSBOTideEOP__JPL92.html">SBOTideEOP_JPL92</a>;  <span class="keywordflow">break</span>;
<a name="l00800"></a>00800     <span class="keywordflow">case</span> <a class="code" href="classSBConfig.html#a594942b4913b82ef1a21439090086043a5e1f05bab2850b89d71e115ec7cb202d">SBConfig::EDM_HD1994</a>:          <a class="code" href="classSBFrame.html#acf362a6317e4416c4fd9294870337599">EOPdiurnal</a> = <span class="keyword">new</span> <a class="code" href="classSBOTideEOP__HD1994.html">SBOTideEOP_HD1994</a>; <span class="keywordflow">break</span>;
<a name="l00801"></a>00801     <span class="keywordflow">case</span> <a class="code" href="classSBConfig.html#a594942b4913b82ef1a21439090086043af22a09b1e8605e4a204da231b6d13625">SBConfig::EDM_GSFC95</a>:          <a class="code" href="classSBFrame.html#acf362a6317e4416c4fd9294870337599">EOPdiurnal</a> = <span class="keyword">new</span> <a class="code" href="classSBOTideEOP__GSFC95.html">SBOTideEOP_GSFC95</a>; <span class="keywordflow">break</span>;
<a name="l00802"></a>00802     <span class="keywordflow">case</span> <a class="code" href="classSBConfig.html#a594942b4913b82ef1a21439090086043a3b25db15b18ead86c2a3fe3751637b34">SBConfig::EDM_Gipson1995</a>:      <a class="code" href="classSBFrame.html#acf362a6317e4416c4fd9294870337599">EOPdiurnal</a> = <span class="keyword">new</span> <a class="code" href="classSBOTideEOP__Gipson1995.html">SBOTideEOP_Gipson1995</a>; <span class="keywordflow">break</span>;
<a name="l00803"></a>00803     };
<a name="l00804"></a>00804 
<a name="l00805"></a>00805   <span class="keywordflow">switch</span> (<a class="code" href="classSBFrame.html#a4740e11cb35ec8564e0f335d647a07ac">Cfg</a>-&gt;<a class="code" href="classSBConfig.html#a7f2072916f0a3c581c8324c6beb8ad87">eopDiurnalAtm</a>())
<a name="l00806"></a>00806     {
<a name="l00807"></a>00807     <span class="keywordflow">default</span>:
<a name="l00808"></a>00808     <span class="keywordflow">case</span> <a class="code" href="classSBConfig.html#a0e92ca286708a0a32c10f6acc902d3b4addd3b5958485bde18bc5aa1ba9257c1b">SBConfig::EDMA_NONE</a>:   <a class="code" href="classSBFrame.html#a3a3efa98793111824b5f05aa795f4271">EOPdiurnalAtm</a> = <span class="keyword">new</span> <a class="code" href="classSBOTideEOPGeneral.html">SBOTideEOPGeneral</a>; <span class="keywordflow">break</span>; <span class="comment">// shunt</span>
<a name="l00809"></a>00809     <span class="keywordflow">case</span> <a class="code" href="classSBConfig.html#a0e92ca286708a0a32c10f6acc902d3b4a255db6c62ed443f4c5e8135f25cfee88">SBConfig::EDMA_BBP</a>:    <a class="code" href="classSBFrame.html#a3a3efa98793111824b5f05aa795f4271">EOPdiurnalAtm</a> = <span class="keyword">new</span> <a class="code" href="classSBATideEOP__BBP__02.html">SBATideEOP_BBP_02</a>; <span class="keywordflow">break</span>;
<a name="l00810"></a>00810     };
<a name="l00811"></a>00811   
<a name="l00812"></a>00812   <span class="keywordflow">switch</span> (<a class="code" href="classSBFrame.html#a4740e11cb35ec8564e0f335d647a07ac">Cfg</a>-&gt;<a class="code" href="classSBConfig.html#a5fd7991e3e7b3b8fd84b37c85c9ae6e9">eopDiurnalNonTidal</a>())
<a name="l00813"></a>00813     {
<a name="l00814"></a>00814     <span class="keywordflow">default</span>:
<a name="l00815"></a>00815     <span class="keywordflow">case</span> <a class="code" href="classSBConfig.html#a1181126c87eb362be43bebef81df59b4a2f6a9be47c951b12e3aefa8189ecf47c">SBConfig::EDMNT_NONE</a>:  <a class="code" href="classSBFrame.html#a869a43e4debedf7f36c9c512ce9c9537">EOPdiurnalNTd</a> = <span class="keyword">new</span> <a class="code" href="classSBOTideEOPGeneral.html">SBOTideEOPGeneral</a>; <span class="keywordflow">break</span>; <span class="comment">// shunt</span>
<a name="l00816"></a>00816     <span class="keywordflow">case</span> <a class="code" href="classSBConfig.html#a1181126c87eb362be43bebef81df59b4a6338d7c53292aba652b9946e1ca57511">SBConfig::EDMNT_Viron</a>: <a class="code" href="classSBFrame.html#a869a43e4debedf7f36c9c512ce9c9537">EOPdiurnalNTd</a> = <span class="keyword">new</span> <a class="code" href="classSBNonTideEOP__Viron__02.html">SBNonTideEOP_Viron_02</a>; <span class="keywordflow">break</span>;
<a name="l00817"></a>00817     };
<a name="l00818"></a>00818   
<a name="l00819"></a>00819   <span class="keywordflow">if</span> (<a class="code" href="classSBFrame.html#a4740e11cb35ec8564e0f335d647a07ac">Cfg</a>-&gt;<a class="code" href="classSBConfig.html#a7ae5d8f5f16bdbcbb699a1a976e07c91">nutModel</a>() == <a class="code" href="classSBConfig.html#a19389bcee1ee23aa4add3b134aecec75abb6e3c8f8ddbe8689bd07acd53e7de3d">SBConfig::NM_IAU2000</a>)
<a name="l00820"></a>00820     <a class="code" href="classSBFrame.html#a4b5d368cc22c204e61e6eff99da849d2">EOPdiurnalGrv</a> = <span class="keyword">new</span> <a class="code" href="classSBGravTideEOP__B__02.html">SBGravTideEOP_B_02</a>;
<a name="l00821"></a>00821   <span class="keywordflow">else</span>
<a name="l00822"></a>00822     <a class="code" href="classSBFrame.html#a4b5d368cc22c204e61e6eff99da849d2">EOPdiurnalGrv</a> = <span class="keyword">new</span> <a class="code" href="classSBOTideEOPGeneral.html">SBOTideEOPGeneral</a>;
<a name="l00823"></a>00823 
<a name="l00824"></a>00824   <a class="code" href="classSBFrame.html#af7294590e46f015a5d02f3599686e7d0">UT1_UTC</a> = 0.0;
<a name="l00825"></a>00825 };
<a name="l00826"></a>00826 
<a name="l00827"></a><a class="code" href="classSBFrame.html#ab358962b85f3bf91e8f317571c477846">00827</a> <a class="code" href="classSBFrame.html#ab358962b85f3bf91e8f317571c477846">SBFrame::~SBFrame</a>()
<a name="l00828"></a>00828 {
<a name="l00829"></a>00829   <span class="keywordflow">if</span> (<a class="code" href="classSBFrame.html#acf362a6317e4416c4fd9294870337599">EOPdiurnal</a>) <span class="keyword">delete</span> <a class="code" href="classSBFrame.html#acf362a6317e4416c4fd9294870337599">EOPdiurnal</a>; 
<a name="l00830"></a>00830 
<a name="l00831"></a>00831   <span class="keywordflow">if</span> (<a class="code" href="classSBFrame.html#a3a3efa98793111824b5f05aa795f4271">EOPdiurnalAtm</a>) <span class="keyword">delete</span> <a class="code" href="classSBFrame.html#a3a3efa98793111824b5f05aa795f4271">EOPdiurnalAtm</a>; 
<a name="l00832"></a>00832   <span class="keywordflow">if</span> (<a class="code" href="classSBFrame.html#a869a43e4debedf7f36c9c512ce9c9537">EOPdiurnalNTd</a>) <span class="keyword">delete</span> <a class="code" href="classSBFrame.html#a869a43e4debedf7f36c9c512ce9c9537">EOPdiurnalNTd</a>; 
<a name="l00833"></a>00833   <span class="keywordflow">if</span> (<a class="code" href="classSBFrame.html#a4b5d368cc22c204e61e6eff99da849d2">EOPdiurnalGrv</a>) <span class="keyword">delete</span> <a class="code" href="classSBFrame.html#a4b5d368cc22c204e61e6eff99da849d2">EOPdiurnalGrv</a>; 
<a name="l00834"></a>00834 
<a name="l00835"></a>00835   <span class="keywordflow">if</span> (<a class="code" href="classSBFrame.html#a3eeeb7bc6adc622e6beb5d671d75daa1">EOP</a>) <span class="keyword">delete</span> <a class="code" href="classSBFrame.html#a3eeeb7bc6adc622e6beb5d671d75daa1">EOP</a>;
<a name="l00836"></a>00836 };
<a name="l00837"></a>00837 <span class="comment">/*==============================================================================================*/</span>
<a name="l00838"></a>00838 
<a name="l00839"></a>00839 
<a name="l00840"></a>00840 
<a name="l00841"></a>00841 <span class="comment">/*==============================================================================================*/</span>
<a name="l00842"></a>00842 <span class="comment">/*                                                                                              */</span>
<a name="l00843"></a>00843 <span class="comment">/* class SBFrameClassic implementation                                                          */</span>
<a name="l00844"></a>00844 <span class="comment">/*                                                                                              */</span>
<a name="l00845"></a>00845 <span class="comment">/*==============================================================================================*/</span>
<a name="l00846"></a><a class="code" href="classSBFrameClassic.html#a0594f539ad5d7801bfde32644f9187f8">00846</a> <a class="code" href="classSBFrameClassic.html#a0594f539ad5d7801bfde32644f9187f8">SBFrameClassic::SBFrameClassic</a>(<span class="keyword">const</span> <a class="code" href="classSBConfig.html">SBConfig</a> *Cfg_, <a class="code" href="classSBRunManager.html">SBRunManager</a> *Mgr_, <span class="keyword">const</span> QString&amp; Name_)
<a name="l00847"></a>00847   : <a class="code" href="classSBFrame.html">SBFrame</a>(Cfg_, Mgr_, Name_), R(), W(EOP), R1(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a4b8a53bafca6b43388660925049d734f">Z_AXIS</a>), R2(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0aa1ec9649c0a631b27ad7280af3522dd0">Y_AXIS</a>), R3(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a93ed1386222f87948b972889ad82cd33">X_AXIS</a>), Bias(<a class="code" href="SbVector3_8C.html#abeceef3c00b48ae35fe246ef2922c7d3">m3E</a>)
<a name="l00848"></a>00848 {
<a name="l00849"></a>00849   <a class="code" href="classSBFrameClassic.html#a1ac1272ba0e249e0c74d02f7174d2220">DAleph0</a>       = 0.0;
<a name="l00850"></a>00850   <a class="code" href="classSBFrameClassic.html#a69d84b9695d1b6f8227e15d5c46097ef">DPsi0</a>         = 0.0;
<a name="l00851"></a>00851   <a class="code" href="classSBFrameClassic.html#aea80931bd2c45e72ff67fce2314dd2bc">DEpsilon0</a>     = 0.0;
<a name="l00852"></a>00852   <span class="keywordflow">switch</span> (<a class="code" href="classSBFrame.html#a4740e11cb35ec8564e0f335d647a07ac">Cfg</a>-&gt;<a class="code" href="classSBConfig.html#a7ae5d8f5f16bdbcbb699a1a976e07c91">nutModel</a>())
<a name="l00853"></a>00853     {
<a name="l00854"></a>00854     <span class="keywordflow">default</span>:
<a name="l00855"></a>00855     <span class="keywordflow">case</span> <a class="code" href="classSBConfig.html#a19389bcee1ee23aa4add3b134aecec75aacd458bf4803138de02acfaefdf6db77">SBConfig::NM_IAU1980</a>:
<a name="l00856"></a>00856       <a class="code" href="classSBFrameClassic.html#a6483ea1606123e35de6972fbb4332a78">P</a> = <span class="keyword">new</span> <a class="code" href="classSBPrec__IAU1976.html">SBPrec_IAU1976</a>;
<a name="l00857"></a>00857       <a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a> = <span class="keyword">new</span> <a class="code" href="classSBNut__IAU1980.html">SBNut_IAU1980</a>(Cfg_, <a class="code" href="classSBFrame.html#a3eeeb7bc6adc622e6beb5d671d75daa1">EOP</a>);
<a name="l00858"></a>00858       <span class="keywordflow">break</span>;
<a name="l00859"></a>00859     <span class="keywordflow">case</span> <a class="code" href="classSBConfig.html#a19389bcee1ee23aa4add3b134aecec75abb6e3c8f8ddbe8689bd07acd53e7de3d">SBConfig::NM_IAU2000</a>:
<a name="l00860"></a>00860       <a class="code" href="classSBFrameClassic.html#a1ac1272ba0e249e0c74d02f7174d2220">DAleph0</a>   = -0.01460*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l00861"></a>00861       <a class="code" href="classSBFrameClassic.html#a69d84b9695d1b6f8227e15d5c46097ef">DPsi0</a>     = -0.0417750*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l00862"></a>00862       <a class="code" href="classSBFrameClassic.html#aea80931bd2c45e72ff67fce2314dd2bc">DEpsilon0</a> = -0.0068192*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l00863"></a>00863       <a class="code" href="classSBFrameClassic.html#a85e8709045b193a42c81eb859a8cadbb">Bias</a> = <a class="code" href="classSBFrameClassic.html#a547da38d414cf32c54ebde5f6674c6cd">R1</a>(-<a class="code" href="classSBFrameClassic.html#a1ac1272ba0e249e0c74d02f7174d2220">DAleph0</a>)*<a class="code" href="classSBFrameClassic.html#a3465bf572f73c991ab4303f7840e99c0">R2</a>(-<a class="code" href="classSBFrameClassic.html#a69d84b9695d1b6f8227e15d5c46097ef">DPsi0</a>*<a class="code" href="classSBNutation.html#a764f7abde10c189385c93da2eaf6c3dd">SBNutation::ephemEps</a>())*<a class="code" href="classSBFrameClassic.html#a7ded77184a77a72e08a0fa83a0dbcdee">R3</a>(<a class="code" href="classSBFrameClassic.html#aea80931bd2c45e72ff67fce2314dd2bc">DEpsilon0</a>);
<a name="l00864"></a>00864       <a class="code" href="classSBFrameClassic.html#a6483ea1606123e35de6972fbb4332a78">P</a> = <span class="keyword">new</span> <a class="code" href="classSBPrec__IAU2000.html">SBPrec_IAU2000</a>;
<a name="l00865"></a>00865       <a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a> = <span class="keyword">new</span> <a class="code" href="classSBNut__IAU2000.html">SBNut_IAU2000</a>(Cfg_, <a class="code" href="classSBFrame.html#a3eeeb7bc6adc622e6beb5d671d75daa1">EOP</a>);
<a name="l00866"></a>00866       <span class="keywordflow">break</span>;
<a name="l00867"></a>00867     };
<a name="l00868"></a>00868 };
<a name="l00869"></a>00869 
<a name="l00870"></a><a class="code" href="classSBFrameClassic.html#ad1088a2aa20c9ef011b7391b5d308e32">00870</a> <a class="code" href="classSBFrameClassic.html#ad1088a2aa20c9ef011b7391b5d308e32">SBFrameClassic::~SBFrameClassic</a>()
<a name="l00871"></a>00871 {
<a name="l00872"></a>00872   <span class="keywordflow">if</span> (<a class="code" href="classSBFrameClassic.html#a6483ea1606123e35de6972fbb4332a78">P</a>)
<a name="l00873"></a>00873     {
<a name="l00874"></a>00874       <span class="keyword">delete</span> <a class="code" href="classSBFrameClassic.html#a6483ea1606123e35de6972fbb4332a78">P</a>;
<a name="l00875"></a>00875       <a class="code" href="classSBFrameClassic.html#a6483ea1606123e35de6972fbb4332a78">P</a> = NULL;
<a name="l00876"></a>00876     };
<a name="l00877"></a>00877   <span class="keywordflow">if</span> (<a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>)
<a name="l00878"></a>00878     {
<a name="l00879"></a>00879       <span class="keyword">delete</span> <a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>;
<a name="l00880"></a>00880       <a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a> = NULL;
<a name="l00881"></a>00881     };
<a name="l00882"></a>00882 };
<a name="l00883"></a>00883 
<a name="l00884"></a><a class="code" href="classSBFrameClassic.html#aff8197d19e6a3a0c98104578debe3931">00884</a> <span class="keywordtype">void</span> <a class="code" href="classSBFrameClassic.html#aff8197d19e6a3a0c98104578debe3931">SBFrameClassic::calc</a>(<span class="keyword">const</span> <a class="code" href="classSBMJD.html">SBMJD</a>&amp; UTC)
<a name="l00885"></a>00885 {
<a name="l00886"></a>00886   <a class="code" href="classSBFrame.html#a3eeeb7bc6adc622e6beb5d671d75daa1">EOP</a>-&gt;<a class="code" href="classSBEOP.html#aee4ca8a1d6ee622ca59a293d67754e0c">interpolateEOPs</a>(UTC);
<a name="l00887"></a>00887   <a class="code" href="classSBFrame.html#ab3368355b5f4184cb2f849cfceb73d38">Time</a>.<a class="code" href="classSBTime.html#a1f024f9bb1c2e4d91ea4f448e296020b">setUTC</a>(UTC);
<a name="l00888"></a>00888   <a class="code" href="classSBFrame.html#acf362a6317e4416c4fd9294870337599">EOPdiurnal</a>-&gt;<a class="code" href="classSBOTideEOPGeneral.html#a225ba8031e5f36f2c19eb4c99785faa4">calc</a>(<a class="code" href="classSBFrame.html#ab3368355b5f4184cb2f849cfceb73d38">Time</a>);
<a name="l00889"></a>00889 
<a name="l00890"></a>00890   <a class="code" href="classSBFrame.html#a3a3efa98793111824b5f05aa795f4271">EOPdiurnalAtm</a>-&gt;<a class="code" href="classSBOTideEOPGeneral.html#a225ba8031e5f36f2c19eb4c99785faa4">calc</a>(<a class="code" href="classSBFrame.html#ab3368355b5f4184cb2f849cfceb73d38">Time</a>);
<a name="l00891"></a>00891   <a class="code" href="classSBFrame.html#a869a43e4debedf7f36c9c512ce9c9537">EOPdiurnalNTd</a>-&gt;<a class="code" href="classSBOTideEOPGeneral.html#a225ba8031e5f36f2c19eb4c99785faa4">calc</a>(<a class="code" href="classSBFrame.html#ab3368355b5f4184cb2f849cfceb73d38">Time</a>);
<a name="l00892"></a>00892   <a class="code" href="classSBFrame.html#a4b5d368cc22c204e61e6eff99da849d2">EOPdiurnalGrv</a>-&gt;<a class="code" href="classSBOTideEOPGeneral.html#a225ba8031e5f36f2c19eb4c99785faa4">calc</a>(<a class="code" href="classSBFrame.html#ab3368355b5f4184cb2f849cfceb73d38">Time</a>);
<a name="l00893"></a>00893 
<a name="l00894"></a>00894   (*N)(<a class="code" href="classSBFrame.html#ab3368355b5f4184cb2f849cfceb73d38">Time</a>);
<a name="l00895"></a>00895 
<a name="l00896"></a>00896   <span class="keywordtype">double</span> H = -(<a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>-&gt;<a class="code" href="classSBNutation.html#a87de9bf84d6bc5de89cb1dff03079cd9">gst</a>() + <a class="code" href="classSBFrame.html#a1dd19e2691ea4029a138d99fd11a5f66">diurnalDUT1</a>()*2.0*M_PI);      <span class="comment">// rad</span>
<a name="l00897"></a>00897 
<a name="l00898"></a>00898   <a class="code" href="classSBFrame.html#ac2e2ca9bca61fe901f0ff1ded712ced4">DQ_dUT</a> = <a class="code" href="classSBFrameClassic.html#a85e8709045b193a42c81eb859a8cadbb">Bias</a>*(*P)(<a class="code" href="classSBFrame.html#ab3368355b5f4184cb2f849cfceb73d38">Time</a>)**<a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>*<a class="code" href="classSBFrameClassic.html#af22bdb4d3dc310f580a82d2dd8ecb7af">R</a>.<a class="code" href="classSBRotate.html#a1675ea53aaba003dc54c671714586154">dRdt</a>()(H)*<a class="code" href="classSBFrameClassic.html#a53817ea2e15c9049c87f2f10fff31e11">W</a>(<a class="code" href="classSBFrame.html#ab3368355b5f4184cb2f849cfceb73d38">Time</a>, <span class="keyword">this</span>)*(-2.0*M_PI*<a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>-&gt;<a class="code" href="classSBNutation.html#a78767c94b23d70123c842354c7b66f36">r</a>());
<a name="l00899"></a>00899   <a class="code" href="classSBFrame.html#af593a7e29746c04887ad8eb54a1b3971">DQ_dt</a>  = <a class="code" href="classSBFrame.html#ac2e2ca9bca61fe901f0ff1ded712ced4">DQ_dUT</a>/86400.0;
<a name="l00900"></a>00900 
<a name="l00901"></a>00901   (<a class="code" href="classMatrix3.html">Matrix3</a>&amp;)*<span class="keyword">this</span> = <a class="code" href="classSBFrameClassic.html#a85e8709045b193a42c81eb859a8cadbb">Bias</a>**<a class="code" href="classSBFrameClassic.html#a6483ea1606123e35de6972fbb4332a78">P</a>**<a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>*<a class="code" href="classSBFrameClassic.html#af22bdb4d3dc310f580a82d2dd8ecb7af">R</a>(H)*<a class="code" href="classSBFrameClassic.html#a53817ea2e15c9049c87f2f10fff31e11">W</a>;
<a name="l00902"></a>00902   <a class="code" href="classSBFrame.html#aea8ee6e0d47518917f490f2b6654ea18">CRS2TRS</a> = ~*<span class="keyword">this</span>;
<a name="l00903"></a>00903 
<a name="l00904"></a>00904 
<a name="l00905"></a>00905   <a class="code" href="classSBFrame.html#af7294590e46f015a5d02f3599686e7d0">UT1_UTC</a> = <a class="code" href="classSBFrame.html#a3eeeb7bc6adc622e6beb5d671d75daa1">EOP</a>-&gt;<a class="code" href="classSBEOP.html#ad9cca7d0b7ce837812db6e38be3f5b4c">dUT1_UTC</a>(UTC);
<a name="l00906"></a>00906 
<a name="l00907"></a>00907   <span class="comment">// make a report:</span>
<a name="l00908"></a>00908   <span class="keywordflow">if</span> (<a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#aff04f6b9f1def9cc474fb04fef43f9fc">isEligible</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a621f9586a807f9ebace4befdebc4f99d">SBLog::R3</a>))
<a name="l00909"></a>00909     {
<a name="l00910"></a>00910       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a621f9586a807f9ebace4befdebc4f99d">SBLog::R3</a>, <a class="code" href="classSBFrameClassic.html#aa36f4595d1c5073bf7006b2d9d37d6a5">ClassName</a>() + <span class="stringliteral">&quot;: Arg(UT1): &quot;</span> + <a class="code" href="classSBFrame.html#ab3368355b5f4184cb2f849cfceb73d38">Time</a>.<a class="code" href="classSBTime.html#a85fa42d1dc9fe0c7604c377de22c9c9f">UT1</a>().<a class="code" href="classSBMJD.html#a503ad8eab15136efa52e77311b93d61a">toString</a>());
<a name="l00911"></a>00911       
<a name="l00912"></a>00912       <span class="comment">//      Log-&gt;write(SBLog::DBG, SBLog::R3, ClassName() + &quot;: GMST@0h : &quot; + </span>
<a name="l00913"></a>00913       <span class="comment">//                 QString().sprintf(&quot;%.16f (days)&quot;, GMST0h));</span>
<a name="l00914"></a>00914       <span class="comment">//      Log-&gt;write(SBLog::DBG, SBLog::R3, ClassName() + &quot;: GMST@0h : &quot; + rad2hmsStr(GMST0h));</span>
<a name="l00915"></a>00915 
<a name="l00916"></a>00916       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a621f9586a807f9ebace4befdebc4f99d">SBLog::R3</a>, <a class="code" href="classSBFrameClassic.html#aa36f4595d1c5073bf7006b2d9d37d6a5">ClassName</a>() + <span class="stringliteral">&quot;: GMST    : &quot;</span> + <a class="code" href="SbGeo_8C.html#a3f7eee940ad099d0c3f3459b4210cbf9">rad2dmslStr</a>(<a class="code" href="classSBFrameClassic.html#a74eb538d85219263ebd101121cab7c2b">gmst</a>()));
<a name="l00917"></a>00917       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a621f9586a807f9ebace4befdebc4f99d">SBLog::R3</a>, <a class="code" href="classSBFrameClassic.html#aa36f4595d1c5073bf7006b2d9d37d6a5">ClassName</a>() + <span class="stringliteral">&quot;: GMST    : &quot;</span> + <a class="code" href="SbGeo_8C.html#a752d4eb6e5a547781695b9d09196aa15">rad2hmsStr</a>(<a class="code" href="classSBFrameClassic.html#a74eb538d85219263ebd101121cab7c2b">gmst</a>()));
<a name="l00918"></a>00918 
<a name="l00919"></a>00919 
<a name="l00920"></a>00920       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a621f9586a807f9ebace4befdebc4f99d">SBLog::R3</a>, <a class="code" href="classSBFrameClassic.html#aa36f4595d1c5073bf7006b2d9d37d6a5">ClassName</a>() + <span class="stringliteral">&quot;: GST     : &quot;</span> + <a class="code" href="SbGeo_8C.html#a3f7eee940ad099d0c3f3459b4210cbf9">rad2dmslStr</a>(<a class="code" href="classSBFrameClassic.html#a5febb31dee7660a6fb829c582eb8d5ba">gst</a>()));
<a name="l00921"></a>00921       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a621f9586a807f9ebace4befdebc4f99d">SBLog::R3</a>, <a class="code" href="classSBFrameClassic.html#aa36f4595d1c5073bf7006b2d9d37d6a5">ClassName</a>() + <span class="stringliteral">&quot;: GST     : &quot;</span> + <a class="code" href="SbGeo_8C.html#a752d4eb6e5a547781695b9d09196aa15">rad2hmsStr</a>(<a class="code" href="classSBFrameClassic.html#a5febb31dee7660a6fb829c582eb8d5ba">gst</a>()));
<a name="l00922"></a>00922 
<a name="l00923"></a>00923       <span class="comment">//      Log-&gt;write(SBLog::DBG, SBLog::R3, ClassName() + &quot;: GMST0h  : &quot; + </span>
<a name="l00924"></a>00924       <span class="comment">//                 QString().sprintf(&quot;%.20f (rad)&quot;, GMST0h));</span>
<a name="l00925"></a>00925       <span class="comment">//      Log-&gt;write(SBLog::DBG, SBLog::R3, ClassName() + &quot;: GMST    : &quot; + </span>
<a name="l00926"></a>00926       <span class="comment">//                 QString().sprintf(&quot;%.20f (rad)&quot;, GMST));</span>
<a name="l00927"></a>00927       <span class="comment">//      Log-&gt;write(SBLog::DBG, SBLog::R3, ClassName() + &quot;: GST     : &quot; + </span>
<a name="l00928"></a>00928       <span class="comment">//                 QString().sprintf(&quot;%.20f (rad)&quot;, GST));</span>
<a name="l00929"></a>00929 
<a name="l00930"></a>00930 
<a name="l00931"></a>00931       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a621f9586a807f9ebace4befdebc4f99d">SBLog::R3</a>, <a class="code" href="classSBFrameClassic.html#aa36f4595d1c5073bf7006b2d9d37d6a5">ClassName</a>() + <span class="stringliteral">&quot;: DeltaMu : &quot;</span> + 
<a name="l00932"></a>00932                  QString().sprintf(<span class="stringliteral">&quot;%.16f (arcsec)&quot;</span>, <a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>-&gt;<a class="code" href="classSBNutation.html#a18736088b1857a9d5a19a28f1c02095b">eqEquinox</a>()/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00933"></a>00933       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a621f9586a807f9ebace4befdebc4f99d">SBLog::R3</a>, <a class="code" href="classSBFrameClassic.html#aa36f4595d1c5073bf7006b2d9d37d6a5">ClassName</a>() + <span class="stringliteral">&quot;: DeltaMu : &quot;</span> + 
<a name="l00934"></a>00934                  QString().sprintf(<span class="stringliteral">&quot;%.20f (rad)&quot;</span>, <a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>-&gt;<a class="code" href="classSBNutation.html#a18736088b1857a9d5a19a28f1c02095b">eqEquinox</a>()));
<a name="l00935"></a>00935       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a621f9586a807f9ebace4befdebc4f99d">SBLog::R3</a>, <a class="code" href="classSBFrameClassic.html#aa36f4595d1c5073bf7006b2d9d37d6a5">ClassName</a>() + <span class="stringliteral">&quot;:-H       : &quot;</span> + 
<a name="l00936"></a>00936                  QString().sprintf(<span class="stringliteral">&quot;%22.18f (rad)&quot;</span>, H));
<a name="l00937"></a>00937       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a621f9586a807f9ebace4befdebc4f99d">SBLog::R3</a>, <a class="code" href="classSBFrameClassic.html#aa36f4595d1c5073bf7006b2d9d37d6a5">ClassName</a>() + <span class="stringliteral">&quot;: r       : &quot;</span> + 
<a name="l00938"></a>00938                  QString().sprintf(<span class="stringliteral">&quot;%.16f&quot;</span>, <a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>-&gt;<a class="code" href="classSBNutation.html#a78767c94b23d70123c842354c7b66f36">r</a>()));
<a name="l00939"></a>00939       
<a name="l00940"></a>00940 
<a name="l00941"></a>00941       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a621f9586a807f9ebace4befdebc4f99d">SBLog::R3</a>, <a class="code" href="classSBFrameClassic.html#aa36f4595d1c5073bf7006b2d9d37d6a5">ClassName</a>() + <span class="stringliteral">&quot;: R.angle : &quot;</span> + 
<a name="l00942"></a>00942                  QString().sprintf(<span class="stringliteral">&quot;%.16f (arcsec)&quot;</span>, <a class="code" href="classSBFrameClassic.html#af22bdb4d3dc310f580a82d2dd8ecb7af">R</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l00943"></a>00943       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a621f9586a807f9ebace4befdebc4f99d">SBLog::R3</a>, <a class="code" href="classSBFrameClassic.html#aa36f4595d1c5073bf7006b2d9d37d6a5">ClassName</a>() + <span class="stringliteral">&quot;: R.angle : &quot;</span> + 
<a name="l00944"></a>00944                  QString().sprintf(<span class="stringliteral">&quot;%.20f (rad)&quot;</span>, <a class="code" href="classSBFrameClassic.html#af22bdb4d3dc310f580a82d2dd8ecb7af">R</a>.<a class="code" href="classRotMatrix.html#a3a1aaebad25a45e130f1eaa29bb3be3e">angle</a>()));
<a name="l00945"></a>00945       <a class="code" href="classSBFrameClassic.html#af22bdb4d3dc310f580a82d2dd8ecb7af">R</a>.<a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a621f9586a807f9ebace4befdebc4f99d">SBLog::R3</a>, <span class="stringliteral">&quot;Rotation Matrix(-GST) : &quot;</span>);
<a name="l00946"></a>00946 
<a name="l00947"></a>00947       <a class="code" href="classMatrix3.html#a6108bb5203ffebd56e3ea7e601d8bbe0">report2Log</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4a621f9586a807f9ebace4befdebc4f99d">SBLog::R3</a>, <a class="code" href="classSBFrameClassic.html#aa36f4595d1c5073bf7006b2d9d37d6a5">ClassName</a>() + <span class="stringliteral">&quot;: matrix  : &quot;</span>);
<a name="l00948"></a>00948     };
<a name="l00949"></a>00949 
<a name="l00950"></a>00950 };
<a name="l00951"></a>00951 
<a name="l00952"></a><a class="code" href="classSBFrameClassic.html#a88fff72bdad5ff84f81e596fe4ca3faf">00952</a> <span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3</a>&amp; <a class="code" href="classSBFrameClassic.html#a88fff72bdad5ff84f81e596fe4ca3faf">SBFrameClassic::dQ_dxp</a>()
<a name="l00953"></a>00953 {
<a name="l00954"></a>00954   <a class="code" href="classSBFrame.html#a78a00d45ac146be1346513a457e611f2">DQ_dxp</a> = <a class="code" href="classSBFrameClassic.html#a85e8709045b193a42c81eb859a8cadbb">Bias</a>**<a class="code" href="classSBFrameClassic.html#a6483ea1606123e35de6972fbb4332a78">P</a>**<a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>*<a class="code" href="classSBFrameClassic.html#af22bdb4d3dc310f580a82d2dd8ecb7af">R</a>*<a class="code" href="classSBFrameClassic.html#a53817ea2e15c9049c87f2f10fff31e11">W</a>.<a class="code" href="classSBPolus.html#aff19dc295721c337b20a1bcb18dd5191">r1y</a>()*<a class="code" href="classSBFrameClassic.html#a53817ea2e15c9049c87f2f10fff31e11">W</a>.<a class="code" href="classSBPolus.html#ac18d0156085f5b9aa0b14dba6175759d">dR2dx</a>();
<a name="l00955"></a>00955   <span class="keywordflow">return</span> <a class="code" href="classSBFrame.html#a78a00d45ac146be1346513a457e611f2">DQ_dxp</a>;
<a name="l00956"></a>00956 };
<a name="l00957"></a>00957 
<a name="l00958"></a><a class="code" href="classSBFrameClassic.html#a2e7da9038b7de881c5aba4bce461c4e7">00958</a> <span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3</a>&amp; <a class="code" href="classSBFrameClassic.html#a2e7da9038b7de881c5aba4bce461c4e7">SBFrameClassic::dQ_dyp</a>()
<a name="l00959"></a>00959 {
<a name="l00960"></a>00960   <a class="code" href="classSBFrame.html#a225e4960746e0d8757162a60b0985db5">DQ_dyp</a> = <a class="code" href="classSBFrameClassic.html#a85e8709045b193a42c81eb859a8cadbb">Bias</a>**<a class="code" href="classSBFrameClassic.html#a6483ea1606123e35de6972fbb4332a78">P</a>**<a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>*<a class="code" href="classSBFrameClassic.html#af22bdb4d3dc310f580a82d2dd8ecb7af">R</a>*<a class="code" href="classSBFrameClassic.html#a53817ea2e15c9049c87f2f10fff31e11">W</a>.<a class="code" href="classSBPolus.html#ad2c48825069c352bfcf007ad70a29531">dR1dy</a>()*<a class="code" href="classSBFrameClassic.html#a53817ea2e15c9049c87f2f10fff31e11">W</a>.<a class="code" href="classSBPolus.html#abf240d561cf667ba21b95b1c1b37a295">r2x</a>();
<a name="l00961"></a>00961   <span class="keywordflow">return</span> <a class="code" href="classSBFrame.html#a225e4960746e0d8757162a60b0985db5">DQ_dyp</a>;
<a name="l00962"></a>00962 };
<a name="l00963"></a>00963 
<a name="l00964"></a><a class="code" href="classSBFrameClassic.html#a3d791b71396abb8420cc2beeccaf4c7c">00964</a> <span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3</a>&amp; <a class="code" href="classSBFrameClassic.html#a3d791b71396abb8420cc2beeccaf4c7c">SBFrameClassic::dQ_dpsi</a>()
<a name="l00965"></a>00965 {
<a name="l00966"></a>00966   <a class="code" href="classSBFrame.html#a19e6463f431ee1cadc620ce51bd3ccca">DQ_dpsi</a> = <a class="code" href="classSBFrameClassic.html#a85e8709045b193a42c81eb859a8cadbb">Bias</a>**<a class="code" href="classSBFrameClassic.html#a6483ea1606123e35de6972fbb4332a78">P</a>*(<a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>-&gt;<a class="code" href="classSBNutation.html#a914fdc5b8cda30692ba0c278472609f5">r1</a>()*<a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>-&gt;<a class="code" href="classSBNutation.html#a6ae6923f217e485aa90a1199fc75137c">dR2dpsi</a>()*<a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>-&gt;<a class="code" href="classSBNutation.html#a07fa69845c2f6d42fb084a1ea1c54d5f">r3</a>()*<a class="code" href="classSBFrameClassic.html#af22bdb4d3dc310f580a82d2dd8ecb7af">R</a> - cos(<a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>-&gt;<a class="code" href="classSBNutation.html#a27f65118501ac27a658a180675b56ee0">meanEps</a>())*(*<a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>*<a class="code" href="classSBFrameClassic.html#af22bdb4d3dc310f580a82d2dd8ecb7af">R</a>.<a class="code" href="classSBRotate.html#a1675ea53aaba003dc54c671714586154">dRdt</a>()))*<a class="code" href="classSBFrameClassic.html#a53817ea2e15c9049c87f2f10fff31e11">W</a>;
<a name="l00967"></a>00967   <span class="keywordflow">return</span> <a class="code" href="classSBFrame.html#a19e6463f431ee1cadc620ce51bd3ccca">DQ_dpsi</a>;
<a name="l00968"></a>00968 };
<a name="l00969"></a>00969 
<a name="l00970"></a><a class="code" href="classSBFrameClassic.html#a4212ac8dfb10e18a2939d5a8daa2f125">00970</a> <span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3</a>&amp; <a class="code" href="classSBFrameClassic.html#a4212ac8dfb10e18a2939d5a8daa2f125">SBFrameClassic::dQ_deps</a>()
<a name="l00971"></a>00971 {
<a name="l00972"></a>00972   <a class="code" href="classSBFrame.html#a154903a69a8d68a13498f0359135a6f7">DQ_deps</a> = <a class="code" href="classSBFrameClassic.html#a85e8709045b193a42c81eb859a8cadbb">Bias</a>**<a class="code" href="classSBFrameClassic.html#a6483ea1606123e35de6972fbb4332a78">P</a>*<a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>-&gt;<a class="code" href="classSBNutation.html#a914fdc5b8cda30692ba0c278472609f5">r1</a>()*<a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>-&gt;<a class="code" href="classSBNutation.html#aac5aefd3e009237de112b6b6f050a239">r2</a>()*<a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>-&gt;<a class="code" href="classSBNutation.html#a5dfd78f975a119060cf653bdaa2f1c62">dR3deps</a>()*<a class="code" href="classSBFrameClassic.html#af22bdb4d3dc310f580a82d2dd8ecb7af">R</a>*<a class="code" href="classSBFrameClassic.html#a53817ea2e15c9049c87f2f10fff31e11">W</a>;
<a name="l00973"></a>00973   <span class="keywordflow">return</span> <a class="code" href="classSBFrame.html#a154903a69a8d68a13498f0359135a6f7">DQ_deps</a>;
<a name="l00974"></a>00974 };
<a name="l00975"></a>00975 
<a name="l00976"></a>00976 
<a name="l00977"></a><a class="code" href="classSBFrameClassic.html#aead21bd5013cebac678a41f15f8f10a7">00977</a> <span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3</a>&amp; <a class="code" href="classSBFrameClassic.html#aead21bd5013cebac678a41f15f8f10a7">SBFrameClassic::dQ_dprec</a>()
<a name="l00978"></a>00978 {
<a name="l00979"></a>00979   <a class="code" href="classSBFrame.html#aa73efef60c665c4ff645b114afec9068">DQ_dprec</a> = <a class="code" href="classSBFrameClassic.html#a85e8709045b193a42c81eb859a8cadbb">Bias</a>*<a class="code" href="classSBFrameClassic.html#a6483ea1606123e35de6972fbb4332a78">P</a>-&gt;<a class="code" href="classSBPrecession.html#a084338e73a8f7184efb011f9d11f2c6e">dP_dpsi</a>()**<a class="code" href="classSBFrameClassic.html#a306d8b9a16170bf5c617464711abc5ab">N</a>*<a class="code" href="classSBFrameClassic.html#af22bdb4d3dc310f580a82d2dd8ecb7af">R</a>*<a class="code" href="classSBFrameClassic.html#a53817ea2e15c9049c87f2f10fff31e11">W</a>;
<a name="l00980"></a>00980   <span class="keywordflow">return</span> <a class="code" href="classSBFrame.html#aa73efef60c665c4ff645b114afec9068">DQ_dprec</a>;
<a name="l00981"></a>00981 };
<a name="l00982"></a>00982 <span class="comment">/*==============================================================================================*/</span>
<a name="l00983"></a>00983 
<a name="l00984"></a>00984 
<a name="l00985"></a>00985 
<a name="l00986"></a>00986 <span class="comment">/*==============================================================================================*/</span>
<a name="l00987"></a>00987 <span class="comment">/*                                                                                              */</span>
<a name="l00988"></a>00988 <span class="comment">/* class SBFrameNRO implementation                                                              */</span>
<a name="l00989"></a>00989 <span class="comment">/*                                                                                              */</span>
<a name="l00990"></a>00990 <span class="comment">/*==============================================================================================*/</span>
<a name="l00991"></a><a class="code" href="classSBFrameNRO.html#a57b220a484e96eb8b3a33c950247dabb">00991</a> <span class="keywordtype">void</span> <a class="code" href="classSBFrameNRO.html#a57b220a484e96eb8b3a33c950247dabb">SBFrameNRO::calc</a>(<span class="keyword">const</span> <a class="code" href="classSBMJD.html">SBMJD</a>&amp; UTC)
<a name="l00992"></a>00992 {
<a name="l00993"></a>00993   <a class="code" href="classSBFrame.html#a3eeeb7bc6adc622e6beb5d671d75daa1">EOP</a>-&gt;<a class="code" href="classSBEOP.html#aee4ca8a1d6ee622ca59a293d67754e0c">interpolateEOPs</a>(UTC);
<a name="l00994"></a>00994   <a class="code" href="classSBFrame.html#ab3368355b5f4184cb2f849cfceb73d38">Time</a>.<a class="code" href="classSBTime.html#a1f024f9bb1c2e4d91ea4f448e296020b">setUTC</a>(UTC);
<a name="l00995"></a>00995 
<a name="l00996"></a>00996   <a class="code" href="classSBFrame.html#acf362a6317e4416c4fd9294870337599">EOPdiurnal</a>-&gt;<a class="code" href="classSBOTideEOPGeneral.html#a225ba8031e5f36f2c19eb4c99785faa4">calc</a>(<a class="code" href="classSBFrame.html#ab3368355b5f4184cb2f849cfceb73d38">Time</a>);
<a name="l00997"></a>00997 
<a name="l00998"></a>00998   <a class="code" href="classSBFrame.html#a3a3efa98793111824b5f05aa795f4271">EOPdiurnalAtm</a>-&gt;<a class="code" href="classSBOTideEOPGeneral.html#a225ba8031e5f36f2c19eb4c99785faa4">calc</a>(<a class="code" href="classSBFrame.html#ab3368355b5f4184cb2f849cfceb73d38">Time</a>);
<a name="l00999"></a>00999   <a class="code" href="classSBFrame.html#a869a43e4debedf7f36c9c512ce9c9537">EOPdiurnalNTd</a>-&gt;<a class="code" href="classSBOTideEOPGeneral.html#a225ba8031e5f36f2c19eb4c99785faa4">calc</a>(<a class="code" href="classSBFrame.html#ab3368355b5f4184cb2f849cfceb73d38">Time</a>);
<a name="l01000"></a>01000   <a class="code" href="classSBFrame.html#a4b5d368cc22c204e61e6eff99da849d2">EOPdiurnalGrv</a>-&gt;<a class="code" href="classSBOTideEOPGeneral.html#a225ba8031e5f36f2c19eb4c99785faa4">calc</a>(<a class="code" href="classSBFrame.html#ab3368355b5f4184cb2f849cfceb73d38">Time</a>);
<a name="l01001"></a>01001 
<a name="l01002"></a>01002 
<a name="l01003"></a>01003   <span class="comment">//  double t = (Time.TT() - TEphem)/36525.0;</span>
<a name="l01004"></a>01004   <a class="code" href="classSBFrameNRO.html#ad5f755d7d92e097d4959840626875faf">PN</a>(<a class="code" href="classSBFrame.html#ab3368355b5f4184cb2f849cfceb73d38">Time</a>);
<a name="l01005"></a>01005   <a class="code" href="classSBFrameNRO.html#ada6e88635c84bd6339436dac6d1256ae">ERA</a> = 2.0*M_PI*(0.7790572732640 + fmod(1.00273781191135448*(<a class="code" href="classSBFrame.html#ab3368355b5f4184cb2f849cfceb73d38">Time</a>.<a class="code" href="classSBTime.html#a85fa42d1dc9fe0c7604c377de22c9c9f">UT1</a>() - <a class="code" href="SbGeoTime_8C.html#af3440a08fa10f55224b98a7c82fecddc">TEphem</a>), 1.0));
<a name="l01006"></a>01006   <a class="code" href="classSBFrameNRO.html#ada6e88635c84bd6339436dac6d1256ae">ERA</a> += <a class="code" href="classSBFrame.html#a1dd19e2691ea4029a138d99fd11a5f66">diurnalDUT1</a>()*2.0*M_PI;
<a name="l01007"></a>01007 
<a name="l01008"></a>01008   <a class="code" href="classSBFrame.html#af7294590e46f015a5d02f3599686e7d0">UT1_UTC</a> = <a class="code" href="classSBFrame.html#a3eeeb7bc6adc622e6beb5d671d75daa1">EOP</a>-&gt;<a class="code" href="classSBEOP.html#ad9cca7d0b7ce837812db6e38be3f5b4c">dUT1_UTC</a>(UTC);
<a name="l01009"></a>01009 
<a name="l01010"></a>01010   <span class="comment">//  GMST = ERA + SEC2RAD*(0.014506 + 4612.15739966*t + 1.39667721*t*t - </span>
<a name="l01011"></a>01011   <span class="comment">//                    0.00009344*t*t*t + 0.00001882*t*t*t*t) + PN.theory()-&gt;dT();</span>
<a name="l01012"></a>01012   <span class="comment">//  GST = GMST;</span>
<a name="l01013"></a>01013 
<a name="l01014"></a>01014 
<a name="l01015"></a>01015   <a class="code" href="classSBFrame.html#ac2e2ca9bca61fe901f0ff1ded712ced4">DQ_dUT</a> = <a class="code" href="classSBFrameNRO.html#ad5f755d7d92e097d4959840626875faf">PN</a>*<a class="code" href="classSBFrameNRO.html#a89f03b10260e99f33b78d7196e4631d2">R</a>.<a class="code" href="classSBRotate.html#a1675ea53aaba003dc54c671714586154">dRdt</a>()(-<a class="code" href="classSBFrameNRO.html#ada6e88635c84bd6339436dac6d1256ae">ERA</a>)*<a class="code" href="classSBFrameNRO.html#a78477e6137528bd9acd4f543fc3ada79">W</a>(<a class="code" href="classSBFrame.html#ab3368355b5f4184cb2f849cfceb73d38">Time</a>, <span class="keyword">this</span>)*(-2.0*M_PI*1.00273781191135448);
<a name="l01016"></a>01016   <a class="code" href="classSBFrame.html#af593a7e29746c04887ad8eb54a1b3971">DQ_dt</a>  = <a class="code" href="classSBFrame.html#ac2e2ca9bca61fe901f0ff1ded712ced4">DQ_dUT</a>/86400.0;
<a name="l01017"></a>01017 
<a name="l01018"></a>01018   <span class="comment">//  (Matrix3&amp;)*this = PN*R(-ERA)*W(Time, this);</span>
<a name="l01019"></a>01019   (<a class="code" href="classMatrix3.html">Matrix3</a>&amp;)*<span class="keyword">this</span> = <a class="code" href="classSBFrameNRO.html#ad5f755d7d92e097d4959840626875faf">PN</a>*<a class="code" href="classSBFrameNRO.html#a89f03b10260e99f33b78d7196e4631d2">R</a>(-ERA)*<a class="code" href="classSBFrameNRO.html#a78477e6137528bd9acd4f543fc3ada79">W</a>;
<a name="l01020"></a>01020   <a class="code" href="classSBFrame.html#aea8ee6e0d47518917f490f2b6654ea18">CRS2TRS</a> = ~*<span class="keyword">this</span>;
<a name="l01021"></a>01021 };
<a name="l01022"></a>01022 
<a name="l01023"></a><a class="code" href="classSBFrameNRO.html#a13fdd3d6f800a75de043f96535fcbb77">01023</a> <span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3</a>&amp; <a class="code" href="classSBFrameNRO.html#a13fdd3d6f800a75de043f96535fcbb77">SBFrameNRO::dQ_dxp</a>()
<a name="l01024"></a>01024 {
<a name="l01025"></a>01025   <a class="code" href="classSBFrame.html#a78a00d45ac146be1346513a457e611f2">DQ_dxp</a> = <a class="code" href="classSBFrameNRO.html#ad5f755d7d92e097d4959840626875faf">PN</a>*<a class="code" href="classSBFrameNRO.html#a89f03b10260e99f33b78d7196e4631d2">R</a>*<a class="code" href="classSBFrameNRO.html#a78477e6137528bd9acd4f543fc3ada79">W</a>.<a class="code" href="classSBPolusNRO.html#a47f4b41400c63dee1a0cbb5f7cf2b8eb">r3s</a>()*<a class="code" href="classSBFrameNRO.html#a78477e6137528bd9acd4f543fc3ada79">W</a>.<a class="code" href="classSBPolusNRO.html#ad50e78c0fa4e26ace434063f55d48f5e">r1y</a>()*<a class="code" href="classSBFrameNRO.html#a78477e6137528bd9acd4f543fc3ada79">W</a>.<a class="code" href="classSBPolusNRO.html#ad9d870af88ad129dde78a890ce12dada">dR2dx</a>();
<a name="l01026"></a>01026   <span class="keywordflow">return</span> <a class="code" href="classSBFrame.html#a78a00d45ac146be1346513a457e611f2">DQ_dxp</a>;
<a name="l01027"></a>01027 };
<a name="l01028"></a>01028 
<a name="l01029"></a><a class="code" href="classSBFrameNRO.html#ac31621da6ad3fc260f8e229456bf5715">01029</a> <span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3</a>&amp; <a class="code" href="classSBFrameNRO.html#ac31621da6ad3fc260f8e229456bf5715">SBFrameNRO::dQ_dyp</a>()
<a name="l01030"></a>01030 {
<a name="l01031"></a>01031   <a class="code" href="classSBFrame.html#a225e4960746e0d8757162a60b0985db5">DQ_dyp</a> = <a class="code" href="classSBFrameNRO.html#ad5f755d7d92e097d4959840626875faf">PN</a>*<a class="code" href="classSBFrameNRO.html#a89f03b10260e99f33b78d7196e4631d2">R</a>*<a class="code" href="classSBFrameNRO.html#a78477e6137528bd9acd4f543fc3ada79">W</a>.<a class="code" href="classSBPolusNRO.html#a47f4b41400c63dee1a0cbb5f7cf2b8eb">r3s</a>()*<a class="code" href="classSBFrameNRO.html#a78477e6137528bd9acd4f543fc3ada79">W</a>.<a class="code" href="classSBPolusNRO.html#a26b2cbbbe35c35ede44ec6f600c7d73e">dR1dy</a>()*<a class="code" href="classSBFrameNRO.html#a78477e6137528bd9acd4f543fc3ada79">W</a>.<a class="code" href="classSBPolusNRO.html#aa5b8f332358fb3a659b0f7fffa47e6a3">r2x</a>();
<a name="l01032"></a>01032   <span class="keywordflow">return</span> <a class="code" href="classSBFrame.html#a225e4960746e0d8757162a60b0985db5">DQ_dyp</a>;
<a name="l01033"></a>01033 };
<a name="l01034"></a>01034 
<a name="l01035"></a>01035 <span class="comment">// here dQ/dX:</span>
<a name="l01036"></a><a class="code" href="classSBFrameNRO.html#a223066c68fa338157087d0cb0078df6a">01036</a> <span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3</a>&amp; <a class="code" href="classSBFrameNRO.html#a223066c68fa338157087d0cb0078df6a">SBFrameNRO::dQ_dpsi</a>()
<a name="l01037"></a>01037 {
<a name="l01038"></a>01038   <span class="keywordtype">double</span> X = <a class="code" href="classSBFrameNRO.html#ad5f755d7d92e097d4959840626875faf">PN</a>.<a class="code" href="classSBPrecNutNRO.html#a04659266cb6672cdb8f653f9f9975967">x</a>();
<a name="l01039"></a>01039   <span class="keywordtype">double</span> Y = <a class="code" href="classSBFrameNRO.html#ad5f755d7d92e097d4959840626875faf">PN</a>.<a class="code" href="classSBPrecNutNRO.html#abc7960914c2157a9b85b7e789d204334">y</a>();
<a name="l01040"></a>01040   <span class="keywordtype">double</span> a = 0.5 + 0.125*(X*X + Y*Y);
<a name="l01041"></a>01041   <a class="code" href="classRotDerMatrix.html">RotDerMatrix</a>  dRSdX(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a4b8a53bafca6b43388660925049d734f">Z_AXIS</a>);
<a name="l01042"></a>01042   <a class="code" href="classMatrix3.html">Matrix3</a>       dQdX( -0.25*X*X*X -2.0*a*X,     -0.25*X*X*Y - a*Y,      1.0,
<a name="l01043"></a>01043                       -0.25*X*X*Y - a*Y,        -0.25*X*Y*Y,            0.0,
<a name="l01044"></a>01044                       -1.0,                      0.0,                   -0.25*X*(X*X + Y*Y) - 2.0*a*X);
<a name="l01045"></a>01045   <span class="comment">//  Matrix3   dQdX( -(1.0+0.25*Y*Y)*X - 0.5*X*X*X,   -0.5*Y - 3.0/8.0*X*X*Y - 0.125*Y*Y*Y,   1.0,</span>
<a name="l01046"></a>01046   <span class="comment">//                  -0.5*Y - 3.0/8.0*X*X*Y - 0.125*Y*                         -0.25*X*Y*Y,   0.0,</span>
<a name="l01047"></a>01047   <span class="comment">//                  -1.0,      0.0,                          -X - 0.5*X*X*X - 0.5*X*Y*Y);</span>
<a name="l01048"></a>01048   <a class="code" href="classSBFrame.html#a19e6463f431ee1cadc620ce51bd3ccca">DQ_dpsi</a> = (dQdX*<a class="code" href="classSBFrameNRO.html#ad5f755d7d92e097d4959840626875faf">PN</a>.<a class="code" href="classSBPrecNutNRO.html#a4a05f7522398243f850160d7d3aaeda2">rs</a>() - 0.5*Y*(<a class="code" href="classSBFrameNRO.html#ad5f755d7d92e097d4959840626875faf">PN</a>.<a class="code" href="classSBPrecNutNRO.html#a78119804814e612d1d0a6865b2c46363">q</a>()*dRSdX(<a class="code" href="classSBFrameNRO.html#ad5f755d7d92e097d4959840626875faf">PN</a>.<a class="code" href="classSBPrecNutNRO.html#a10084b76df54f97f02d95c236774f8c0">s</a>())))*<a class="code" href="classSBFrameNRO.html#a89f03b10260e99f33b78d7196e4631d2">R</a>*<a class="code" href="classSBFrameNRO.html#a78477e6137528bd9acd4f543fc3ada79">W</a>;
<a name="l01049"></a>01049   <span class="comment">//DQ_dpsi = dQdX*PN.rs()*R*W;</span>
<a name="l01050"></a>01050   <span class="keywordflow">return</span> <a class="code" href="classSBFrame.html#a19e6463f431ee1cadc620ce51bd3ccca">DQ_dpsi</a>;
<a name="l01051"></a>01051 };
<a name="l01052"></a>01052 
<a name="l01053"></a>01053 <span class="comment">// here dQ/dY:</span>
<a name="l01054"></a>01054 <span class="comment">//const Matrix3&amp; SBFrameNRO::dQ_deps()</span>
<a name="l01055"></a>01055 <span class="comment">//{</span>
<a name="l01056"></a>01056 <span class="comment">//  double X = PN.x();</span>
<a name="l01057"></a>01057 <span class="comment">//  double Y = PN.y();</span>
<a name="l01058"></a>01058 <span class="comment">//  //  double a = 0.5 + 0.125*(X*X + Y*Y);</span>
<a name="l01059"></a>01059 <span class="comment">//  //  DQ_deps = Matrix3(0.0,           -a*X,    0.0,</span>
<a name="l01060"></a>01060 <span class="comment">//  //              -a*X,      -2.0*a*Y,    1.0,</span>
<a name="l01061"></a>01061 <span class="comment">//  //              0.0,           -1.0,   -2.0*a*Y)*PN.rs()*R*W;</span>
<a name="l01062"></a>01062 <span class="comment">//  DQ_deps = Matrix3(-0.25*X*X*Y,                    -0.5*X - 0.125*X*X*X - 3.0/8.0*X*Y*Y,  0.0,</span>
<a name="l01063"></a>01063 <span class="comment">//                  -0.5*X - 0.125*X*X*X - 3.0/8.0*X*Y*Y,  -(1.0+0.25*X*X)*Y - 0.5*Y*Y*Y,  1.0,</span>
<a name="l01064"></a>01064 <span class="comment">//                  0.0,                  -1.0,        -Y - 0.5*X*X*Y - 0.5*Y*Y*Y)*PN.rs()*R*W;</span>
<a name="l01065"></a>01065 <span class="comment">//  return DQ_deps;</span>
<a name="l01066"></a>01066 <span class="comment">//};</span>
<a name="l01067"></a><a class="code" href="classSBFrameNRO.html#aa0ff9e4a4d25cff092ed41ebb6f4ac01">01067</a> <span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3</a>&amp; <a class="code" href="classSBFrameNRO.html#aa0ff9e4a4d25cff092ed41ebb6f4ac01">SBFrameNRO::dQ_deps</a>()
<a name="l01068"></a>01068 {
<a name="l01069"></a>01069   <span class="keywordtype">double</span> X = <a class="code" href="classSBFrameNRO.html#ad5f755d7d92e097d4959840626875faf">PN</a>.<a class="code" href="classSBPrecNutNRO.html#a04659266cb6672cdb8f653f9f9975967">x</a>();
<a name="l01070"></a>01070   <span class="keywordtype">double</span> Y = <a class="code" href="classSBFrameNRO.html#ad5f755d7d92e097d4959840626875faf">PN</a>.<a class="code" href="classSBPrecNutNRO.html#abc7960914c2157a9b85b7e789d204334">y</a>();
<a name="l01071"></a>01071   <span class="keywordtype">double</span> a = 0.5 + 0.125*(X*X + Y*Y);
<a name="l01072"></a>01072   <a class="code" href="classRotDerMatrix.html">RotDerMatrix</a>  dRSdY(<a class="code" href="SbVector3_8H.html#aa268a41a13430b18e933ed40207178d0a4b8a53bafca6b43388660925049d734f">Z_AXIS</a>);
<a name="l01073"></a>01073   <a class="code" href="classMatrix3.html">Matrix3</a>       dQdY( -0.25*X*X*Y,              -0.25*X*Y*Y - a*X,      0.0,
<a name="l01074"></a>01074                       -0.25*X*Y*Y - a*X,        -0.25*Y*Y*Y - 2.0*a*Y,  1.0,
<a name="l01075"></a>01075                        0.0,                     -1.0,                   -0.25*Y*(X*X + Y*Y) - 2.0*a*Y);
<a name="l01076"></a>01076   <a class="code" href="classSBFrame.html#a154903a69a8d68a13498f0359135a6f7">DQ_deps</a> = (dQdY*<a class="code" href="classSBFrameNRO.html#ad5f755d7d92e097d4959840626875faf">PN</a>.<a class="code" href="classSBPrecNutNRO.html#a4a05f7522398243f850160d7d3aaeda2">rs</a>() - 0.5*X*(<a class="code" href="classSBFrameNRO.html#ad5f755d7d92e097d4959840626875faf">PN</a>.<a class="code" href="classSBPrecNutNRO.html#a78119804814e612d1d0a6865b2c46363">q</a>()*dRSdY(<a class="code" href="classSBFrameNRO.html#ad5f755d7d92e097d4959840626875faf">PN</a>.<a class="code" href="classSBPrecNutNRO.html#a10084b76df54f97f02d95c236774f8c0">s</a>())))*<a class="code" href="classSBFrameNRO.html#a89f03b10260e99f33b78d7196e4631d2">R</a>*<a class="code" href="classSBFrameNRO.html#a78477e6137528bd9acd4f543fc3ada79">W</a>;
<a name="l01077"></a>01077   <span class="comment">//DQ_deps = dQdY*PN.rs()*R*W;</span>
<a name="l01078"></a>01078   <span class="keywordflow">return</span> <a class="code" href="classSBFrame.html#a154903a69a8d68a13498f0359135a6f7">DQ_deps</a>;
<a name="l01079"></a>01079 };
<a name="l01080"></a>01080 <span class="comment">/*==============================================================================================*/</span>
<a name="l01081"></a>01081 
<a name="l01082"></a>01082 
<a name="l01083"></a>01083 
<a name="l01084"></a>01084 
<a name="l01085"></a>01085 
<a name="l01086"></a>01086 
<a name="l01087"></a>01087 
<a name="l01088"></a>01088 <span class="comment">// real models:</span>
<a name="l01089"></a>01089 <span class="comment">/*==============================================================================================*/</span>
<a name="l01090"></a>01090 <span class="comment">/*                                                                                              */</span>
<a name="l01091"></a>01091 <span class="comment">/* class SBSTideUT1 implementation                                                              */</span>
<a name="l01092"></a>01092 <span class="comment">/*                                                                                              */</span>
<a name="l01093"></a>01093 <span class="comment">/*==============================================================================================*/</span>
<a name="l01094"></a><a class="code" href="classSBSTideUT1.html#ac2ee9a5e3766036c098828f8dcb957f9">01094</a> <span class="keywordtype">void</span> <a class="code" href="classSBSTideUT1.html#ac2ee9a5e3766036c098828f8dcb957f9">SBSTideUT1::calc</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l01095"></a>01095 {
<a name="l01096"></a>01096   <span class="keywordtype">double</span>        Xi;
<a name="l01097"></a>01097   <span class="keywordtype">double</span>        sx, cx;
<a name="l01098"></a>01098   <span class="keywordtype">int</span>           i;
<a name="l01099"></a>01099   <a class="code" href="classSBSTideUT1.html#aa7122ac9036104efad38aee953eba412" title="calculated value of (UT1S-UTC)">DUT1S</a> = 0.0;
<a name="l01100"></a>01100   <span class="keywordflow">for</span> (i=0; i&lt;62; i++)
<a name="l01101"></a>01101     {
<a name="l01102"></a>01102       Xi = fmod(<a class="code" href="classSBSTideUT1.html#ad4b79dc40d39bafe74ac8e6be3f27d5c">Tab</a>[i].N[0]*T.<a class="code" href="classSBTime.html#a2332d64fb28c9310e859d2c9b6160ae1">fArg_l</a>() + <a class="code" href="classSBSTideUT1.html#ad4b79dc40d39bafe74ac8e6be3f27d5c">Tab</a>[i].<a class="code" href="structSBSTideUT1_1_1TableEntry.html#ac9d20a5222c08b1f5316c61680c801b0">N</a>[1]*T.<a class="code" href="classSBTime.html#a51abab9b1f86e70370819b54576f8769">fArg_lPrime</a>() +
<a name="l01103"></a>01103                 <a class="code" href="classSBSTideUT1.html#ad4b79dc40d39bafe74ac8e6be3f27d5c">Tab</a>[i].<a class="code" href="structSBSTideUT1_1_1TableEntry.html#ac9d20a5222c08b1f5316c61680c801b0">N</a>[2]*T.<a class="code" href="classSBTime.html#a054bbe5e1ea61692ba83b20ba476af03">fArg_F</a>() + <a class="code" href="classSBSTideUT1.html#ad4b79dc40d39bafe74ac8e6be3f27d5c">Tab</a>[i].<a class="code" href="structSBSTideUT1_1_1TableEntry.html#ac9d20a5222c08b1f5316c61680c801b0">N</a>[3]*T.<a class="code" href="classSBTime.html#a5d54ea8c67e5d556f626889d159661bf">fArg_D</a>()      + 
<a name="l01104"></a>01104                 <a class="code" href="classSBSTideUT1.html#ad4b79dc40d39bafe74ac8e6be3f27d5c">Tab</a>[i].<a class="code" href="structSBSTideUT1_1_1TableEntry.html#ac9d20a5222c08b1f5316c61680c801b0">N</a>[4]*T.<a class="code" href="classSBTime.html#a09dfa5604304cb84bad328402bd75ff4">fArg_Omega</a>(), 2.0*M_PI);
<a name="l01105"></a>01105       <a class="code" href="SbGeneral_8H.html#a2a86fa9ee8196baf80d72b8f7ebd2db1">sincos</a>(Xi, &amp;sx, &amp;cx);
<a name="l01106"></a>01106       <a class="code" href="classSBSTideUT1.html#aa7122ac9036104efad38aee953eba412" title="calculated value of (UT1S-UTC)">DUT1S</a> += <a class="code" href="classSBSTideUT1.html#ad4b79dc40d39bafe74ac8e6be3f27d5c">Tab</a>[i].<a class="code" href="structSBSTideUT1_1_1TableEntry.html#a2e543e4348ae9fa648e483827de0b0b5">B</a>*sx + <a class="code" href="classSBSTideUT1.html#ad4b79dc40d39bafe74ac8e6be3f27d5c">Tab</a>[i].<a class="code" href="structSBSTideUT1_1_1TableEntry.html#ab8958a5fc90b0ac3b8927855ca0a4a93">C</a>*cx;
<a name="l01107"></a>01107     };
<a name="l01108"></a>01108   <a class="code" href="classSBSTideUT1.html#aa7122ac9036104efad38aee953eba412" title="calculated value of (UT1S-UTC)">DUT1S</a> *= 1.0e-4/86400.0;
<a name="l01109"></a>01109 };
<a name="l01110"></a>01110 <span class="comment">/*==============================================================================================*/</span>
<a name="l01111"></a>01111 
<a name="l01112"></a>01112 
<a name="l01113"></a>01113 
<a name="l01114"></a>01114 <span class="comment">/*==============================================================================================*/</span>
<a name="l01115"></a>01115 <span class="comment">/*                                                                                              */</span>
<a name="l01116"></a>01116 <span class="comment">/* class SBOTideEOPRay1994_1996 implementation                                                  */</span>
<a name="l01117"></a>01117 <span class="comment">/*                                                                                              */</span>
<a name="l01118"></a>01118 <span class="comment">/*==============================================================================================*/</span>
<a name="l01119"></a><a class="code" href="classSBOTideEOPRay1994__1996.html#aa683c89dbd38d9c266de0cf819d1388a">01119</a> <span class="keywordtype">void</span> <a class="code" href="classSBOTideEOPRay1994__1996.html#aa683c89dbd38d9c266de0cf819d1388a">SBOTideEOPRay1994_1996::calc</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l01120"></a>01120 {
<a name="l01121"></a>01121   <span class="keywordtype">double</span>        Xi;
<a name="l01122"></a>01122   <span class="keywordtype">double</span>        sx, cx;
<a name="l01123"></a>01123   <span class="keywordtype">int</span>           i;
<a name="l01124"></a>01124   <a class="code" href="classSBOTideEOPGeneral.html#a5565645c6388372f00b913270116c3d6" title="calculated value of UT1D">DUT1D</a> = <a class="code" href="classSBOTideEOPGeneral.html#a3a395a31f4ca722ac4b8136a7ec072a4" title="calculated value of dXD">DXD</a> = <a class="code" href="classSBOTideEOPGeneral.html#a23e446918853e4ca9095a698318fc41b" title="calculated value of dYD">DYD</a> = 0.0;
<a name="l01125"></a>01125   <span class="comment">//</span>
<a name="l01126"></a>01126   <span class="comment">// Warning:   the equation for \theta have been changed according to </span>
<a name="l01127"></a>01127   <span class="comment">//            D.D.McCarthy &quot;Errata for the IERS Conventions (1996)&quot;, item 29.</span>
<a name="l01128"></a>01128   <span class="keywordtype">double</span> Theta = <a class="code" href="SbGeo_8H.html#af7e8592d0a634bd3642e9fd508ea8022">DEG2RAD</a>*(100.4606184 + 360.98564737*(T.<a class="code" href="classSBTime.html#ad8753001fdea9be0f2bbcb1798251e16">TT</a>() - <a class="code" href="SbGeoTime_8C.html#af3440a08fa10f55224b98a7c82fecddc">TEphem</a>));
<a name="l01129"></a>01129   <span class="keywordflow">for</span> (i=0; i&lt;8; i++)
<a name="l01130"></a>01130     {
<a name="l01131"></a>01131       Xi = fmod(<a class="code" href="classSBOTideEOPRay1994__1996.html#aa6afe112c4b9c2ba9cc67a5c962a2590">Tab</a>[i].c[0]*T.<a class="code" href="classSBTime.html#a2332d64fb28c9310e859d2c9b6160ae1">fArg_l</a>() + <a class="code" href="classSBOTideEOPRay1994__1996.html#aa6afe112c4b9c2ba9cc67a5c962a2590">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__1996_1_1TableEntry.html#ae2dbfa6a2ba88737ed92e643dc916657">c</a>[1]*T.<a class="code" href="classSBTime.html#a51abab9b1f86e70370819b54576f8769">fArg_lPrime</a>() +
<a name="l01132"></a>01132                 <a class="code" href="classSBOTideEOPRay1994__1996.html#aa6afe112c4b9c2ba9cc67a5c962a2590">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__1996_1_1TableEntry.html#ae2dbfa6a2ba88737ed92e643dc916657">c</a>[2]*T.<a class="code" href="classSBTime.html#a054bbe5e1ea61692ba83b20ba476af03">fArg_F</a>() + <a class="code" href="classSBOTideEOPRay1994__1996.html#aa6afe112c4b9c2ba9cc67a5c962a2590">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__1996_1_1TableEntry.html#ae2dbfa6a2ba88737ed92e643dc916657">c</a>[3]*T.<a class="code" href="classSBTime.html#a5d54ea8c67e5d556f626889d159661bf">fArg_D</a>()      + 
<a name="l01133"></a>01133                 <a class="code" href="classSBOTideEOPRay1994__1996.html#aa6afe112c4b9c2ba9cc67a5c962a2590">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__1996_1_1TableEntry.html#ae2dbfa6a2ba88737ed92e643dc916657">c</a>[4]*T.<a class="code" href="classSBTime.html#a09dfa5604304cb84bad328402bd75ff4">fArg_Omega</a>() + <a class="code" href="classSBOTideEOPRay1994__1996.html#aa6afe112c4b9c2ba9cc67a5c962a2590">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__1996_1_1TableEntry.html#ae2dbfa6a2ba88737ed92e643dc916657">c</a>[5]*Theta + <a class="code" href="classSBOTideEOPRay1994__1996.html#aa6afe112c4b9c2ba9cc67a5c962a2590">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__1996_1_1TableEntry.html#a94e2e7977a3f308da67e69b5494bcace">Phi</a>*<a class="code" href="SbGeo_8H.html#af7e8592d0a634bd3642e9fd508ea8022">DEG2RAD</a>, 2.0*M_PI);
<a name="l01134"></a>01134       <a class="code" href="SbGeneral_8H.html#a2a86fa9ee8196baf80d72b8f7ebd2db1">sincos</a>(Xi, &amp;sx, &amp;cx);
<a name="l01135"></a>01135       <a class="code" href="classSBOTideEOPGeneral.html#a5565645c6388372f00b913270116c3d6" title="calculated value of UT1D">DUT1D</a> += <a class="code" href="classSBOTideEOPRay1994__1996.html#aa6afe112c4b9c2ba9cc67a5c962a2590">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__1996_1_1TableEntry.html#a10784b756d5a1f7282338764fecad0b5">D</a>*sx + <a class="code" href="classSBOTideEOPRay1994__1996.html#aa6afe112c4b9c2ba9cc67a5c962a2590">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__1996_1_1TableEntry.html#a7cd42b7734d2166aedaff3bc23e5d47b">E</a>*cx;
<a name="l01136"></a>01136       <a class="code" href="classSBOTideEOPGeneral.html#a3a395a31f4ca722ac4b8136a7ec072a4" title="calculated value of dXD">DXD</a>   += <a class="code" href="classSBOTideEOPRay1994__1996.html#aa6afe112c4b9c2ba9cc67a5c962a2590">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__1996_1_1TableEntry.html#ace01c7874eed0f44c7c25153aa15f787">F</a>*sx + <a class="code" href="classSBOTideEOPRay1994__1996.html#aa6afe112c4b9c2ba9cc67a5c962a2590">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__1996_1_1TableEntry.html#afbdf5f9d51eb38b9a828259fb3f4617b">G</a>*cx;
<a name="l01137"></a>01137       <a class="code" href="classSBOTideEOPGeneral.html#a23e446918853e4ca9095a698318fc41b" title="calculated value of dYD">DYD</a>   += <a class="code" href="classSBOTideEOPRay1994__1996.html#aa6afe112c4b9c2ba9cc67a5c962a2590">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__1996_1_1TableEntry.html#a04570e373f6be832cf47a0ae9742140f">H</a>*sx + <a class="code" href="classSBOTideEOPRay1994__1996.html#aa6afe112c4b9c2ba9cc67a5c962a2590">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__1996_1_1TableEntry.html#a2cd8eefc7533201caa0505790c7e6c4a">K</a>*cx;
<a name="l01138"></a>01138     };
<a name="l01139"></a>01139   <a class="code" href="classSBOTideEOPGeneral.html#a5565645c6388372f00b913270116c3d6" title="calculated value of UT1D">DUT1D</a> *= 1.0e-4/86400.0;
<a name="l01140"></a>01140   <a class="code" href="classSBOTideEOPGeneral.html#a3a395a31f4ca722ac4b8136a7ec072a4" title="calculated value of dXD">DXD</a>   *= 1.0e-3*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l01141"></a>01141   <a class="code" href="classSBOTideEOPGeneral.html#a23e446918853e4ca9095a698318fc41b" title="calculated value of dYD">DYD</a>   *= 1.0e-3*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l01142"></a>01142 };
<a name="l01143"></a>01143 <span class="comment">/*==============================================================================================*/</span>
<a name="l01144"></a>01144 
<a name="l01145"></a>01145 
<a name="l01146"></a>01146 
<a name="l01147"></a>01147 <span class="comment">/*==============================================================================================*/</span>
<a name="l01148"></a>01148 <span class="comment">/*                                                                                              */</span>
<a name="l01149"></a>01149 <span class="comment">/* class SBOTideEOPRay1994_2003 implementation                                                  */</span>
<a name="l01150"></a>01150 <span class="comment">/*                                                                                              */</span>
<a name="l01151"></a>01151 <span class="comment">/*==============================================================================================*/</span>
<a name="l01152"></a><a class="code" href="classSBOTideEOPRay1994__2003.html#ab6dee082951e9685c1fce38257ce6157">01152</a> <span class="keywordtype">void</span> <a class="code" href="classSBOTideEOPRay1994__2003.html#ab6dee082951e9685c1fce38257ce6157">SBOTideEOPRay1994_2003::calc</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l01153"></a>01153 {
<a name="l01154"></a>01154   <span class="keywordtype">double</span>        Arg;
<a name="l01155"></a>01155   <span class="keywordtype">double</span>        sa, ca;
<a name="l01156"></a>01156   <span class="keywordtype">int</span>           i;
<a name="l01157"></a>01157   <a class="code" href="classSBOTideEOPGeneral.html#a5565645c6388372f00b913270116c3d6" title="calculated value of UT1D">DUT1D</a> = <a class="code" href="classSBOTideEOPGeneral.html#a3a395a31f4ca722ac4b8136a7ec072a4" title="calculated value of dXD">DXD</a> = <a class="code" href="classSBOTideEOPGeneral.html#a23e446918853e4ca9095a698318fc41b" title="calculated value of dYD">DYD</a> = 0.0;
<a name="l01158"></a>01158 
<a name="l01159"></a>01159   <span class="keywordflow">for</span> (i=0; i&lt;71; i++)
<a name="l01160"></a>01160     {
<a name="l01161"></a>01161       Arg = fmod(<a class="code" href="classSBOTideEOPRay1994__2003.html#ac013984834c84550fd61ca8afa2ce7d7">Tab</a>[i].k[0]*T.<a class="code" href="classSBTime.html#a36ffc24993422862bc4ac6e9af555604">fArg_theta</a>() +
<a name="l01162"></a>01162                  <a class="code" href="classSBOTideEOPRay1994__2003.html#ac013984834c84550fd61ca8afa2ce7d7">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__2003_1_1TableEntry.html#aec0cab9909e3742170e3ec0984916158">k</a>[1]*T.<a class="code" href="classSBTime.html#a2332d64fb28c9310e859d2c9b6160ae1">fArg_l</a>() + <a class="code" href="classSBOTideEOPRay1994__2003.html#ac013984834c84550fd61ca8afa2ce7d7">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__2003_1_1TableEntry.html#aec0cab9909e3742170e3ec0984916158">k</a>[2]*T.<a class="code" href="classSBTime.html#a51abab9b1f86e70370819b54576f8769">fArg_lPrime</a>() +
<a name="l01163"></a>01163                  <a class="code" href="classSBOTideEOPRay1994__2003.html#ac013984834c84550fd61ca8afa2ce7d7">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__2003_1_1TableEntry.html#aec0cab9909e3742170e3ec0984916158">k</a>[3]*T.<a class="code" href="classSBTime.html#a054bbe5e1ea61692ba83b20ba476af03">fArg_F</a>() + <a class="code" href="classSBOTideEOPRay1994__2003.html#ac013984834c84550fd61ca8afa2ce7d7">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__2003_1_1TableEntry.html#aec0cab9909e3742170e3ec0984916158">k</a>[4]*T.<a class="code" href="classSBTime.html#a5d54ea8c67e5d556f626889d159661bf">fArg_D</a>() + 
<a name="l01164"></a>01164                  <a class="code" href="classSBOTideEOPRay1994__2003.html#ac013984834c84550fd61ca8afa2ce7d7">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__2003_1_1TableEntry.html#aec0cab9909e3742170e3ec0984916158">k</a>[5]*T.<a class="code" href="classSBTime.html#a09dfa5604304cb84bad328402bd75ff4">fArg_Omega</a>(), 2.0*M_PI);
<a name="l01165"></a>01165       <a class="code" href="SbGeneral_8H.html#a2a86fa9ee8196baf80d72b8f7ebd2db1">sincos</a>(Arg, &amp;sa, &amp;ca);
<a name="l01166"></a>01166       <a class="code" href="classSBOTideEOPGeneral.html#a3a395a31f4ca722ac4b8136a7ec072a4" title="calculated value of dXD">DXD</a>   += <a class="code" href="classSBOTideEOPRay1994__2003.html#ac013984834c84550fd61ca8afa2ce7d7">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__2003_1_1TableEntry.html#a93792407d089e4d5bcf7042632686f12">A</a>*sa + <a class="code" href="classSBOTideEOPRay1994__2003.html#ac013984834c84550fd61ca8afa2ce7d7">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__2003_1_1TableEntry.html#a9abd5e9c53d7ea786c1db768d98817e9">B</a>*ca;
<a name="l01167"></a>01167       <a class="code" href="classSBOTideEOPGeneral.html#a23e446918853e4ca9095a698318fc41b" title="calculated value of dYD">DYD</a>   += <a class="code" href="classSBOTideEOPRay1994__2003.html#ac013984834c84550fd61ca8afa2ce7d7">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__2003_1_1TableEntry.html#a7fb6a49c7329bf0a1db1539f1f0b1696">C</a>*sa + <a class="code" href="classSBOTideEOPRay1994__2003.html#ac013984834c84550fd61ca8afa2ce7d7">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__2003_1_1TableEntry.html#af5f3746a5f8b1c1196522d44e53d8fa0">D</a>*ca;
<a name="l01168"></a>01168       <a class="code" href="classSBOTideEOPGeneral.html#a5565645c6388372f00b913270116c3d6" title="calculated value of UT1D">DUT1D</a> += <a class="code" href="classSBOTideEOPRay1994__2003.html#ac013984834c84550fd61ca8afa2ce7d7">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__2003_1_1TableEntry.html#ad6b7b48b7dbbb8e8d693d2cd1a9a3229">E</a>*sa + <a class="code" href="classSBOTideEOPRay1994__2003.html#ac013984834c84550fd61ca8afa2ce7d7">Tab</a>[i].<a class="code" href="structSBOTideEOPRay1994__2003_1_1TableEntry.html#ad6102f00bea4b1930e1e1ed9048a35a6">F</a>*ca;
<a name="l01169"></a>01169     };
<a name="l01170"></a>01170   <a class="code" href="classSBOTideEOPGeneral.html#a5565645c6388372f00b913270116c3d6" title="calculated value of UT1D">DUT1D</a> *= 1.0e-6/86400.0;
<a name="l01171"></a>01171   <a class="code" href="classSBOTideEOPGeneral.html#a3a395a31f4ca722ac4b8136a7ec072a4" title="calculated value of dXD">DXD</a>   *= 1.0e-6*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l01172"></a>01172   <a class="code" href="classSBOTideEOPGeneral.html#a23e446918853e4ca9095a698318fc41b" title="calculated value of dYD">DYD</a>   *= 1.0e-6*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l01173"></a>01173 
<a name="l01174"></a>01174   <span class="comment">// For Test Purposes:</span>
<a name="l01175"></a>01175   <span class="comment">//  DUT1D  = 0.0;</span>
<a name="l01176"></a>01176   <span class="comment">//  DXD       = 0.0;</span>
<a name="l01177"></a>01177   <span class="comment">//  DYD       = 0.0;</span>
<a name="l01178"></a>01178 };
<a name="l01179"></a>01179 <span class="comment">/*==============================================================================================*/</span>
<a name="l01180"></a>01180 
<a name="l01181"></a>01181 
<a name="l01182"></a>01182 
<a name="l01183"></a>01183 <span class="comment">/*==============================================================================================*/</span>
<a name="l01184"></a>01184 <span class="comment">/*                                                                                              */</span>
<a name="l01185"></a>01185 <span class="comment">/* class SBOTideEOPGenS implementation                                                          */</span>
<a name="l01186"></a>01186 <span class="comment">/*                                                                                              */</span>
<a name="l01187"></a>01187 <span class="comment">/*==============================================================================================*/</span>
<a name="l01188"></a><a class="code" href="classSBOTideEOPGenS.html#a2173021800426e581082e1921b2bdc60">01188</a> <span class="keywordtype">void</span> <a class="code" href="classSBOTideEOPGenS.html#a2173021800426e581082e1921b2bdc60">SBOTideEOPGenS::calc</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l01189"></a>01189 {
<a name="l01190"></a>01190   <span class="keywordtype">double</span>        Arg;
<a name="l01191"></a>01191   <span class="keywordtype">double</span>        sa, ca;
<a name="l01192"></a>01192   <span class="keywordtype">int</span>           i;
<a name="l01193"></a>01193   <a class="code" href="classSBOTideEOPGeneral.html#a5565645c6388372f00b913270116c3d6" title="calculated value of UT1D">DUT1D</a> = <a class="code" href="classSBOTideEOPGeneral.html#a3a395a31f4ca722ac4b8136a7ec072a4" title="calculated value of dXD">DXD</a> = <a class="code" href="classSBOTideEOPGeneral.html#a23e446918853e4ca9095a698318fc41b" title="calculated value of dYD">DYD</a> = 0.0;
<a name="l01194"></a>01194 
<a name="l01195"></a>01195   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classSBOTideEOPGenS.html#a6896ecac432ef584bbcc16e01a2b1ca4">N</a>; i++)
<a name="l01196"></a>01196     {
<a name="l01197"></a>01197       Arg = fmod(<a class="code" href="classSBOTideEOPGenS.html#a1a32132d98ef3c85323ed90e94f2a876">Tab</a>[i].k[0]*T.<a class="code" href="classSBTime.html#a2332d64fb28c9310e859d2c9b6160ae1">fArg_l</a>()     + <a class="code" href="classSBOTideEOPGenS.html#a1a32132d98ef3c85323ed90e94f2a876">Tab</a>[i].<a class="code" href="structSBOTideEOPGenS_1_1TableEntry.html#a7b58733c76ee661b866bbe3a0d3436a2">k</a>[1]*T.<a class="code" href="classSBTime.html#a51abab9b1f86e70370819b54576f8769">fArg_lPrime</a>() +
<a name="l01198"></a>01198                  <a class="code" href="classSBOTideEOPGenS.html#a1a32132d98ef3c85323ed90e94f2a876">Tab</a>[i].<a class="code" href="structSBOTideEOPGenS_1_1TableEntry.html#a7b58733c76ee661b866bbe3a0d3436a2">k</a>[2]*T.<a class="code" href="classSBTime.html#a054bbe5e1ea61692ba83b20ba476af03">fArg_F</a>()     + <a class="code" href="classSBOTideEOPGenS.html#a1a32132d98ef3c85323ed90e94f2a876">Tab</a>[i].<a class="code" href="structSBOTideEOPGenS_1_1TableEntry.html#a7b58733c76ee661b866bbe3a0d3436a2">k</a>[3]*T.<a class="code" href="classSBTime.html#a5d54ea8c67e5d556f626889d159661bf">fArg_D</a>()      + 
<a name="l01199"></a>01199                  <a class="code" href="classSBOTideEOPGenS.html#a1a32132d98ef3c85323ed90e94f2a876">Tab</a>[i].<a class="code" href="structSBOTideEOPGenS_1_1TableEntry.html#a7b58733c76ee661b866bbe3a0d3436a2">k</a>[4]*T.<a class="code" href="classSBTime.html#a09dfa5604304cb84bad328402bd75ff4">fArg_Omega</a>() + <a class="code" href="classSBOTideEOPGenS.html#a1a32132d98ef3c85323ed90e94f2a876">Tab</a>[i].<a class="code" href="structSBOTideEOPGenS_1_1TableEntry.html#a7b58733c76ee661b866bbe3a0d3436a2">k</a>[5]*T.<a class="code" href="classSBTime.html#a36ffc24993422862bc4ac6e9af555604">fArg_theta</a>(), 2.0*M_PI);
<a name="l01200"></a>01200       <a class="code" href="SbGeneral_8H.html#a2a86fa9ee8196baf80d72b8f7ebd2db1">sincos</a>(Arg, &amp;sa, &amp;ca);
<a name="l01201"></a>01201       <a class="code" href="classSBOTideEOPGeneral.html#a3a395a31f4ca722ac4b8136a7ec072a4" title="calculated value of dXD">DXD</a>   += <a class="code" href="classSBOTideEOPGenS.html#a1a32132d98ef3c85323ed90e94f2a876">Tab</a>[i].<a class="code" href="structSBOTideEOPGenS_1_1TableEntry.html#af3867e963cd5a25e74a44bd74319f2f3">A</a>[0]*ca + <a class="code" href="classSBOTideEOPGenS.html#a1a32132d98ef3c85323ed90e94f2a876">Tab</a>[i].<a class="code" href="structSBOTideEOPGenS_1_1TableEntry.html#aaa2da7353feeaea9617189f81db5cf66">B</a>[0]*sa;
<a name="l01202"></a>01202       <a class="code" href="classSBOTideEOPGeneral.html#a23e446918853e4ca9095a698318fc41b" title="calculated value of dYD">DYD</a>   += <a class="code" href="classSBOTideEOPGenS.html#a1a32132d98ef3c85323ed90e94f2a876">Tab</a>[i].<a class="code" href="structSBOTideEOPGenS_1_1TableEntry.html#af3867e963cd5a25e74a44bd74319f2f3">A</a>[1]*ca + <a class="code" href="classSBOTideEOPGenS.html#a1a32132d98ef3c85323ed90e94f2a876">Tab</a>[i].<a class="code" href="structSBOTideEOPGenS_1_1TableEntry.html#aaa2da7353feeaea9617189f81db5cf66">B</a>[1]*sa;
<a name="l01203"></a>01203       <a class="code" href="classSBOTideEOPGeneral.html#a5565645c6388372f00b913270116c3d6" title="calculated value of UT1D">DUT1D</a> += <a class="code" href="classSBOTideEOPGenS.html#a1a32132d98ef3c85323ed90e94f2a876">Tab</a>[i].<a class="code" href="structSBOTideEOPGenS_1_1TableEntry.html#af3867e963cd5a25e74a44bd74319f2f3">A</a>[2]*ca + <a class="code" href="classSBOTideEOPGenS.html#a1a32132d98ef3c85323ed90e94f2a876">Tab</a>[i].<a class="code" href="structSBOTideEOPGenS_1_1TableEntry.html#aaa2da7353feeaea9617189f81db5cf66">B</a>[2]*sa;
<a name="l01204"></a>01204     };
<a name="l01205"></a>01205   <a class="code" href="classSBOTideEOPGeneral.html#a3a395a31f4ca722ac4b8136a7ec072a4" title="calculated value of dXD">DXD</a>   *= 1.0e-6*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l01206"></a>01206   <a class="code" href="classSBOTideEOPGeneral.html#a23e446918853e4ca9095a698318fc41b" title="calculated value of dYD">DYD</a>   *= 1.0e-6*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l01207"></a>01207   <a class="code" href="classSBOTideEOPGeneral.html#a5565645c6388372f00b913270116c3d6" title="calculated value of UT1D">DUT1D</a> *= 1.0e-7/86400.0;
<a name="l01208"></a>01208 };
<a name="l01209"></a>01209 <span class="comment">/*==============================================================================================*/</span>
<a name="l01210"></a>01210 
<a name="l01211"></a>01211 
<a name="l01212"></a>01212 
<a name="l01213"></a>01213 <span class="comment">/*==============================================================================================*/</span>
<a name="l01214"></a>01214 <span class="comment">/*                                                                                              */</span>
<a name="l01215"></a>01215 <span class="comment">/* class SBNutThIAU1980 implementation                                                          */</span>
<a name="l01216"></a>01216 <span class="comment">/*                                                                                              */</span>
<a name="l01217"></a>01217 <span class="comment">/*==============================================================================================*/</span>
<a name="l01218"></a><a class="code" href="classSBNutThIAU1980.html#aaba770930a5d9d3aa420e4ba58dfbd94">01218</a> <span class="keywordtype">void</span> <a class="code" href="classSBNutThIAU1980.html#aaba770930a5d9d3aa420e4ba58dfbd94">SBNutThIAU1980::calc</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l01219"></a>01219 {
<a name="l01220"></a>01220   <span class="keywordtype">double</span>        ARGUMENT, t;
<a name="l01221"></a>01221   <span class="keywordtype">double</span>        sa, ca;
<a name="l01222"></a>01222   <span class="keywordtype">int</span>           i;
<a name="l01223"></a>01223   <a class="code" href="classSBNutThGeneral.html#a0a26fb5a844b51391f12ac0ad07d4fc1" title="nutation in obliquity (from theory)">DeltaEpsT</a> = <a class="code" href="classSBNutThGeneral.html#aabeda8685f57de017545c9fadf7d41e9" title="nutation in longitude (from theory)">DeltaPsiT</a> = 0.0;
<a name="l01224"></a>01224   t = (T.<a class="code" href="classSBTime.html#ad8753001fdea9be0f2bbcb1798251e16">TT</a>() - <a class="code" href="SbGeoTime_8C.html#af3440a08fa10f55224b98a7c82fecddc">TEphem</a>)/36525.0;
<a name="l01225"></a>01225 
<a name="l01226"></a>01226   <span class="keywordflow">for</span> (i=105; -1&lt;i; i--)
<a name="l01227"></a>01227     {
<a name="l01228"></a>01228       ARGUMENT = fmod(<a class="code" href="classSBNutThIAU1980.html#a3b5acd77ce339d90af594218147645f7">Tab</a>[i].N[0]*T.<a class="code" href="classSBTime.html#a2332d64fb28c9310e859d2c9b6160ae1">fArg_l</a>() + <a class="code" href="classSBNutThIAU1980.html#a3b5acd77ce339d90af594218147645f7">Tab</a>[i].<a class="code" href="structSBNutThIAU1980_1_1TableEntry.html#ae731cb99f02b307b22ac219a228e8c35">N</a>[1]*T.<a class="code" href="classSBTime.html#a51abab9b1f86e70370819b54576f8769">fArg_lPrime</a>() +
<a name="l01229"></a>01229                       <a class="code" href="classSBNutThIAU1980.html#a3b5acd77ce339d90af594218147645f7">Tab</a>[i].<a class="code" href="structSBNutThIAU1980_1_1TableEntry.html#ae731cb99f02b307b22ac219a228e8c35">N</a>[2]*T.<a class="code" href="classSBTime.html#a054bbe5e1ea61692ba83b20ba476af03">fArg_F</a>() + <a class="code" href="classSBNutThIAU1980.html#a3b5acd77ce339d90af594218147645f7">Tab</a>[i].<a class="code" href="structSBNutThIAU1980_1_1TableEntry.html#ae731cb99f02b307b22ac219a228e8c35">N</a>[3]*T.<a class="code" href="classSBTime.html#a5d54ea8c67e5d556f626889d159661bf">fArg_D</a>()      + 
<a name="l01230"></a>01230                       <a class="code" href="classSBNutThIAU1980.html#a3b5acd77ce339d90af594218147645f7">Tab</a>[i].<a class="code" href="structSBNutThIAU1980_1_1TableEntry.html#ae731cb99f02b307b22ac219a228e8c35">N</a>[4]*T.<a class="code" href="classSBTime.html#a09dfa5604304cb84bad328402bd75ff4">fArg_Omega</a>(), 2.0*M_PI);
<a name="l01231"></a>01231       <a class="code" href="SbGeneral_8H.html#a2a86fa9ee8196baf80d72b8f7ebd2db1">sincos</a>(ARGUMENT, &amp;sa, &amp;ca);
<a name="l01232"></a>01232       <a class="code" href="classSBNutThGeneral.html#aabeda8685f57de017545c9fadf7d41e9" title="nutation in longitude (from theory)">DeltaPsiT</a> += (<a class="code" href="classSBNutThIAU1980.html#a3b5acd77ce339d90af594218147645f7">Tab</a>[i].<a class="code" href="structSBNutThIAU1980_1_1TableEntry.html#a17a197e57abf48041d2f697506a0a7a8">A</a>[0] + <a class="code" href="classSBNutThIAU1980.html#a3b5acd77ce339d90af594218147645f7">Tab</a>[i].<a class="code" href="structSBNutThIAU1980_1_1TableEntry.html#a17a197e57abf48041d2f697506a0a7a8">A</a>[1]*t)*sa;
<a name="l01233"></a>01233       <a class="code" href="classSBNutThGeneral.html#a0a26fb5a844b51391f12ac0ad07d4fc1" title="nutation in obliquity (from theory)">DeltaEpsT</a> += (<a class="code" href="classSBNutThIAU1980.html#a3b5acd77ce339d90af594218147645f7">Tab</a>[i].<a class="code" href="structSBNutThIAU1980_1_1TableEntry.html#a48d666fe8a776b8ab0f7ab2d107b3db4">B</a>[0] + <a class="code" href="classSBNutThIAU1980.html#a3b5acd77ce339d90af594218147645f7">Tab</a>[i].<a class="code" href="structSBNutThIAU1980_1_1TableEntry.html#a48d666fe8a776b8ab0f7ab2d107b3db4">B</a>[1]*t)*ca;
<a name="l01234"></a>01234     };
<a name="l01235"></a>01235   <a class="code" href="classSBNutThGeneral.html#aabeda8685f57de017545c9fadf7d41e9" title="nutation in longitude (from theory)">DeltaPsiT</a> *= <a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>*0.0001;
<a name="l01236"></a>01236   <a class="code" href="classSBNutThGeneral.html#a0a26fb5a844b51391f12ac0ad07d4fc1" title="nutation in obliquity (from theory)">DeltaEpsT</a> *= <a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>*0.0001;
<a name="l01237"></a>01237 
<a name="l01238"></a>01238   <span class="comment">// make a report:</span>
<a name="l01239"></a>01239   <span class="keywordflow">if</span> (<a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#aff04f6b9f1def9cc474fb04fef43f9fc">isEligible</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>))
<a name="l01240"></a>01240     {
<a name="l01241"></a>01241       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNutThIAU1980.html#ab88bd200dcd4e22c72be9ced648960a7">ClassName</a>() + <span class="stringliteral">&quot;: Arg(TT)           : &quot;</span> + 
<a name="l01242"></a>01242                  T.<a class="code" href="classSBTime.html#ad8753001fdea9be0f2bbcb1798251e16">TT</a>().<a class="code" href="classSBMJD.html#a503ad8eab15136efa52e77311b93d61a">toString</a>());
<a name="l01243"></a>01243       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNutThIAU1980.html#ab88bd200dcd4e22c72be9ced648960a7">ClassName</a>() + <span class="stringliteral">&quot;: Delta Psi (Theory): &quot;</span> + 
<a name="l01244"></a>01244                  QString().sprintf(<span class="stringliteral">&quot;%20.16f (arcsec)&quot;</span>, <a class="code" href="classSBNutThGeneral.html#aabeda8685f57de017545c9fadf7d41e9" title="nutation in longitude (from theory)">DeltaPsiT</a>/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l01245"></a>01245       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNutThIAU1980.html#ab88bd200dcd4e22c72be9ced648960a7">ClassName</a>() + <span class="stringliteral">&quot;: Delta Eps (Theory): &quot;</span> + 
<a name="l01246"></a>01246                  QString().sprintf(<span class="stringliteral">&quot;%20.16f (arcsec)&quot;</span>, <a class="code" href="classSBNutThGeneral.html#a0a26fb5a844b51391f12ac0ad07d4fc1" title="nutation in obliquity (from theory)">DeltaEpsT</a>/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l01247"></a>01247     };
<a name="l01248"></a>01248 };
<a name="l01249"></a>01249 <span class="comment">/*==============================================================================================*/</span>
<a name="l01250"></a>01250 
<a name="l01251"></a>01251 
<a name="l01252"></a>01252 
<a name="l01253"></a>01253 <span class="comment">/*==============================================================================================*/</span>
<a name="l01254"></a>01254 <span class="comment">/*                                                                                              */</span>
<a name="l01255"></a>01255 <span class="comment">/* class SBNutThIAU1996 implementation                                                          */</span>
<a name="l01256"></a>01256 <span class="comment">/*                                                                                              */</span>
<a name="l01257"></a>01257 <span class="comment">/*==============================================================================================*/</span>
<a name="l01258"></a><a class="code" href="classSBNutThIAU1996.html#a349be61fda8cdc8cd1878becf9d92206">01258</a> <span class="keywordtype">void</span> <a class="code" href="classSBNutThIAU1996.html#a349be61fda8cdc8cd1878becf9d92206">SBNutThIAU1996::calc</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l01259"></a>01259 {
<a name="l01260"></a>01260   <span class="keywordtype">double</span>        ARGUMENT, l_ve, l_e, l_ma, l_ju, l_sa, p_a, t=0.0;
<a name="l01261"></a>01261   <span class="keywordtype">double</span>        sa, ca;
<a name="l01262"></a>01262   <span class="keywordtype">int</span>           i;
<a name="l01263"></a>01263   t = (T.<a class="code" href="classSBTime.html#ad8753001fdea9be0f2bbcb1798251e16">TT</a>() - <a class="code" href="SbGeoTime_8C.html#af3440a08fa10f55224b98a7c82fecddc">TEphem</a>)/36525.0;
<a name="l01264"></a>01264   <a class="code" href="classSBNutThGeneral.html#a0a26fb5a844b51391f12ac0ad07d4fc1" title="nutation in obliquity (from theory)">DeltaEpsT</a> = <a class="code" href="classSBNutThGeneral.html#aabeda8685f57de017545c9fadf7d41e9" title="nutation in longitude (from theory)">DeltaPsiT</a> = 0.0;
<a name="l01265"></a>01265   <span class="keywordflow">for</span> (i=0; i&lt;263; i++)
<a name="l01266"></a>01266     {
<a name="l01267"></a>01267       ARGUMENT = fmod(<a class="code" href="classSBNutThIAU1996.html#ad67b19c6f0b20fc7192712c03191d075">Tab</a>[i].N[0]*T.<a class="code" href="classSBTime.html#a2332d64fb28c9310e859d2c9b6160ae1">fArg_l</a>() + <a class="code" href="classSBNutThIAU1996.html#ad67b19c6f0b20fc7192712c03191d075">Tab</a>[i].<a class="code" href="structSBNutThIAU1996_1_1TableEntry.html#a42b3bb5b1b46f30d0aecb865807ef08e">N</a>[1]*T.<a class="code" href="classSBTime.html#a51abab9b1f86e70370819b54576f8769">fArg_lPrime</a>() +
<a name="l01268"></a>01268                       <a class="code" href="classSBNutThIAU1996.html#ad67b19c6f0b20fc7192712c03191d075">Tab</a>[i].<a class="code" href="structSBNutThIAU1996_1_1TableEntry.html#a42b3bb5b1b46f30d0aecb865807ef08e">N</a>[2]*T.<a class="code" href="classSBTime.html#a054bbe5e1ea61692ba83b20ba476af03">fArg_F</a>() + <a class="code" href="classSBNutThIAU1996.html#ad67b19c6f0b20fc7192712c03191d075">Tab</a>[i].<a class="code" href="structSBNutThIAU1996_1_1TableEntry.html#a42b3bb5b1b46f30d0aecb865807ef08e">N</a>[3]*T.<a class="code" href="classSBTime.html#a5d54ea8c67e5d556f626889d159661bf">fArg_D</a>() + 
<a name="l01269"></a>01269                       <a class="code" href="classSBNutThIAU1996.html#ad67b19c6f0b20fc7192712c03191d075">Tab</a>[i].<a class="code" href="structSBNutThIAU1996_1_1TableEntry.html#a42b3bb5b1b46f30d0aecb865807ef08e">N</a>[4]*T.<a class="code" href="classSBTime.html#a09dfa5604304cb84bad328402bd75ff4">fArg_Omega</a>(), 2.0*M_PI);
<a name="l01270"></a>01270       <a class="code" href="SbGeneral_8H.html#a2a86fa9ee8196baf80d72b8f7ebd2db1">sincos</a>(ARGUMENT, &amp;sa, &amp;ca);
<a name="l01271"></a>01271       <a class="code" href="classSBNutThGeneral.html#aabeda8685f57de017545c9fadf7d41e9" title="nutation in longitude (from theory)">DeltaPsiT</a> += (<a class="code" href="classSBNutThIAU1996.html#ad67b19c6f0b20fc7192712c03191d075">Tab</a>[i].<a class="code" href="structSBNutThIAU1996_1_1TableEntry.html#a934af77ba578477c1c2ae2463a5673b7">A</a>[0] + <a class="code" href="classSBNutThIAU1996.html#ad67b19c6f0b20fc7192712c03191d075">Tab</a>[i].<a class="code" href="structSBNutThIAU1996_1_1TableEntry.html#a934af77ba578477c1c2ae2463a5673b7">A</a>[1]*t)*sa + <a class="code" href="classSBNutThIAU1996.html#ad67b19c6f0b20fc7192712c03191d075">Tab</a>[i].C[0]*ca;
<a name="l01272"></a>01272       <a class="code" href="classSBNutThGeneral.html#a0a26fb5a844b51391f12ac0ad07d4fc1" title="nutation in obliquity (from theory)">DeltaEpsT</a> += (<a class="code" href="classSBNutThIAU1996.html#ad67b19c6f0b20fc7192712c03191d075">Tab</a>[i].<a class="code" href="structSBNutThIAU1996_1_1TableEntry.html#aade242a9fc9f9d1e9ec49e6375a3b449">B</a>[0] + <a class="code" href="classSBNutThIAU1996.html#ad67b19c6f0b20fc7192712c03191d075">Tab</a>[i].<a class="code" href="structSBNutThIAU1996_1_1TableEntry.html#aade242a9fc9f9d1e9ec49e6375a3b449">B</a>[1]*t)*ca + <a class="code" href="classSBNutThIAU1996.html#ad67b19c6f0b20fc7192712c03191d075">Tab</a>[i].C[1]*sa;
<a name="l01273"></a>01273     };
<a name="l01274"></a>01274 
<a name="l01275"></a>01275   l_ve  = fmod(181.979800853 + 58517.8156748    *t,                 360.0)*<a class="code" href="SbGeo_8H.html#af7e8592d0a634bd3642e9fd508ea8022">DEG2RAD</a>;
<a name="l01276"></a>01276   l_e   = fmod(100.466448494 + 35999.3728521    *t,                 360.0)*<a class="code" href="SbGeo_8H.html#af7e8592d0a634bd3642e9fd508ea8022">DEG2RAD</a>;
<a name="l01277"></a>01277   l_ma  = fmod(355.433274605 + 19140.299314     *t,                 360.0)*<a class="code" href="SbGeo_8H.html#af7e8592d0a634bd3642e9fd508ea8022">DEG2RAD</a>;
<a name="l01278"></a>01278   l_ju  = fmod( 34.351483900 +  3034.90567464   *t,                 360.0)*<a class="code" href="SbGeo_8H.html#af7e8592d0a634bd3642e9fd508ea8022">DEG2RAD</a>;
<a name="l01279"></a>01279   l_sa  = fmod( 50.0774713998+  1222.11379404   *t,                 360.0)*<a class="code" href="SbGeo_8H.html#af7e8592d0a634bd3642e9fd508ea8022">DEG2RAD</a>;
<a name="l01280"></a>01280   p_a   = fmod(                    1.39697137214*t + 0.0003086*t*t, 360.0)*<a class="code" href="SbGeo_8H.html#af7e8592d0a634bd3642e9fd508ea8022">DEG2RAD</a>;
<a name="l01281"></a>01281 
<a name="l01282"></a>01282   <span class="keywordflow">for</span> (i=0; i&lt;112; i++)
<a name="l01283"></a>01283     {
<a name="l01284"></a>01284       ARGUMENT = fmod(<a class="code" href="classSBNutThIAU1996.html#a267d65ddcc4852059c918299a3526b31">PlTab</a>[i].N[0]*l_ve + <a class="code" href="classSBNutThIAU1996.html#a267d65ddcc4852059c918299a3526b31">PlTab</a>[i].N[1]*l_e + <a class="code" href="classSBNutThIAU1996.html#a267d65ddcc4852059c918299a3526b31">PlTab</a>[i].N[2]*l_ma + 
<a name="l01285"></a>01285                       <a class="code" href="classSBNutThIAU1996.html#a267d65ddcc4852059c918299a3526b31">PlTab</a>[i].N[3]*l_ju + <a class="code" href="classSBNutThIAU1996.html#a267d65ddcc4852059c918299a3526b31">PlTab</a>[i].N[4]*l_sa + <a class="code" href="classSBNutThIAU1996.html#a267d65ddcc4852059c918299a3526b31">PlTab</a>[i].N[5]*p_a + 
<a name="l01286"></a>01286                       <a class="code" href="classSBNutThIAU1996.html#a267d65ddcc4852059c918299a3526b31">PlTab</a>[i].N[6]*T.<a class="code" href="classSBTime.html#a5d54ea8c67e5d556f626889d159661bf">fArg_D</a>() + <a class="code" href="classSBNutThIAU1996.html#a267d65ddcc4852059c918299a3526b31">PlTab</a>[i].<a class="code" href="structSBNutThIAU1996_1_1PlanetTableEntry.html#a5e96bd0b6fc94256dc61f305f705fb0d">N</a>[7]*T.<a class="code" href="classSBTime.html#a054bbe5e1ea61692ba83b20ba476af03">fArg_F</a>() + 
<a name="l01287"></a>01287                       <a class="code" href="classSBNutThIAU1996.html#a267d65ddcc4852059c918299a3526b31">PlTab</a>[i].<a class="code" href="structSBNutThIAU1996_1_1PlanetTableEntry.html#a5e96bd0b6fc94256dc61f305f705fb0d">N</a>[8]*T.<a class="code" href="classSBTime.html#a2332d64fb28c9310e859d2c9b6160ae1">fArg_l</a>() + <a class="code" href="classSBNutThIAU1996.html#a267d65ddcc4852059c918299a3526b31">PlTab</a>[i].<a class="code" href="structSBNutThIAU1996_1_1PlanetTableEntry.html#a5e96bd0b6fc94256dc61f305f705fb0d">N</a>[9]*T.<a class="code" href="classSBTime.html#a09dfa5604304cb84bad328402bd75ff4">fArg_Omega</a>(), 2.0*M_PI);
<a name="l01288"></a>01288       
<a name="l01289"></a>01289       <span class="comment">// Warning:       the formulae for \Delta\psi and \Delta\epsilon have been changed</span>
<a name="l01290"></a>01290       <span class="comment">//                according to D.D.McCarthy &quot;Errata for the IERS Conventions (1996)&quot;, </span>
<a name="l01291"></a>01291       <span class="comment">//                item 32.</span>
<a name="l01292"></a>01292       <a class="code" href="SbGeneral_8H.html#a2a86fa9ee8196baf80d72b8f7ebd2db1">sincos</a>(ARGUMENT, &amp;sa, &amp;ca);
<a name="l01293"></a>01293       <a class="code" href="classSBNutThGeneral.html#aabeda8685f57de017545c9fadf7d41e9" title="nutation in longitude (from theory)">DeltaPsiT</a> += <a class="code" href="classSBNutThIAU1996.html#a267d65ddcc4852059c918299a3526b31">PlTab</a>[i].<a class="code" href="structSBNutThIAU1996_1_1PlanetTableEntry.html#ab902e733bf3ca634f5ad7639bb3bc8ff">A</a>[0]*sa + <a class="code" href="classSBNutThIAU1996.html#a267d65ddcc4852059c918299a3526b31">PlTab</a>[i].<a class="code" href="structSBNutThIAU1996_1_1PlanetTableEntry.html#ab902e733bf3ca634f5ad7639bb3bc8ff">A</a>[1]*ca;
<a name="l01294"></a>01294       <a class="code" href="classSBNutThGeneral.html#a0a26fb5a844b51391f12ac0ad07d4fc1" title="nutation in obliquity (from theory)">DeltaEpsT</a> += <a class="code" href="classSBNutThIAU1996.html#a267d65ddcc4852059c918299a3526b31">PlTab</a>[i].<a class="code" href="structSBNutThIAU1996_1_1PlanetTableEntry.html#a5f62271084b7ab1c6af96804e43411f3">B</a>[0]*ca + <a class="code" href="classSBNutThIAU1996.html#a267d65ddcc4852059c918299a3526b31">PlTab</a>[i].<a class="code" href="structSBNutThIAU1996_1_1PlanetTableEntry.html#a5f62271084b7ab1c6af96804e43411f3">B</a>[1]*sa;
<a name="l01295"></a>01295     };
<a name="l01296"></a>01296 
<a name="l01297"></a>01297   <a class="code" href="classSBNutThGeneral.html#aabeda8685f57de017545c9fadf7d41e9" title="nutation in longitude (from theory)">DeltaPsiT</a> *= <a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>*0.000001;
<a name="l01298"></a>01298   <a class="code" href="classSBNutThGeneral.html#a0a26fb5a844b51391f12ac0ad07d4fc1" title="nutation in obliquity (from theory)">DeltaEpsT</a> *= <a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>*0.000001;
<a name="l01299"></a>01299 
<a name="l01300"></a>01300   <span class="comment">// make a report:</span>
<a name="l01301"></a>01301   <span class="keywordflow">if</span> (<a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#aff04f6b9f1def9cc474fb04fef43f9fc">isEligible</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>))
<a name="l01302"></a>01302     {
<a name="l01303"></a>01303       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNutThIAU1996.html#af79b6cfb211ed313e3ec02620d754e05">ClassName</a>() + <span class="stringliteral">&quot;: Arg(TT): &quot;</span> + T.<a class="code" href="classSBTime.html#ad8753001fdea9be0f2bbcb1798251e16">TT</a>().<a class="code" href="classSBMJD.html#a503ad8eab15136efa52e77311b93d61a">toString</a>());
<a name="l01304"></a>01304       
<a name="l01305"></a>01305       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNutThIAU1996.html#af79b6cfb211ed313e3ec02620d754e05">ClassName</a>() + <span class="stringliteral">&quot;: Delta Psi (Theory): &quot;</span> + 
<a name="l01306"></a>01306                  QString().sprintf(<span class="stringliteral">&quot;%20.16f (arcsec)&quot;</span>, <a class="code" href="classSBNutThGeneral.html#aabeda8685f57de017545c9fadf7d41e9" title="nutation in longitude (from theory)">DeltaPsiT</a>/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l01307"></a>01307       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNutThIAU1996.html#af79b6cfb211ed313e3ec02620d754e05">ClassName</a>() + <span class="stringliteral">&quot;: Delta Eps (Theory): &quot;</span> + 
<a name="l01308"></a>01308                  QString().sprintf(<span class="stringliteral">&quot;%20.16f (arcsec)&quot;</span>, <a class="code" href="classSBNutThGeneral.html#a0a26fb5a844b51391f12ac0ad07d4fc1" title="nutation in obliquity (from theory)">DeltaEpsT</a>/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l01309"></a>01309     };
<a name="l01310"></a>01310 };
<a name="l01311"></a>01311 <span class="comment">/*==============================================================================================*/</span>
<a name="l01312"></a>01312 
<a name="l01313"></a>01313 
<a name="l01314"></a>01314 
<a name="l01315"></a>01315 <span class="comment">/*==============================================================================================*/</span>
<a name="l01316"></a>01316 <span class="comment">/*                                                                                              */</span>
<a name="l01317"></a>01317 <span class="comment">/* class SBNutThIAU2000A implementation                                                         */</span>
<a name="l01318"></a>01318 <span class="comment">/*                                                                                              */</span>
<a name="l01319"></a>01319 <span class="comment">/*==============================================================================================*/</span>
<a name="l01320"></a><a class="code" href="classSBNutThIAU2000A.html#a836f0f5ebad31d64edd43554b90b4238">01320</a> <span class="keywordtype">void</span> <a class="code" href="classSBNutThIAU2000A.html#a836f0f5ebad31d64edd43554b90b4238">SBNutThIAU2000A::calc</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l01321"></a>01321 {
<a name="l01322"></a>01322   <span class="keywordtype">double</span>        ARGUMENT, l_me, l_ve, l_e, l_ma, l_ju, l_sa, l_ur, l_ne, p_a, t=0.0;
<a name="l01323"></a>01323   <span class="keywordtype">double</span>        sa, ca;
<a name="l01324"></a>01324   <span class="keywordtype">int</span>           i;
<a name="l01325"></a>01325   t = (T.<a class="code" href="classSBTime.html#ad8753001fdea9be0f2bbcb1798251e16">TT</a>() - <a class="code" href="SbGeoTime_8C.html#af3440a08fa10f55224b98a7c82fecddc">TEphem</a>)/36525.0;
<a name="l01326"></a>01326   <a class="code" href="classSBNutThGeneral.html#a0a26fb5a844b51391f12ac0ad07d4fc1" title="nutation in obliquity (from theory)">DeltaEpsT</a> = <a class="code" href="classSBNutThGeneral.html#aabeda8685f57de017545c9fadf7d41e9" title="nutation in longitude (from theory)">DeltaPsiT</a> = 0.0;
<a name="l01327"></a>01327   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classSBNutThIAU2000A.html#ad9518ceaf3048d8b8fe335d4e16d772f">NSolLun</a>; i++)
<a name="l01328"></a>01328     {
<a name="l01329"></a>01329       ARGUMENT = fmod(<a class="code" href="classSBNutThIAU2000A.html#a14307474992a1706b239a0980255cef8">SLTab</a>[i].N[0]*T.<a class="code" href="classSBTime.html#a2332d64fb28c9310e859d2c9b6160ae1">fArg_l</a>() + <a class="code" href="classSBNutThIAU2000A.html#a14307474992a1706b239a0980255cef8">SLTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1SolLunTableEntry.html#ada0627143f36cb74d9287821491e29e2">N</a>[1]*T.<a class="code" href="classSBTime.html#a51abab9b1f86e70370819b54576f8769">fArg_lPrime</a>() +
<a name="l01330"></a>01330                       <a class="code" href="classSBNutThIAU2000A.html#a14307474992a1706b239a0980255cef8">SLTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1SolLunTableEntry.html#ada0627143f36cb74d9287821491e29e2">N</a>[2]*T.<a class="code" href="classSBTime.html#a054bbe5e1ea61692ba83b20ba476af03">fArg_F</a>() + <a class="code" href="classSBNutThIAU2000A.html#a14307474992a1706b239a0980255cef8">SLTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1SolLunTableEntry.html#ada0627143f36cb74d9287821491e29e2">N</a>[3]*T.<a class="code" href="classSBTime.html#a5d54ea8c67e5d556f626889d159661bf">fArg_D</a>() + 
<a name="l01331"></a>01331                       <a class="code" href="classSBNutThIAU2000A.html#a14307474992a1706b239a0980255cef8">SLTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1SolLunTableEntry.html#ada0627143f36cb74d9287821491e29e2">N</a>[4]*T.<a class="code" href="classSBTime.html#a09dfa5604304cb84bad328402bd75ff4">fArg_Omega</a>(), 2.0*M_PI);
<a name="l01332"></a>01332       <a class="code" href="SbGeneral_8H.html#a2a86fa9ee8196baf80d72b8f7ebd2db1">sincos</a>(ARGUMENT, &amp;sa, &amp;ca);
<a name="l01333"></a>01333       <a class="code" href="classSBNutThGeneral.html#aabeda8685f57de017545c9fadf7d41e9" title="nutation in longitude (from theory)">DeltaPsiT</a> += (<a class="code" href="classSBNutThIAU2000A.html#a14307474992a1706b239a0980255cef8">SLTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1SolLunTableEntry.html#a5b4f75dca6c17ae3986affa4d3dcf0ab">Psi_in</a>[0] + <a class="code" href="classSBNutThIAU2000A.html#a14307474992a1706b239a0980255cef8">SLTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1SolLunTableEntry.html#a5b4f75dca6c17ae3986affa4d3dcf0ab">Psi_in</a>[1]*t)*sa + 
<a name="l01334"></a>01334         (<a class="code" href="classSBNutThIAU2000A.html#a14307474992a1706b239a0980255cef8">SLTab</a>[i].Psi_out[0] + <a class="code" href="classSBNutThIAU2000A.html#a14307474992a1706b239a0980255cef8">SLTab</a>[i].Psi_out[1]*t)*ca;
<a name="l01335"></a>01335       <a class="code" href="classSBNutThGeneral.html#a0a26fb5a844b51391f12ac0ad07d4fc1" title="nutation in obliquity (from theory)">DeltaEpsT</a> += (<a class="code" href="classSBNutThIAU2000A.html#a14307474992a1706b239a0980255cef8">SLTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1SolLunTableEntry.html#a449d72b432bc23a243f9808d00c1892f">Eps_in</a>[0] + <a class="code" href="classSBNutThIAU2000A.html#a14307474992a1706b239a0980255cef8">SLTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1SolLunTableEntry.html#a449d72b432bc23a243f9808d00c1892f">Eps_in</a>[1]*t)*ca + 
<a name="l01336"></a>01336         (<a class="code" href="classSBNutThIAU2000A.html#a14307474992a1706b239a0980255cef8">SLTab</a>[i].Eps_out[0] + <a class="code" href="classSBNutThIAU2000A.html#a14307474992a1706b239a0980255cef8">SLTab</a>[i].Eps_out[1]*t)*sa;
<a name="l01337"></a>01337     };
<a name="l01338"></a>01338 
<a name="l01339"></a>01339   l_me  = fmod(4.402608842 + 2608.7903141574 *t,                    2.0*M_PI);
<a name="l01340"></a>01340   l_ve  = fmod(3.176146697 + 1021.3285546211 *t,                    2.0*M_PI);
<a name="l01341"></a>01341   l_e   = fmod(1.753470314 +  628.3075849991 *t,                    2.0*M_PI);
<a name="l01342"></a>01342   l_ma  = fmod(6.203480913 +  334.0612426700 *t,                    2.0*M_PI);
<a name="l01343"></a>01343   l_ju  = fmod(0.599546497 +   52.9690962641 *t,                    2.0*M_PI);
<a name="l01344"></a>01344   l_sa  = fmod(0.874016757 +   21.3299104960 *t,                    2.0*M_PI);
<a name="l01345"></a>01345   l_ur  = fmod(5.481293871 +    7.4781598567 *t,                    2.0*M_PI);
<a name="l01346"></a>01346   l_ne  = fmod(5.321159000 +    3.8127774000 *t,                    2.0*M_PI);
<a name="l01347"></a>01347   p_a   = fmod(                 0.02438175   *t + 0.00000538691*t*t,2.0*M_PI);
<a name="l01348"></a>01348 
<a name="l01349"></a>01349   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classSBNutThIAU2000A.html#a706b45aaf8a665751d0966f828f98ee4">NPlanet</a>; i++)
<a name="l01350"></a>01350     {
<a name="l01351"></a>01351       ARGUMENT = fmod(<a class="code" href="classSBNutThIAU2000A.html#a11fdd68472934546b5dd6285e4b78613">PlTab</a>[i].N[ 0]*T.<a class="code" href="classSBTime.html#a2332d64fb28c9310e859d2c9b6160ae1">fArg_l</a>() + <a class="code" href="classSBNutThIAU2000A.html#a11fdd68472934546b5dd6285e4b78613">PlTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1PlanetTableEntry.html#adf1c77b5e3fdb43fce39643b35c6da82">N</a>[1]*T.<a class="code" href="classSBTime.html#a51abab9b1f86e70370819b54576f8769">fArg_lPrime</a>() + 
<a name="l01352"></a>01352                       <a class="code" href="classSBNutThIAU2000A.html#a11fdd68472934546b5dd6285e4b78613">PlTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1PlanetTableEntry.html#adf1c77b5e3fdb43fce39643b35c6da82">N</a>[ 2]*T.<a class="code" href="classSBTime.html#a054bbe5e1ea61692ba83b20ba476af03">fArg_F</a>() + <a class="code" href="classSBNutThIAU2000A.html#a11fdd68472934546b5dd6285e4b78613">PlTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1PlanetTableEntry.html#adf1c77b5e3fdb43fce39643b35c6da82">N</a>[3]*T.<a class="code" href="classSBTime.html#a5d54ea8c67e5d556f626889d159661bf">fArg_D</a>() + 
<a name="l01353"></a>01353                       <a class="code" href="classSBNutThIAU2000A.html#a11fdd68472934546b5dd6285e4b78613">PlTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1PlanetTableEntry.html#adf1c77b5e3fdb43fce39643b35c6da82">N</a>[ 4]*T.<a class="code" href="classSBTime.html#a09dfa5604304cb84bad328402bd75ff4">fArg_Omega</a>() +
<a name="l01354"></a>01354                       <a class="code" href="classSBNutThIAU2000A.html#a11fdd68472934546b5dd6285e4b78613">PlTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1PlanetTableEntry.html#adf1c77b5e3fdb43fce39643b35c6da82">N</a>[ 5]*l_me + <a class="code" href="classSBNutThIAU2000A.html#a11fdd68472934546b5dd6285e4b78613">PlTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1PlanetTableEntry.html#adf1c77b5e3fdb43fce39643b35c6da82">N</a>[ 6]*l_ve + <a class="code" href="classSBNutThIAU2000A.html#a11fdd68472934546b5dd6285e4b78613">PlTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1PlanetTableEntry.html#adf1c77b5e3fdb43fce39643b35c6da82">N</a>[ 7]*l_e + 
<a name="l01355"></a>01355                       <a class="code" href="classSBNutThIAU2000A.html#a11fdd68472934546b5dd6285e4b78613">PlTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1PlanetTableEntry.html#adf1c77b5e3fdb43fce39643b35c6da82">N</a>[ 8]*l_ma + <a class="code" href="classSBNutThIAU2000A.html#a11fdd68472934546b5dd6285e4b78613">PlTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1PlanetTableEntry.html#adf1c77b5e3fdb43fce39643b35c6da82">N</a>[ 9]*l_ju + <a class="code" href="classSBNutThIAU2000A.html#a11fdd68472934546b5dd6285e4b78613">PlTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1PlanetTableEntry.html#adf1c77b5e3fdb43fce39643b35c6da82">N</a>[10]*sa + 
<a name="l01356"></a>01356                       <a class="code" href="classSBNutThIAU2000A.html#a11fdd68472934546b5dd6285e4b78613">PlTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1PlanetTableEntry.html#adf1c77b5e3fdb43fce39643b35c6da82">N</a>[11]*l_ur + <a class="code" href="classSBNutThIAU2000A.html#a11fdd68472934546b5dd6285e4b78613">PlTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1PlanetTableEntry.html#adf1c77b5e3fdb43fce39643b35c6da82">N</a>[12]*l_ne + <a class="code" href="classSBNutThIAU2000A.html#a11fdd68472934546b5dd6285e4b78613">PlTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1PlanetTableEntry.html#adf1c77b5e3fdb43fce39643b35c6da82">N</a>[13]*p_a, 2.0*M_PI);
<a name="l01357"></a>01357       
<a name="l01358"></a>01358       <span class="comment">// Warning:       the formulae for \Delta\psi and \Delta\epsilon have been changed</span>
<a name="l01359"></a>01359       <span class="comment">//                according to D.D.McCarthy &quot;Errata for the IERS Conventions (1996)&quot;, </span>
<a name="l01360"></a>01360       <span class="comment">//                item 32.</span>
<a name="l01361"></a>01361       <a class="code" href="SbGeneral_8H.html#a2a86fa9ee8196baf80d72b8f7ebd2db1">sincos</a>(ARGUMENT, &amp;sa, &amp;ca);
<a name="l01362"></a>01362       <a class="code" href="classSBNutThGeneral.html#aabeda8685f57de017545c9fadf7d41e9" title="nutation in longitude (from theory)">DeltaPsiT</a> += <a class="code" href="classSBNutThIAU2000A.html#a11fdd68472934546b5dd6285e4b78613">PlTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1PlanetTableEntry.html#a22f2f6932a184a96d1bf22bfd99ae7e0">A</a>[0]*sa + <a class="code" href="classSBNutThIAU2000A.html#a11fdd68472934546b5dd6285e4b78613">PlTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1PlanetTableEntry.html#a22f2f6932a184a96d1bf22bfd99ae7e0">A</a>[1]*ca;
<a name="l01363"></a>01363       <a class="code" href="classSBNutThGeneral.html#a0a26fb5a844b51391f12ac0ad07d4fc1" title="nutation in obliquity (from theory)">DeltaEpsT</a> += <a class="code" href="classSBNutThIAU2000A.html#a11fdd68472934546b5dd6285e4b78613">PlTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1PlanetTableEntry.html#aa03576663983d4479aeb5d6cae387ac0">B</a>[0]*ca + <a class="code" href="classSBNutThIAU2000A.html#a11fdd68472934546b5dd6285e4b78613">PlTab</a>[i].<a class="code" href="structSBNutThIAU2000A_1_1PlanetTableEntry.html#aa03576663983d4479aeb5d6cae387ac0">B</a>[1]*sa;
<a name="l01364"></a>01364     };
<a name="l01365"></a>01365 
<a name="l01366"></a>01366   <a class="code" href="classSBNutThGeneral.html#aabeda8685f57de017545c9fadf7d41e9" title="nutation in longitude (from theory)">DeltaPsiT</a> *= <a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>*0.001;
<a name="l01367"></a>01367   <a class="code" href="classSBNutThGeneral.html#a0a26fb5a844b51391f12ac0ad07d4fc1" title="nutation in obliquity (from theory)">DeltaEpsT</a> *= <a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>*0.001;
<a name="l01368"></a>01368 
<a name="l01369"></a>01369   <span class="comment">// make a report:</span>
<a name="l01370"></a>01370   <span class="keywordflow">if</span> (<a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#aff04f6b9f1def9cc474fb04fef43f9fc">isEligible</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>))
<a name="l01371"></a>01371     {
<a name="l01372"></a>01372       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNutThIAU2000A.html#a3df42689db5e02df60c5997badf4b491">ClassName</a>() + <span class="stringliteral">&quot;: Arg(TT):            &quot;</span> + T.<a class="code" href="classSBTime.html#ad8753001fdea9be0f2bbcb1798251e16">TT</a>().<a class="code" href="classSBMJD.html#a503ad8eab15136efa52e77311b93d61a">toString</a>());
<a name="l01373"></a>01373       
<a name="l01374"></a>01374       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNutThIAU2000A.html#a3df42689db5e02df60c5997badf4b491">ClassName</a>() + <span class="stringliteral">&quot;: Delta Psi (Theory): &quot;</span> + 
<a name="l01375"></a>01375                  QString().sprintf(<span class="stringliteral">&quot;%20.16f (arcsec)&quot;</span>, <a class="code" href="classSBNutThGeneral.html#aabeda8685f57de017545c9fadf7d41e9" title="nutation in longitude (from theory)">DeltaPsiT</a>/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l01376"></a>01376       <a class="code" href="SbGeneral_8C.html#aef5cc75506f512b864a727ed8436ba80">Log</a>-&gt;<a class="code" href="classSBLog.html#a8c4ad11637bc0405bf28f0f29aa8a86a">write</a>(<a class="code" href="classSBLog.html#af729ae12fb4954f95e238b70db910f08a4d88517f1b07942f0b7f18c61e3585be">SBLog::DBG</a>, <a class="code" href="classSBLog.html#a1c3e29d096b460c80466ccde9380edf4ad7b01d4811860f4ddf62fc907ec30e4a">SBLog::NUTATION</a>, <a class="code" href="classSBNutThIAU2000A.html#a3df42689db5e02df60c5997badf4b491">ClassName</a>() + <span class="stringliteral">&quot;: Delta Eps (Theory): &quot;</span> + 
<a name="l01377"></a>01377                  QString().sprintf(<span class="stringliteral">&quot;%20.16f (arcsec)&quot;</span>, <a class="code" href="classSBNutThGeneral.html#a0a26fb5a844b51391f12ac0ad07d4fc1" title="nutation in obliquity (from theory)">DeltaEpsT</a>/<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>));
<a name="l01378"></a>01378     };
<a name="l01379"></a>01379 };
<a name="l01380"></a>01380 <span class="comment">/*==============================================================================================*/</span>
<a name="l01381"></a>01381 
<a name="l01382"></a>01382 
<a name="l01383"></a>01383 
<a name="l01384"></a>01384 <span class="comment">/*==============================================================================================*/</span>
<a name="l01385"></a>01385 <span class="comment">/*                                                                                              */</span>
<a name="l01386"></a>01386 <span class="comment">/* class SBNROThIAU2000A implementation                                                         */</span>
<a name="l01387"></a>01387 <span class="comment">/*                                                                                              */</span>
<a name="l01388"></a>01388 <span class="comment">/*==============================================================================================*/</span>
<a name="l01389"></a><a class="code" href="classSBNROThIAU2000A.html#a11744e712dac7955237bcf4e1c76d199">01389</a> <span class="keywordtype">double</span> <a class="code" href="classSBNROThIAU2000A.html#a11744e712dac7955237bcf4e1c76d199">SBNROThIAU2000A::sum</a>(<span class="keywordtype">int</span> N, <span class="keyword">const</span> <a class="code" href="structSBNROThIAU2000A_1_1GeneralTableEntry.html">GeneralTableEntry</a>* Table, <span class="keywordtype">double</span>* Arg)
<a name="l01390"></a>01390 {
<a name="l01391"></a>01391   <span class="keywordtype">int</span>           i,j;
<a name="l01392"></a>01392   <span class="keywordtype">double</span>        sa, ca, ret;
<a name="l01393"></a>01393   <span class="keywordtype">double</span>        ARGUMENT;
<a name="l01394"></a>01394   <span class="keyword">const</span> <a class="code" href="structSBNROThIAU2000A_1_1GeneralTableEntry.html">GeneralTableEntry</a>       *tab = Table;
<a name="l01395"></a>01395   ret = 0.0;
<a name="l01396"></a>01396   <span class="keywordflow">for</span> (i=0; i&lt;N; i++, tab++)
<a name="l01397"></a>01397     {
<a name="l01398"></a>01398       ARGUMENT = 0.0;
<a name="l01399"></a>01399       <span class="keywordflow">for</span> (j=0; j&lt;14; j++) 
<a name="l01400"></a>01400         <span class="keywordflow">if</span> (tab-&gt;<a class="code" href="structSBNROThIAU2000A_1_1GeneralTableEntry.html#a426365dce8900b264d997d29ef668471" title="multipliers">N</a>[j]!=0)
<a name="l01401"></a>01401           ARGUMENT += tab-&gt;<a class="code" href="structSBNROThIAU2000A_1_1GeneralTableEntry.html#a426365dce8900b264d997d29ef668471" title="multipliers">N</a>[j]**(Arg+j);
<a name="l01402"></a>01402       ARGUMENT = fmod(ARGUMENT, 2.0*M_PI);
<a name="l01403"></a>01403       <a class="code" href="SbGeneral_8H.html#a2a86fa9ee8196baf80d72b8f7ebd2db1">sincos</a>(ARGUMENT, &amp;sa, &amp;ca);
<a name="l01404"></a>01404       ret += tab-&gt;<a class="code" href="structSBNROThIAU2000A_1_1GeneralTableEntry.html#aaa595129b7a38f2b88b6fc647e7f6734">S</a>*sa + tab-&gt;<a class="code" href="structSBNROThIAU2000A_1_1GeneralTableEntry.html#a88a436b86a6236670c3b2aa09815c26f" title="sin &amp; cos coefficients">C</a>*ca;
<a name="l01405"></a>01405     };
<a name="l01406"></a>01406   <span class="keywordflow">return</span> ret;
<a name="l01407"></a>01407 };
<a name="l01408"></a>01408 
<a name="l01409"></a><a class="code" href="classSBNROThIAU2000A.html#a63b299cb375b197aab1cd885e599df5c">01409</a> <span class="keywordtype">void</span> <a class="code" href="classSBNROThIAU2000A.html#a63b299cb375b197aab1cd885e599df5c">SBNROThIAU2000A::calc</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l01410"></a>01410 {
<a name="l01411"></a>01411   <span class="keywordtype">double</span>        t = (T.<a class="code" href="classSBTime.html#ad8753001fdea9be0f2bbcb1798251e16">TT</a>() - <a class="code" href="SbGeoTime_8C.html#af3440a08fa10f55224b98a7c82fecddc">TEphem</a>)/36525.0;
<a name="l01412"></a>01412   <span class="keywordtype">double</span>        arg[14];
<a name="l01413"></a>01413 
<a name="l01414"></a>01414   <a class="code" href="classSBNROThGeneral.html#a4c423ea8d7ba534ac5df6d76331a61af" title="X.">X</a> = <a class="code" href="classSBNROThGeneral.html#ab64e0be06dd2e954aba88dac09e18913" title="Y.">Y</a> = <a class="code" href="classSBNROThGeneral.html#abbcfcabd8830386cd8260d562fd9bd39" title="s">S</a> = <a class="code" href="classSBNROThGeneral.html#a0a4ea500a4f194d3ccf19d1a36d14367" title="dT">DT</a> = 0.0;
<a name="l01415"></a>01415   
<a name="l01416"></a>01416   arg[ 0] = T.<a class="code" href="classSBTime.html#a2332d64fb28c9310e859d2c9b6160ae1">fArg_l</a>();
<a name="l01417"></a>01417   arg[ 1] = T.<a class="code" href="classSBTime.html#a51abab9b1f86e70370819b54576f8769">fArg_lPrime</a>();
<a name="l01418"></a>01418   arg[ 2] = T.<a class="code" href="classSBTime.html#a054bbe5e1ea61692ba83b20ba476af03">fArg_F</a>();
<a name="l01419"></a>01419   arg[ 3] = T.<a class="code" href="classSBTime.html#a5d54ea8c67e5d556f626889d159661bf">fArg_D</a>();
<a name="l01420"></a>01420   arg[ 4] = T.<a class="code" href="classSBTime.html#a09dfa5604304cb84bad328402bd75ff4">fArg_Omega</a>();
<a name="l01421"></a>01421   arg[ 5] = fmod(4.402608842 + 2608.7903141574 *t,                  2.0*M_PI);
<a name="l01422"></a>01422   arg[ 6] = fmod(3.176146697 + 1021.3285546211 *t,                  2.0*M_PI);
<a name="l01423"></a>01423   arg[ 7] = fmod(1.753470314 +  628.3075849991 *t,                  2.0*M_PI);
<a name="l01424"></a>01424   arg[ 8] = fmod(6.203480913 +  334.0612426700 *t,                  2.0*M_PI);
<a name="l01425"></a>01425   arg[ 9] = fmod(0.599546497 +   52.9690962641 *t,                  2.0*M_PI);
<a name="l01426"></a>01426   arg[10] = fmod(0.874016757 +   21.3299104960 *t,                  2.0*M_PI);
<a name="l01427"></a>01427   arg[11] = fmod(5.481293872 +    7.4781598567 *t,                  2.0*M_PI);
<a name="l01428"></a>01428   arg[12] = fmod(5.311886287 +    3.8133035638 *t,                  2.0*M_PI);
<a name="l01429"></a>01429   arg[13] = fmod(                 0.024381750  *t + 0.00000538691*t*t,2.0*M_PI);
<a name="l01430"></a>01430   
<a name="l01431"></a>01431   <a class="code" href="classSBNROThGeneral.html#a4c423ea8d7ba534ac5df6d76331a61af" title="X.">X</a> = -16616.99 + <a class="code" href="classSBNROThIAU2000A.html#a11744e712dac7955237bcf4e1c76d199">sum</a>(<a class="code" href="classSBNROThIAU2000A.html#aff0457bec37670a9a0187c8c9b87a02a">NXT0</a>, <a class="code" href="classSBNROThIAU2000A.html#a0d865209894bcfd0b17c158b1424c383">XTabT0</a>, arg) + 
<a name="l01432"></a>01432     t*(2004191742.88 + <a class="code" href="classSBNROThIAU2000A.html#a11744e712dac7955237bcf4e1c76d199">sum</a>(<a class="code" href="classSBNROThIAU2000A.html#a7a5482e266bdb349c514fb8c9e450df8">NXT1</a>, <a class="code" href="classSBNROThIAU2000A.html#a9273014bc7b9afd0f785bb3f213a9316">XTabT1</a>, arg) +
<a name="l01433"></a>01433        t*(-427219.05 + <a class="code" href="classSBNROThIAU2000A.html#a11744e712dac7955237bcf4e1c76d199">sum</a>(<a class="code" href="classSBNROThIAU2000A.html#a27df9ab4894c879511cdade5b0a5c629">NXT2</a>, <a class="code" href="classSBNROThIAU2000A.html#a77226b49c10284731c09fc029d9097c7">XTabT2</a>, arg) +
<a name="l01434"></a>01434           t*(-198620.54 + <a class="code" href="classSBNROThIAU2000A.html#a11744e712dac7955237bcf4e1c76d199">sum</a>(<a class="code" href="classSBNROThIAU2000A.html#a58864753d6af6891733f2f5695ab55b3">NXT3</a>, <a class="code" href="classSBNROThIAU2000A.html#a97f7907aa932f6a18560b818b784b5b5">XTabT3</a>, arg) +
<a name="l01435"></a>01435              t*(-46.05 + <a class="code" href="classSBNROThIAU2000A.html#a11744e712dac7955237bcf4e1c76d199">sum</a>(<a class="code" href="classSBNROThIAU2000A.html#a33df9bb8581e7fab1afefc09b12ce65b">NXT4</a>, <a class="code" href="classSBNROThIAU2000A.html#a271229c9535bca88bf7b26166407d22a">XTabT4</a>, arg) + t*5.98))));
<a name="l01436"></a>01436 
<a name="l01437"></a>01437   <a class="code" href="classSBNROThGeneral.html#ab64e0be06dd2e954aba88dac09e18913" title="Y.">Y</a> = -6950.78 + <a class="code" href="classSBNROThIAU2000A.html#a11744e712dac7955237bcf4e1c76d199">sum</a>(<a class="code" href="classSBNROThIAU2000A.html#a8da2ae588e2f5c91f29ab68f84f5a561">NYT0</a>, <a class="code" href="classSBNROThIAU2000A.html#a070a76655980916de87d462bbe76fd8a">YTabT0</a>, arg) + 
<a name="l01438"></a>01438     t*(-25381.99 + <a class="code" href="classSBNROThIAU2000A.html#a11744e712dac7955237bcf4e1c76d199">sum</a>(<a class="code" href="classSBNROThIAU2000A.html#a1ba17d180003b886d900de51a5227e5b">NYT1</a>, <a class="code" href="classSBNROThIAU2000A.html#a53336cffb7aa99352ad8b1e6ae38cc5e">YTabT1</a>, arg) +
<a name="l01439"></a>01439        t*(-22407250.99 + <a class="code" href="classSBNROThIAU2000A.html#a11744e712dac7955237bcf4e1c76d199">sum</a>(<a class="code" href="classSBNROThIAU2000A.html#ad52e78cfee133b0f7fa0927e3735eafe">NYT2</a>, <a class="code" href="classSBNROThIAU2000A.html#ac325238f9af3bd9a3cefc6c4c75b16d3">YTabT2</a>, arg) +
<a name="l01440"></a>01440           t*(1842.28 + <a class="code" href="classSBNROThIAU2000A.html#a11744e712dac7955237bcf4e1c76d199">sum</a>(<a class="code" href="classSBNROThIAU2000A.html#a6bd6b4c13c35639f388e0995a635b8e4">NYT3</a>, <a class="code" href="classSBNROThIAU2000A.html#acf4e2b05c41a29a14878d5e704b4119f">YTabT3</a>, arg) +
<a name="l01441"></a>01441              t*(1113.06 + <a class="code" href="classSBNROThIAU2000A.html#a11744e712dac7955237bcf4e1c76d199">sum</a>(<a class="code" href="classSBNROThIAU2000A.html#aa462ce0644a80f1eb6f325f68b23d5e4">NYT4</a>, <a class="code" href="classSBNROThIAU2000A.html#aa51a58daa242e8c71818076e4b8535be">YTabT4</a>, arg) + t*0.99))));
<a name="l01442"></a>01442 
<a name="l01443"></a>01443   <a class="code" href="classSBNROThGeneral.html#abbcfcabd8830386cd8260d562fd9bd39" title="s">S</a> = 94.0 + <a class="code" href="classSBNROThIAU2000A.html#a11744e712dac7955237bcf4e1c76d199">sum</a>(<a class="code" href="classSBNROThIAU2000A.html#afd47e51778c420ee0a942d1a8ead7ce1">NDThetaT0</a>, <a class="code" href="classSBNROThIAU2000A.html#a7bf9040bfa35012cb9ed84b1f21e0cbb">DThetaTabT0</a>, arg) + 
<a name="l01444"></a>01444     t*(3808.35 + <a class="code" href="classSBNROThIAU2000A.html#a11744e712dac7955237bcf4e1c76d199">sum</a>(<a class="code" href="classSBNROThIAU2000A.html#aaacdb054448f9f7f85af7403ff79ce05">NDThetaT1</a>, <a class="code" href="classSBNROThIAU2000A.html#aa904f156a1f57baa136789a970197520">DThetaTabT1</a>, arg) +
<a name="l01445"></a>01445        t*(-119.94 + <a class="code" href="classSBNROThIAU2000A.html#a11744e712dac7955237bcf4e1c76d199">sum</a>(<a class="code" href="classSBNROThIAU2000A.html#ab3b53ecc419cd299d99258445dda10d5">NDThetaT2</a>, <a class="code" href="classSBNROThIAU2000A.html#adb324414a66f485d39b41a7b1175e017">DThetaTabT2</a>, arg) +
<a name="l01446"></a>01446           t*(-72574.09 + <a class="code" href="classSBNROThIAU2000A.html#a11744e712dac7955237bcf4e1c76d199">sum</a>(<a class="code" href="classSBNROThIAU2000A.html#aa89bfc8d179e38c53c220c790b6cb82a">NDThetaT3</a>, <a class="code" href="classSBNROThIAU2000A.html#a45636af6fd657bb9509cd8ab7340ca20">DThetaTabT3</a>, arg) +
<a name="l01447"></a>01447              t*(27.70 + <a class="code" href="classSBNROThIAU2000A.html#a11744e712dac7955237bcf4e1c76d199">sum</a>(<a class="code" href="classSBNROThIAU2000A.html#a2f35b69f98ebf15d808a3d42176ca40c">NDThetaT4</a>, <a class="code" href="classSBNROThIAU2000A.html#aed137186f4f24a16e54d6c9345ac24a7">DThetaTabT4</a>, arg) + t*15.61))));
<a name="l01448"></a>01448   
<a name="l01449"></a>01449   <a class="code" href="classSBNROThGeneral.html#a0a4ea500a4f194d3ccf19d1a36d14367" title="dT">DT</a> = <a class="code" href="classSBNROThIAU2000A.html#a11744e712dac7955237bcf4e1c76d199">sum</a>(<a class="code" href="classSBNROThIAU2000A.html#abcc189fc7c8ff3efffd5fca68f4f876f">NDtT0</a>, <a class="code" href="classSBNROThIAU2000A.html#a5a138f4e91df38024e64e21ab8c1dc86">DtTabT0</a>, arg) + t*<a class="code" href="classSBNROThIAU2000A.html#a11744e712dac7955237bcf4e1c76d199">sum</a>(<a class="code" href="classSBNROThIAU2000A.html#a74744111be7079f88712c662827f0eaa">NDtT1</a>, <a class="code" href="classSBNROThIAU2000A.html#a372627f0d81fc7b1819061e3f04fd773">DtTabT1</a>, arg);
<a name="l01450"></a>01450 
<a name="l01451"></a>01451   <a class="code" href="classSBNROThGeneral.html#a4c423ea8d7ba534ac5df6d76331a61af" title="X.">X</a>  *= <a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>*1.0e-6;
<a name="l01452"></a>01452   Y  *= <a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>*1.0e-6;
<a name="l01453"></a>01453   S  *= <a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>*1.0e-6;
<a name="l01454"></a>01454   S  -= <a class="code" href="classSBNROThGeneral.html#a4c423ea8d7ba534ac5df6d76331a61af" title="X.">X</a>*Y/2.0;
<a name="l01455"></a>01455   DT *= <a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>*1.0e-6;
<a name="l01456"></a>01456 };
<a name="l01457"></a>01457 
<a name="l01458"></a>01458 <span class="comment">/*==============================================================================================*/</span>
<a name="l01459"></a>01459 
<a name="l01460"></a>01460 
<a name="l01461"></a>01461 
<a name="l01462"></a>01462 
<a name="l01463"></a>01463 
<a name="l01464"></a>01464 
<a name="l01465"></a>01465 <span class="comment">/*==============================================================================================*/</span>
<a name="l01466"></a>01466 <span class="comment">/*                                                                                              */</span>
<a name="l01467"></a>01467 <span class="comment">/* class SBATideEOP_BBP_02 implementation                                                       */</span>
<a name="l01468"></a>01468 <span class="comment">/*</span>
<a name="l01469"></a>01469 <span class="comment"> *  DIURNAL AND SEMIDIURNAL VARIATIONS</span>
<a name="l01470"></a>01470 <span class="comment"> *  OF POLAR MOTION DUE TO ATMOSPHERIC TIDES</span>
<a name="l01471"></a>01471 <span class="comment"> *  </span>
<a name="l01472"></a>01472 <span class="comment"> *  Atmospheric tides (both thermal and tidal) cause diurnal and semidiurnal components in the </span>
<a name="l01473"></a>01473 <span class="comment"> *  polar motion. Most important contributions have been computed by Brzezinski, Bizouard and </span>
<a name="l01474"></a>01474 <span class="comment"> *  Petrov (2002) [&quot;Influence of the atmosphere on Earth Rotation : what new can be learned from </span>
<a name="l01475"></a>01475 <span class="comment"> *  the recent atmospheric angular momentum estimates?&quot;, Surveys in Geophysics, 23, 33-69, 2002] </span>
<a name="l01476"></a>01476 <span class="comment"> *  from NCEP/NCAR Angular Atmospheric Momentum data. Corresponding model includes 6 periodic </span>
<a name="l01477"></a>01477 <span class="comment"> *  circular components (4 prograde diurnal terms, 2 semidiurnal terms) under the form :</span>
<a name="l01478"></a>01478 <span class="comment"> *  </span>
<a name="l01479"></a>01479 <span class="comment"> *  Dx - i*Dy = S_j i*(a^{in}_j + i*a^{op}_j)*e^{i*x_j}</span>
<a name="l01480"></a>01480 <span class="comment"> *  </span>
<a name="l01481"></a>01481 <span class="comment"> *  or :</span>
<a name="l01482"></a>01482 <span class="comment"> *  </span>
<a name="l01483"></a>01483 <span class="comment"> *  Dx =  S_j (-a^{op}_j *cos(x_j) - a^{in}_j *sin(x_j))</span>
<a name="l01484"></a>01484 <span class="comment"> *  Dy = -S_j ( a^{in}_j *cos(x_j) - a^{op}_j *sin(x_j))</span>
<a name="l01485"></a>01485 <span class="comment"> *  </span>
<a name="l01486"></a>01486 <span class="comment"> *  </span>
<a name="l01487"></a>01487 <span class="comment"> *  where xi is integer linear combination of Delaunay arguments, GMST + p :</span>
<a name="l01488"></a>01488 <span class="comment"> *  xi = a1 l + a2 l&#39; + a3 D + a4 F + a5 W + a6 (GMST +p)</span>
<a name="l01489"></a>01489 <span class="comment"> */</span>
<a name="l01490"></a>01490 <span class="comment">/*                                                                                              */</span>
<a name="l01491"></a>01491 <span class="comment">/*==============================================================================================*/</span>
<a name="l01492"></a><a class="code" href="classSBATideEOP__BBP__02.html#a56dc93d7fbd1e81d463fe8569d606002">01492</a> <span class="keywordtype">void</span> <a class="code" href="classSBATideEOP__BBP__02.html#a56dc93d7fbd1e81d463fe8569d606002">SBATideEOP_BBP_02::calc</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l01493"></a>01493 {
<a name="l01494"></a>01494   <span class="keywordtype">double</span>        x_j;
<a name="l01495"></a>01495   <span class="keywordtype">double</span>        s_xj, c_xj;
<a name="l01496"></a>01496   <span class="keywordtype">int</span>           i;
<a name="l01497"></a>01497   <a class="code" href="classSBOTideEOPGeneral.html#a5565645c6388372f00b913270116c3d6" title="calculated value of UT1D">DUT1D</a> = <a class="code" href="classSBOTideEOPGeneral.html#a3a395a31f4ca722ac4b8136a7ec072a4" title="calculated value of dXD">DXD</a> = <a class="code" href="classSBOTideEOPGeneral.html#a23e446918853e4ca9095a698318fc41b" title="calculated value of dYD">DYD</a> = 0.0;
<a name="l01498"></a>01498 
<a name="l01499"></a>01499   <span class="keywordflow">for</span> (i=0; i&lt;6; i++)
<a name="l01500"></a>01500     {
<a name="l01501"></a>01501       x_j = fmod(<a class="code" href="classSBATideEOP__BBP__02.html#adafeba03b5ef01ff2c3839eeead026b0">Tab</a>[i].k[0]*T.<a class="code" href="classSBTime.html#a2332d64fb28c9310e859d2c9b6160ae1">fArg_l</a>()         +
<a name="l01502"></a>01502                  <a class="code" href="classSBATideEOP__BBP__02.html#adafeba03b5ef01ff2c3839eeead026b0">Tab</a>[i].<a class="code" href="structSBATideEOP__BBP__02_1_1TableEntry.html#a386f961777919cfcc1826d3b5d51a151">k</a>[1]*T.<a class="code" href="classSBTime.html#a51abab9b1f86e70370819b54576f8769">fArg_lPrime</a>()    +
<a name="l01503"></a>01503                  <a class="code" href="classSBATideEOP__BBP__02.html#adafeba03b5ef01ff2c3839eeead026b0">Tab</a>[i].<a class="code" href="structSBATideEOP__BBP__02_1_1TableEntry.html#a386f961777919cfcc1826d3b5d51a151">k</a>[2]*T.<a class="code" href="classSBTime.html#a054bbe5e1ea61692ba83b20ba476af03">fArg_F</a>()         +
<a name="l01504"></a>01504                  <a class="code" href="classSBATideEOP__BBP__02.html#adafeba03b5ef01ff2c3839eeead026b0">Tab</a>[i].<a class="code" href="structSBATideEOP__BBP__02_1_1TableEntry.html#a386f961777919cfcc1826d3b5d51a151">k</a>[3]*T.<a class="code" href="classSBTime.html#a5d54ea8c67e5d556f626889d159661bf">fArg_D</a>()         +
<a name="l01505"></a>01505                  <a class="code" href="classSBATideEOP__BBP__02.html#adafeba03b5ef01ff2c3839eeead026b0">Tab</a>[i].<a class="code" href="structSBATideEOP__BBP__02_1_1TableEntry.html#a386f961777919cfcc1826d3b5d51a151">k</a>[4]*T.<a class="code" href="classSBTime.html#a09dfa5604304cb84bad328402bd75ff4">fArg_Omega</a>()     +
<a name="l01506"></a>01506                  <a class="code" href="classSBATideEOP__BBP__02.html#adafeba03b5ef01ff2c3839eeead026b0">Tab</a>[i].<a class="code" href="structSBATideEOP__BBP__02_1_1TableEntry.html#a386f961777919cfcc1826d3b5d51a151">k</a>[5]*T.<a class="code" href="classSBTime.html#a36ffc24993422862bc4ac6e9af555604">fArg_theta</a>(),    2.0*M_PI);
<a name="l01507"></a>01507       <a class="code" href="SbGeneral_8H.html#a2a86fa9ee8196baf80d72b8f7ebd2db1">sincos</a>(x_j, &amp;s_xj, &amp;c_xj);
<a name="l01508"></a>01508       <a class="code" href="classSBOTideEOPGeneral.html#a3a395a31f4ca722ac4b8136a7ec072a4" title="calculated value of dXD">DXD</a>   +=  -<a class="code" href="classSBATideEOP__BBP__02.html#adafeba03b5ef01ff2c3839eeead026b0">Tab</a>[i].<a class="code" href="structSBATideEOP__BBP__02_1_1TableEntry.html#a37ac6910fb16612e9fe737b98e6218b3">A_op</a>*c_xj - <a class="code" href="classSBATideEOP__BBP__02.html#adafeba03b5ef01ff2c3839eeead026b0">Tab</a>[i].<a class="code" href="structSBATideEOP__BBP__02_1_1TableEntry.html#a8629dd0742b67ec76a42bdf18334e835">A_in</a>*s_xj;
<a name="l01509"></a>01509       <a class="code" href="classSBOTideEOPGeneral.html#a23e446918853e4ca9095a698318fc41b" title="calculated value of dYD">DYD</a>   += -(<a class="code" href="classSBATideEOP__BBP__02.html#adafeba03b5ef01ff2c3839eeead026b0">Tab</a>[i].<a class="code" href="structSBATideEOP__BBP__02_1_1TableEntry.html#a8629dd0742b67ec76a42bdf18334e835">A_in</a>*c_xj - <a class="code" href="classSBATideEOP__BBP__02.html#adafeba03b5ef01ff2c3839eeead026b0">Tab</a>[i].<a class="code" href="structSBATideEOP__BBP__02_1_1TableEntry.html#a37ac6910fb16612e9fe737b98e6218b3">A_op</a>*s_xj);
<a name="l01510"></a>01510       <a class="code" href="classSBOTideEOPGeneral.html#a5565645c6388372f00b913270116c3d6" title="calculated value of UT1D">DUT1D</a> +=   <a class="code" href="classSBATideEOP__BBP__02.html#adafeba03b5ef01ff2c3839eeead026b0">Tab</a>[i].<a class="code" href="structSBATideEOP__BBP__02_1_1TableEntry.html#af4797643dd7553a3e31f9c7fbb73c3c1">a</a>   *c_xj + <a class="code" href="classSBATideEOP__BBP__02.html#adafeba03b5ef01ff2c3839eeead026b0">Tab</a>[i].<a class="code" href="structSBATideEOP__BBP__02_1_1TableEntry.html#af974da0d0ca38c0a766f6931bde01a01">b</a>   *s_xj;
<a name="l01511"></a>01511     };
<a name="l01512"></a>01512   <a class="code" href="classSBOTideEOPGeneral.html#a5565645c6388372f00b913270116c3d6" title="calculated value of UT1D">DUT1D</a> *= 1.0e-6/86400.0;
<a name="l01513"></a>01513   <a class="code" href="classSBOTideEOPGeneral.html#a3a395a31f4ca722ac4b8136a7ec072a4" title="calculated value of dXD">DXD</a>   *= 1.0e-6*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l01514"></a>01514   <a class="code" href="classSBOTideEOPGeneral.html#a23e446918853e4ca9095a698318fc41b" title="calculated value of dYD">DYD</a>   *= 1.0e-6*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l01515"></a>01515 };
<a name="l01516"></a>01516 <span class="comment">/*==============================================================================================*/</span>
<a name="l01517"></a>01517 
<a name="l01518"></a>01518 
<a name="l01519"></a>01519 
<a name="l01520"></a>01520 <span class="comment">/*==============================================================================================*/</span>
<a name="l01521"></a>01521 <span class="comment">/*                                                                                              */</span>
<a name="l01522"></a>01522 <span class="comment">/* class SBNonTideEOP_Viron_02 implementation                                                   */</span>
<a name="l01523"></a>01523 <span class="comment">/*</span>
<a name="l01524"></a>01524 <span class="comment"> *  POLAR MOTION INDUCED BY THE NON-TIDAL VARIATIONS</span>
<a name="l01525"></a>01525 <span class="comment"> *  IN OCEANIC ANGULAR MOMENTUM</span>
<a name="l01526"></a>01526 <span class="comment"> *  </span>
<a name="l01527"></a>01527 <span class="comment"> *  Non-tidal fluctuations in water heigh and currents (partly caused by atmospheric wind </span>
<a name="l01528"></a>01528 <span class="comment"> *  and pressure variations) induce variation of equatorial oceanic angular momentum (OAM). </span>
<a name="l01529"></a>01529 <span class="comment"> *  de Viron, Goosse, Bizouard and Lambert have derived such an OAM series spanning </span>
<a name="l01530"></a>01530 <span class="comment"> *  1997.0-2002.0, and computed the associated perturbations on nutation, diurnal and subdiurnal </span>
<a name="l01531"></a>01531 <span class="comment"> *  polar motion, and UT1 (communication done at EGS General Assembly 2002) for the span </span>
<a name="l01532"></a>01532 <span class="comment"> *  1997.0-2002.0. The atmospheric perturbations, as derived from Atmospheric Angular Momentum (AAM) </span>
<a name="l01533"></a>01533 <span class="comment"> *  series of the NCEP/NCAR reanalyis project, were considered additionaly. We present both OAM, </span>
<a name="l01534"></a>01534 <span class="comment"> *  AAM and cumulated effects.</span>
<a name="l01535"></a>01535 <span class="comment"> *  </span>
<a name="l01536"></a>01536 <span class="comment"> *  For high frequency PM, there is only one prominent wave under the form :</span>
<a name="l01537"></a>01537 <span class="comment"> *  </span>
<a name="l01538"></a>01538 <span class="comment"> *  Dx - i*Dy = S_j (a^{in}_j + i*a^{op}_j)*e^{i*x_j}</span>
<a name="l01539"></a>01539 <span class="comment"> *</span>
<a name="l01540"></a>01540 <span class="comment"> *  or :</span>
<a name="l01541"></a>01541 <span class="comment"> *</span>
<a name="l01542"></a>01542 <span class="comment"> *  Dx =  S_j (a^{in}_j *cos(x_j) - a^{op}_j *sin(x_j))</span>
<a name="l01543"></a>01543 <span class="comment"> *  Dy = -S_j (a^{op}_j *cos(x_j) + a^{in}_j *sin(x_j))</span>
<a name="l01544"></a>01544 <span class="comment"> *  </span>
<a name="l01545"></a>01545 <span class="comment"> *  where xi is integer linear combination of Delaunay arguments, GMST + p :</span>
<a name="l01546"></a>01546 <span class="comment"> *  xi = a1*l + a2*l&#39; + a3*D + a4*F + a5*W + a6*(GMST +p)</span>
<a name="l01547"></a>01547 <span class="comment"> */</span>
<a name="l01548"></a>01548 <span class="comment">/*                                                                                              */</span>
<a name="l01549"></a>01549 <span class="comment">/*==============================================================================================*/</span>
<a name="l01550"></a><a class="code" href="classSBNonTideEOP__Viron__02.html#af329c60e981861f929846ae3c020a7ac">01550</a> <span class="keywordtype">void</span> <a class="code" href="classSBNonTideEOP__Viron__02.html#af329c60e981861f929846ae3c020a7ac">SBNonTideEOP_Viron_02::calc</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l01551"></a>01551 {
<a name="l01552"></a>01552   <span class="keywordtype">double</span>        x_j;
<a name="l01553"></a>01553   <span class="keywordtype">double</span>        s_xj, c_xj;
<a name="l01554"></a>01554   <span class="keywordtype">int</span>           i;
<a name="l01555"></a>01555   <a class="code" href="classSBOTideEOPGeneral.html#a5565645c6388372f00b913270116c3d6" title="calculated value of UT1D">DUT1D</a> = <a class="code" href="classSBOTideEOPGeneral.html#a3a395a31f4ca722ac4b8136a7ec072a4" title="calculated value of dXD">DXD</a> = <a class="code" href="classSBOTideEOPGeneral.html#a23e446918853e4ca9095a698318fc41b" title="calculated value of dYD">DYD</a> = 0.0;
<a name="l01556"></a>01556 
<a name="l01557"></a>01557   <span class="keywordflow">for</span> (i=0; i&lt;1; i++)
<a name="l01558"></a>01558     {
<a name="l01559"></a>01559       x_j = fmod(<a class="code" href="classSBNonTideEOP__Viron__02.html#aa7118e9660b948643f015b9a7bd1cf34">Tab</a>[i].k[0]*T.<a class="code" href="classSBTime.html#a2332d64fb28c9310e859d2c9b6160ae1">fArg_l</a>()         +
<a name="l01560"></a>01560                  <a class="code" href="classSBNonTideEOP__Viron__02.html#aa7118e9660b948643f015b9a7bd1cf34">Tab</a>[i].<a class="code" href="structSBNonTideEOP__Viron__02_1_1TableEntry.html#a00e34aa14b425970cc0f09ef46ffe8d2">k</a>[1]*T.<a class="code" href="classSBTime.html#a51abab9b1f86e70370819b54576f8769">fArg_lPrime</a>()    +
<a name="l01561"></a>01561                  <a class="code" href="classSBNonTideEOP__Viron__02.html#aa7118e9660b948643f015b9a7bd1cf34">Tab</a>[i].<a class="code" href="structSBNonTideEOP__Viron__02_1_1TableEntry.html#a00e34aa14b425970cc0f09ef46ffe8d2">k</a>[2]*T.<a class="code" href="classSBTime.html#a054bbe5e1ea61692ba83b20ba476af03">fArg_F</a>()         +
<a name="l01562"></a>01562                  <a class="code" href="classSBNonTideEOP__Viron__02.html#aa7118e9660b948643f015b9a7bd1cf34">Tab</a>[i].<a class="code" href="structSBNonTideEOP__Viron__02_1_1TableEntry.html#a00e34aa14b425970cc0f09ef46ffe8d2">k</a>[3]*T.<a class="code" href="classSBTime.html#a5d54ea8c67e5d556f626889d159661bf">fArg_D</a>()         +
<a name="l01563"></a>01563                  <a class="code" href="classSBNonTideEOP__Viron__02.html#aa7118e9660b948643f015b9a7bd1cf34">Tab</a>[i].<a class="code" href="structSBNonTideEOP__Viron__02_1_1TableEntry.html#a00e34aa14b425970cc0f09ef46ffe8d2">k</a>[4]*T.<a class="code" href="classSBTime.html#a09dfa5604304cb84bad328402bd75ff4">fArg_Omega</a>()     +
<a name="l01564"></a>01564                  <a class="code" href="classSBNonTideEOP__Viron__02.html#aa7118e9660b948643f015b9a7bd1cf34">Tab</a>[i].<a class="code" href="structSBNonTideEOP__Viron__02_1_1TableEntry.html#a00e34aa14b425970cc0f09ef46ffe8d2">k</a>[5]*T.<a class="code" href="classSBTime.html#a36ffc24993422862bc4ac6e9af555604">fArg_theta</a>(),    2.0*M_PI);
<a name="l01565"></a>01565       <a class="code" href="SbGeneral_8H.html#a2a86fa9ee8196baf80d72b8f7ebd2db1">sincos</a>(x_j, &amp;s_xj, &amp;c_xj);
<a name="l01566"></a>01566       <a class="code" href="classSBOTideEOPGeneral.html#a3a395a31f4ca722ac4b8136a7ec072a4" title="calculated value of dXD">DXD</a>   +=   <a class="code" href="classSBNonTideEOP__Viron__02.html#aa7118e9660b948643f015b9a7bd1cf34">Tab</a>[i].<a class="code" href="structSBNonTideEOP__Viron__02_1_1TableEntry.html#a91b01f54231e0e35e4e2b43f760670a8">A_in</a>*c_xj - <a class="code" href="classSBNonTideEOP__Viron__02.html#aa7118e9660b948643f015b9a7bd1cf34">Tab</a>[i].<a class="code" href="structSBNonTideEOP__Viron__02_1_1TableEntry.html#ad571789845f361d73c04c410204f4cb3">A_op</a>*s_xj;
<a name="l01567"></a>01567       <a class="code" href="classSBOTideEOPGeneral.html#a23e446918853e4ca9095a698318fc41b" title="calculated value of dYD">DYD</a>   += -(<a class="code" href="classSBNonTideEOP__Viron__02.html#aa7118e9660b948643f015b9a7bd1cf34">Tab</a>[i].<a class="code" href="structSBNonTideEOP__Viron__02_1_1TableEntry.html#ad571789845f361d73c04c410204f4cb3">A_op</a>*c_xj + <a class="code" href="classSBNonTideEOP__Viron__02.html#aa7118e9660b948643f015b9a7bd1cf34">Tab</a>[i].<a class="code" href="structSBNonTideEOP__Viron__02_1_1TableEntry.html#a91b01f54231e0e35e4e2b43f760670a8">A_in</a>*s_xj);
<a name="l01568"></a>01568       <a class="code" href="classSBOTideEOPGeneral.html#a5565645c6388372f00b913270116c3d6" title="calculated value of UT1D">DUT1D</a> +=   <a class="code" href="classSBNonTideEOP__Viron__02.html#aa7118e9660b948643f015b9a7bd1cf34">Tab</a>[i].<a class="code" href="structSBNonTideEOP__Viron__02_1_1TableEntry.html#ac335a9ab1f936db49d27d3c80b504688">a</a>   *c_xj + <a class="code" href="classSBNonTideEOP__Viron__02.html#aa7118e9660b948643f015b9a7bd1cf34">Tab</a>[i].<a class="code" href="structSBNonTideEOP__Viron__02_1_1TableEntry.html#aa01609a69f1d84e65e42f3e0d1c1985a">b</a>   *s_xj;
<a name="l01569"></a>01569     };
<a name="l01570"></a>01570   <a class="code" href="classSBOTideEOPGeneral.html#a5565645c6388372f00b913270116c3d6" title="calculated value of UT1D">DUT1D</a> *= 1.0e-6/86400.0;
<a name="l01571"></a>01571   <a class="code" href="classSBOTideEOPGeneral.html#a3a395a31f4ca722ac4b8136a7ec072a4" title="calculated value of dXD">DXD</a>   *= 1.0e-6*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l01572"></a>01572   <a class="code" href="classSBOTideEOPGeneral.html#a23e446918853e4ca9095a698318fc41b" title="calculated value of dYD">DYD</a>   *= 1.0e-6*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l01573"></a>01573 };
<a name="l01574"></a>01574 <span class="comment">/*==============================================================================================*/</span>
<a name="l01575"></a>01575 
<a name="l01576"></a>01576 
<a name="l01577"></a>01577 
<a name="l01578"></a>01578 <span class="comment">/*==============================================================================================*/</span>
<a name="l01579"></a>01579 <span class="comment">/*                                                                                              */</span>
<a name="l01580"></a>01580 <span class="comment">/* class SBGravTideEOP_B_02 implementation                                                      */</span>
<a name="l01581"></a>01581 <span class="comment">/*</span>
<a name="l01582"></a>01582 <span class="comment"> *  POLAR MOTION INDUCED BY THE LUNI-SOLAR GRAVITATIONAL TIDES</span>
<a name="l01583"></a>01583 <span class="comment"> *  </span>
<a name="l01584"></a>01584 <span class="comment"> *  Table with the harmonic development of the model of polar motion due to the lunisolar </span>
<a name="l01585"></a>01585 <span class="comment"> *  torque on the triaxial Earth, corresponding to that what is frequently referred to as </span>
<a name="l01586"></a>01586 <span class="comment"> *  high-frequency nutation. The coefficients have been computed for the model of non-rigid </span>
<a name="l01587"></a>01587 <span class="comment"> *  Earth and refer to the conventional intermediate pole (CIP) which was defined by Resolution </span>
<a name="l01588"></a>01588 <span class="comment"> *  B1.7 of the last IAU General Assembly. This table is based on the discussion and comparisons </span>
<a name="l01589"></a>01589 <span class="comment"> *  done during the last 3 months by the Sub-WG &quot;Subdiurnal Nutations&quot; of the IAU Commission 19 </span>
<a name="l01590"></a>01590 <span class="comment"> *  WG on Nutation. Two models for non-rigid Earth were taken into account in this discussion, </span>
<a name="l01591"></a>01591 <span class="comment"> *  one by Mathews and Bretagnon (2002, Proc. JSR 2001) and the other one by Brzezinski (2001, </span>
<a name="l01592"></a>01592 <span class="comment"> *  Proc. JSR 2000), Brzezinski and Capitaine (2002, Proc. JSR 2001). The papers describing these </span>
<a name="l01593"></a>01593 <span class="comment"> *  theories are in preparation and should be soon submitted for publication in the reviewed </span>
<a name="l01594"></a>01594 <span class="comment"> *  international journals. After discussing several details and introducing all the necessary </span>
<a name="l01595"></a>01595 <span class="comment"> *  corrections, Sonny and myself could reach a consensus on the attached table.</span>
<a name="l01596"></a>01596 <span class="comment"> *</span>
<a name="l01597"></a>01597 <span class="comment"> *  Coefficients in microarcseconds </span>
<a name="l01598"></a>01598 <span class="comment"> *  Cut-off: 0.5 muas on the amplitude defined as the </span>
<a name="l01599"></a>01599 <span class="comment"> *  square root of the sin and cos coefficients </span>
<a name="l01600"></a>01600 <span class="comment"> *  of PM X or PM Y, whichever is larger </span>
<a name="l01601"></a>01601 <span class="comment"> */</span>
<a name="l01602"></a>01602 <span class="comment">/*                                                                                              */</span>
<a name="l01603"></a>01603 <span class="comment">/*==============================================================================================*/</span>
<a name="l01604"></a><a class="code" href="classSBGravTideEOP__B__02.html#a8ed20e487cff369d3920b437b9580775">01604</a> <span class="keywordtype">void</span> <a class="code" href="classSBGravTideEOP__B__02.html#a8ed20e487cff369d3920b437b9580775">SBGravTideEOP_B_02::calc</a>(<span class="keyword">const</span> <a class="code" href="classSBTime.html">SBTime</a>&amp; T)
<a name="l01605"></a>01605 {
<a name="l01606"></a>01606   <span class="keywordtype">double</span>        x_j;
<a name="l01607"></a>01607   <span class="keywordtype">double</span>        s_xj, c_xj;
<a name="l01608"></a>01608   <span class="keywordtype">int</span>           i;
<a name="l01609"></a>01609   <a class="code" href="classSBOTideEOPGeneral.html#a5565645c6388372f00b913270116c3d6" title="calculated value of UT1D">DUT1D</a> = <a class="code" href="classSBOTideEOPGeneral.html#a3a395a31f4ca722ac4b8136a7ec072a4" title="calculated value of dXD">DXD</a> = <a class="code" href="classSBOTideEOPGeneral.html#a23e446918853e4ca9095a698318fc41b" title="calculated value of dYD">DYD</a> = 0.0;
<a name="l01610"></a>01610 
<a name="l01611"></a>01611   <span class="keywordflow">for</span> (i=0; i&lt;10; i++)
<a name="l01612"></a>01612     {
<a name="l01613"></a>01613       x_j = fmod(<a class="code" href="classSBGravTideEOP__B__02.html#a7cd5d231a504b191260cd4b99b2a9314">Tab</a>[i].k[0]*T.<a class="code" href="classSBTime.html#a36ffc24993422862bc4ac6e9af555604">fArg_theta</a>()     +
<a name="l01614"></a>01614                  <a class="code" href="classSBGravTideEOP__B__02.html#a7cd5d231a504b191260cd4b99b2a9314">Tab</a>[i].<a class="code" href="structSBGravTideEOP__B__02_1_1TableEntry.html#a2b379922daa6c1f6348afc8e5dd82b9f">k</a>[1]*T.<a class="code" href="classSBTime.html#a2332d64fb28c9310e859d2c9b6160ae1">fArg_l</a>()         +
<a name="l01615"></a>01615                  <a class="code" href="classSBGravTideEOP__B__02.html#a7cd5d231a504b191260cd4b99b2a9314">Tab</a>[i].<a class="code" href="structSBGravTideEOP__B__02_1_1TableEntry.html#a2b379922daa6c1f6348afc8e5dd82b9f">k</a>[2]*T.<a class="code" href="classSBTime.html#a51abab9b1f86e70370819b54576f8769">fArg_lPrime</a>()    +
<a name="l01616"></a>01616                  <a class="code" href="classSBGravTideEOP__B__02.html#a7cd5d231a504b191260cd4b99b2a9314">Tab</a>[i].<a class="code" href="structSBGravTideEOP__B__02_1_1TableEntry.html#a2b379922daa6c1f6348afc8e5dd82b9f">k</a>[3]*T.<a class="code" href="classSBTime.html#a054bbe5e1ea61692ba83b20ba476af03">fArg_F</a>()         +
<a name="l01617"></a>01617                  <a class="code" href="classSBGravTideEOP__B__02.html#a7cd5d231a504b191260cd4b99b2a9314">Tab</a>[i].<a class="code" href="structSBGravTideEOP__B__02_1_1TableEntry.html#a2b379922daa6c1f6348afc8e5dd82b9f">k</a>[4]*T.<a class="code" href="classSBTime.html#a5d54ea8c67e5d556f626889d159661bf">fArg_D</a>()         +
<a name="l01618"></a>01618                  <a class="code" href="classSBGravTideEOP__B__02.html#a7cd5d231a504b191260cd4b99b2a9314">Tab</a>[i].<a class="code" href="structSBGravTideEOP__B__02_1_1TableEntry.html#a2b379922daa6c1f6348afc8e5dd82b9f">k</a>[5]*T.<a class="code" href="classSBTime.html#a09dfa5604304cb84bad328402bd75ff4">fArg_Omega</a>(),    2.0*M_PI);
<a name="l01619"></a>01619       <a class="code" href="SbGeneral_8H.html#a2a86fa9ee8196baf80d72b8f7ebd2db1">sincos</a>(x_j, &amp;s_xj, &amp;c_xj);
<a name="l01620"></a>01620       <a class="code" href="classSBOTideEOPGeneral.html#a3a395a31f4ca722ac4b8136a7ec072a4" title="calculated value of dXD">DXD</a>   += <a class="code" href="classSBGravTideEOP__B__02.html#a7cd5d231a504b191260cd4b99b2a9314">Tab</a>[i].<a class="code" href="structSBGravTideEOP__B__02_1_1TableEntry.html#a6b1c6d536dab921a0a7ff87c7e527e30">SinX</a>*s_xj + <a class="code" href="classSBGravTideEOP__B__02.html#a7cd5d231a504b191260cd4b99b2a9314">Tab</a>[i].<a class="code" href="structSBGravTideEOP__B__02_1_1TableEntry.html#a2a65bc1f454031008182b5760f7a8329">CosX</a>*c_xj;
<a name="l01621"></a>01621       <a class="code" href="classSBOTideEOPGeneral.html#a23e446918853e4ca9095a698318fc41b" title="calculated value of dYD">DYD</a>   += <a class="code" href="classSBGravTideEOP__B__02.html#a7cd5d231a504b191260cd4b99b2a9314">Tab</a>[i].<a class="code" href="structSBGravTideEOP__B__02_1_1TableEntry.html#a515c7d1c2ca191bc3614a1d1ea8e477a">SinY</a>*s_xj + <a class="code" href="classSBGravTideEOP__B__02.html#a7cd5d231a504b191260cd4b99b2a9314">Tab</a>[i].<a class="code" href="structSBGravTideEOP__B__02_1_1TableEntry.html#ab9236208d7d3e238cf7f5e7d3970c075">CosY</a>*c_xj;
<a name="l01622"></a>01622     };
<a name="l01623"></a>01623   <span class="comment">//  DUT1D *= 1.0e-6/86400.0;</span>
<a name="l01624"></a>01624   <a class="code" href="classSBOTideEOPGeneral.html#a3a395a31f4ca722ac4b8136a7ec072a4" title="calculated value of dXD">DXD</a>   *= 1.0e-6*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l01625"></a>01625   <a class="code" href="classSBOTideEOPGeneral.html#a23e446918853e4ca9095a698318fc41b" title="calculated value of dYD">DYD</a>   *= 1.0e-6*<a class="code" href="SbGeo_8H.html#a1bc7b251bd5f04fbd2b83af52143a1de">SEC2RAD</a>;
<a name="l01626"></a>01626 };
<a name="l01627"></a>01627 <span class="comment">/*==============================================================================================*/</span>
<a name="l01628"></a>01628 
<a name="l01629"></a>01629 
<a name="l01630"></a>01630 
<a name="l01631"></a>01631 
<a name="l01632"></a>01632 <span class="comment">/*==============================================================================================*/</span>
<a name="l01633"></a>01633 
</pre></div></div>
</div>


<hr class="footer"/><address class="footer"><small>
Generated on Mon May 14 2012 13:21:50 for SteelBreeze Reference Manual by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
